[0m12:08:01.792262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119dd62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b729dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b729580>]}


============================== 12:08:01.796073 | 34908631-58f6-42a9-a0df-fd08dbc62131 ==============================
[0m12:08:01.796073 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:08:01.796649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/devincavagnaro/Documents/dev/dbt-btc-data-stack/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/devincavagnaro/Documents/dev/dbt-btc-data-stack/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:08:01.983488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34908631-58f6-42a9-a0df-fd08dbc62131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab20580>]}
[0m12:08:02.004554 [debug] [MainThread]: Set downloads directory='/var/folders/7z/66wrhqmd6tn23_5_f7fr90yw0000gn/T/dbt-downloads-5xf745gc'
[0m12:08:02.005170 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:08:02.207421 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:08:02.208759 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:08:02.293172 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:08:02.313198 [info ] [MainThread]: Updating lock file in file path: /Users/devincavagnaro/Documents/dev/dbt-btc-data-stack/dbt/package-lock.yml
[0m12:08:02.316527 [debug] [MainThread]: Set downloads directory='/var/folders/7z/66wrhqmd6tn23_5_f7fr90yw0000gn/T/dbt-downloads-_0rn0bn9'
[0m12:08:02.322248 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:08:03.003540 [info ] [MainThread]: Installed from version 0.8.6
[0m12:08:03.003980 [info ] [MainThread]: Updated version available: 1.3.0
[0m12:08:03.004446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '34908631-58f6-42a9-a0df-fd08dbc62131', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4c0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8a27f0>]}
[0m12:08:03.004842 [info ] [MainThread]: 
[0m12:08:03.005220 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m12:08:03.006980 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2756028, "process_user_time": 1.939503, "process_kernel_time": 0.460195, "process_mem_max_rss": "103550976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:08:03.007608 [debug] [MainThread]: Command `dbt deps` succeeded at 12:08:03.007495 after 1.28 seconds
[0m12:08:03.007990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119dd62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b833df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab205b0>]}
[0m12:08:03.008388 [debug] [MainThread]: Flushing usage events
[0m12:10:19.932667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b7c92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d11cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d11c580>]}


============================== 12:10:19.936236 | 8bf026db-dd8c-4c3b-b5f0-49f8cb6d4a87 ==============================
[0m12:10:19.936236 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:10:19.936870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/devincavagnaro/Documents/dev/dbt-btc-data-stack/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/devincavagnaro/Documents/dev/dbt-btc-data-stack/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:10:20.064752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bf026db-dd8c-4c3b-b5f0-49f8cb6d4a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d0c7b80>]}
[0m12:10:20.080699 [debug] [MainThread]: Set downloads directory='/var/folders/7z/66wrhqmd6tn23_5_f7fr90yw0000gn/T/dbt-downloads-if_vlbee'
[0m12:10:20.081832 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:10:20.251869 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:10:20.253183 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:10:20.335090 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:10:20.352256 [info ] [MainThread]: Updating lock file in file path: /Users/devincavagnaro/Documents/dev/dbt-btc-data-stack/dbt/package-lock.yml
[0m12:10:20.386457 [debug] [MainThread]: Set downloads directory='/var/folders/7z/66wrhqmd6tn23_5_f7fr90yw0000gn/T/dbt-downloads-j2rrmntb'
[0m12:10:20.390663 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:10:20.837116 [info ] [MainThread]: Installed from version 1.3.0
[0m12:10:20.837531 [info ] [MainThread]: Up to date!
[0m12:10:20.838003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8bf026db-dd8c-4c3b-b5f0-49f8cb6d4a87', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d1c7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11beb3b50>]}
[0m12:10:20.839710 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9661139, "process_user_time": 1.911784, "process_kernel_time": 0.45294, "process_mem_max_rss": "103550976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:10:20.840447 [debug] [MainThread]: Command `dbt deps` succeeded at 12:10:20.840332 after 0.97 seconds
[0m12:10:20.840819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b7c92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d26e550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11beb3e50>]}
[0m12:10:20.841179 [debug] [MainThread]: Flushing usage events
[0m22:29:34.066355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b134622b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b10ca64c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b10ca6460>]}


============================== 22:29:34.074686 | 4f3f14dd-9bfc-4e95-b184-fc70ffd14cd1 ==============================
[0m22:29:34.074686 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:29:34.075887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:29:34.245071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f3f14dd-9bfc-4e95-b184-fc70ffd14cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b10eb61c0>]}
[0m22:29:34.379411 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1pd4gb1u'
[0m22:29:34.380304 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:29:34.545841 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:29:34.547584 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:29:34.634971 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:29:34.644225 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:29:35.524411 [info ] [MainThread]: Installed from version 1.3.0
[0m22:29:35.525392 [info ] [MainThread]: Up to date!
[0m22:29:35.526309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4f3f14dd-9bfc-4e95-b184-fc70ffd14cd1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b1202b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b10b24cd0>]}
[0m22:29:35.527936 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.5394591, "process_user_time": 2.5629, "process_kernel_time": 0.183806, "process_mem_max_rss": "189776", "process_out_blocks": "1813", "process_in_blocks": "0"}
[0m22:29:35.529069 [debug] [MainThread]: Command `dbt deps` succeeded at 22:29:35.528931 after 1.54 seconds
[0m22:29:35.529926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b134622b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b10b5b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b12c2a310>]}
[0m22:29:35.530669 [debug] [MainThread]: Flushing usage events
[0m22:29:39.969964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262ccaffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262a919820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262a9197c0>]}


============================== 22:29:39.977456 | a73a88ea-37d5-4269-b20b-09333222c3a3 ==============================
[0m22:29:39.977456 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:29:39.978808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:29:40.195163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a73a88ea-37d5-4269-b20b-09333222c3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262c893f40>]}
[0m22:29:40.269329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a73a88ea-37d5-4269-b20b-09333222c3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262a2c55e0>]}
[0m22:29:40.270793 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m22:29:40.303748 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:29:40.454536 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m22:29:40.455675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a73a88ea-37d5-4269-b20b-09333222c3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262bcf2340>]}
[0m22:29:42.684308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a73a88ea-37d5-4269-b20b-09333222c3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26292cd130>]}
[0m22:29:42.699753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a73a88ea-37d5-4269-b20b-09333222c3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2629289e80>]}
[0m22:29:42.701026 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m22:29:42.702529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a73a88ea-37d5-4269-b20b-09333222c3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2629289dc0>]}
[0m22:29:42.705188 [info ] [MainThread]: 
[0m22:29:42.707080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:29:42.710396 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m22:29:42.809086 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m22:29:42.810500 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m22:29:42.811665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:42.818505 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:29:42.820483 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m22:29:42.822964 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m22:29:42.834555 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m22:29:42.838956 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m22:29:42.840884 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m22:29:42.852213 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:42.853474 [debug] [MainThread]: On master: BEGIN
[0m22:29:42.854551 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:29:42.861025 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:29:42.862267 [debug] [MainThread]: Using postgres connection "master"
[0m22:29:42.863715 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:29:42.868520 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m22:29:42.870745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a73a88ea-37d5-4269-b20b-09333222c3a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26292a9430>]}
[0m22:29:42.871863 [debug] [MainThread]: On master: ROLLBACK
[0m22:29:42.873202 [debug] [MainThread]: On master: Close
[0m22:29:42.874699 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:29:42.875861 [info ] [MainThread]: 
[0m22:29:42.886921 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btc_trades
[0m22:29:42.888195 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.dbt_btc_transform.stg_kaggle__btc_trades)
[0m22:29:42.889154 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btc_trades
[0m22:29:42.905143 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btc_trades"
[0m22:29:42.911166 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btc_trades
[0m22:29:42.912833 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btc_trades
[0m22:29:42.915890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:42.916824 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btc_trades' was properly closed.
[0m22:29:42.918046 [debug] [MainThread]: Command end result
[0m22:29:43.087991 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m22:29:43.088820 [info ] [MainThread]: Building catalog
[0m22:29:43.103667 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m22:29:43.114474 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m22:29:43.115411 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m22:29:43.116175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:43.120841 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m22:29:43.121762 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m22:29:43.122781 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_kaggle__btc_trades')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('bitcoin_trades')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m22:29:43.126745 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m22:29:43.129523 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m22:29:43.130596 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m22:29:43.196892 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m22:29:43.198409 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.3025649, "process_user_time": 5.17945, "process_kernel_time": 0.180795, "process_mem_max_rss": "191528", "process_out_blocks": "6167", "process_in_blocks": "0"}
[0m22:29:43.199679 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:29:43.199550 after 3.30 seconds
[0m22:29:43.200432 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:29:43.201224 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m22:29:43.202038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262ccaffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262b0e18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262b5cd160>]}
[0m22:29:43.202931 [debug] [MainThread]: Flushing usage events
[0m23:01:28.094259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17a637070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1782ab8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1782ab850>]}


============================== 23:01:28.102786 | 7ce980ff-1489-45e3-9363-843a61363ff2 ==============================
[0m23:01:28.102786 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:01:28.104206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:01:28.332203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ce980ff-1489-45e3-9363-843a61363ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1780117f0>]}
[0m23:01:28.403408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ce980ff-1489-45e3-9363-843a61363ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1782d6550>]}
[0m23:01:28.404800 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:01:28.435048 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:01:28.571996 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m23:01:28.573138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ce980ff-1489-45e3-9363-843a61363ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1796f4e50>]}
[0m23:01:30.790083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ce980ff-1489-45e3-9363-843a61363ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc176ecd130>]}
[0m23:01:30.807338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ce980ff-1489-45e3-9363-843a61363ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc176e89f10>]}
[0m23:01:30.808446 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m23:01:30.809716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ce980ff-1489-45e3-9363-843a61363ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc176e89e50>]}
[0m23:01:30.811812 [info ] [MainThread]: 
[0m23:01:30.813070 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:01:30.814534 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m23:01:30.916051 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m23:01:30.917248 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m23:01:30.918344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:30.925186 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:01:30.926521 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m23:01:30.928003 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m23:01:30.932625 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m23:01:30.935167 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m23:01:30.936592 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m23:01:30.945544 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:30.946852 [debug] [MainThread]: On master: BEGIN
[0m23:01:30.947876 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:01:30.953575 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:01:30.954730 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:30.956126 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:01:30.964175 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m23:01:30.966205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ce980ff-1489-45e3-9363-843a61363ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc176ea94c0>]}
[0m23:01:30.967231 [debug] [MainThread]: On master: ROLLBACK
[0m23:01:30.968370 [debug] [MainThread]: On master: Close
[0m23:01:30.969571 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:01:30.970554 [info ] [MainThread]: 
[0m23:01:30.980490 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btc_trades
[0m23:01:30.981709 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.dbt_btc_transform.stg_kaggle__btc_trades)
[0m23:01:30.982651 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btc_trades
[0m23:01:30.996427 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btc_trades"
[0m23:01:30.999692 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btc_trades
[0m23:01:31.001128 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btc_trades
[0m23:01:31.003367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:31.004479 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btc_trades' was properly closed.
[0m23:01:31.005642 [debug] [MainThread]: Command end result
[0m23:01:31.174772 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m23:01:31.175619 [info ] [MainThread]: Building catalog
[0m23:01:31.190979 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m23:01:31.201759 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m23:01:31.202730 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m23:01:31.203592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:31.208607 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m23:01:31.209659 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m23:01:31.211033 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('bitcoin_trades')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_kaggle__btc_trades')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m23:01:31.215028 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m23:01:31.217727 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m23:01:31.218878 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m23:01:31.285227 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m23:01:31.286757 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.2665124, "process_user_time": 5.06529, "process_kernel_time": 0.172508, "process_mem_max_rss": "166552", "process_out_blocks": "6165", "process_in_blocks": "0"}
[0m23:01:31.287977 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:01:31.287802 after 3.27 seconds
[0m23:01:31.288713 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:01:31.289458 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m23:01:31.290264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17a637070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17a09c700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17ac02640>]}
[0m23:01:31.291151 [debug] [MainThread]: Flushing usage events
[0m23:03:35.092904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd0726c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd04eeb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd04eeb850>]}


============================== 23:03:35.101414 | ebd6807f-7162-4192-b77e-f0958180afd0 ==============================
[0m23:03:35.101414 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:03:35.102766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:03:35.312225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebd6807f-7162-4192-b77e-f0958180afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd0492f7f0>]}
[0m23:03:35.381259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebd6807f-7162-4192-b77e-f0958180afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd04f17550>]}
[0m23:03:35.382586 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:03:35.412514 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:03:35.632644 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m23:03:35.633763 [debug] [MainThread]: Partial parsing: added file: dbt_btc_transform://models/staging/kaggle/docs/stg_kaggle__btcusdt.yml
[0m23:03:35.634812 [debug] [MainThread]: Partial parsing: added file: dbt_btc_transform://models/staging/kaggle/stg_kaggle__btcusdt.sql
[0m23:03:35.635579 [debug] [MainThread]: Partial parsing: deleted file: dbt_btc_transform://models/staging/kaggle/stg_kaggle__btc_trades.sql
[0m23:03:36.024562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebd6807f-7162-4192-b77e-f0958180afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd045623a0>]}
[0m23:03:36.040769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebd6807f-7162-4192-b77e-f0958180afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd039d5340>]}
[0m23:03:36.041884 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m23:03:36.042779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebd6807f-7162-4192-b77e-f0958180afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd039d5400>]}
[0m23:03:36.044935 [info ] [MainThread]: 
[0m23:03:36.046299 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:03:36.048096 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m23:03:36.094791 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m23:03:36.095783 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m23:03:36.096555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:36.102155 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:03:36.103120 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m23:03:36.104010 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m23:03:36.107220 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:03:36.109188 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m23:03:36.110342 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m23:03:36.117193 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:36.118085 [debug] [MainThread]: On master: BEGIN
[0m23:03:36.118885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:03:36.123438 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:03:36.124376 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:36.125464 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:03:36.131805 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m23:03:36.133638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebd6807f-7162-4192-b77e-f0958180afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd04f704f0>]}
[0m23:03:36.134604 [debug] [MainThread]: On master: ROLLBACK
[0m23:03:36.135786 [debug] [MainThread]: On master: Close
[0m23:03:36.136842 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:03:36.137723 [info ] [MainThread]: 
[0m23:03:36.147033 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:03:36.148164 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m23:03:36.149054 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:03:36.161404 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:03:36.164610 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:03:36.166237 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:03:36.168836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:36.169761 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m23:03:36.171036 [debug] [MainThread]: Command end result
[0m23:03:36.337113 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m23:03:36.337886 [info ] [MainThread]: Building catalog
[0m23:03:36.352005 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m23:03:36.362436 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m23:03:36.363352 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m23:03:36.364094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:36.368895 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m23:03:36.369799 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m23:03:36.370882 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('bitcoin_trades')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_kaggle__btcusdt')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m23:03:36.374463 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:03:36.377090 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m23:03:36.378109 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m23:03:36.443930 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m23:03:36.445341 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.4221525, "process_user_time": 3.223901, "process_kernel_time": 0.14446, "process_mem_max_rss": "166604", "process_out_blocks": "6166", "process_in_blocks": "0"}
[0m23:03:36.446446 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:03:36.446318 after 1.42 seconds
[0m23:03:36.447268 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:03:36.447999 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m23:03:36.448864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd0726c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd03d71460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd05c20310>]}
[0m23:03:36.449672 [debug] [MainThread]: Flushing usage events
[0m23:05:58.498229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0990bc8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098e82b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098e82b5b0>]}


============================== 23:05:58.506465 | 5a536f51-369f-4890-9100-95d982ee30cb ==============================
[0m23:05:58.506465 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:05:58.507909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:05:58.739131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a536f51-369f-4890-9100-95d982ee30cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098fb60e80>]}
[0m23:05:58.807593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a536f51-369f-4890-9100-95d982ee30cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098f4d8d00>]}
[0m23:05:58.809167 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:05:58.839297 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m23:05:58.984255 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:05:58.985338 [debug] [MainThread]: previous checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m23:05:58.986190 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:05:58.987328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5a536f51-369f-4890-9100-95d982ee30cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098fc83e50>]}
[0m23:06:01.135148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a536f51-369f-4890-9100-95d982ee30cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098d44ef40>]}
[0m23:06:01.149388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a536f51-369f-4890-9100-95d982ee30cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098d1c6d30>]}
[0m23:06:01.150702 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m23:06:01.151607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a536f51-369f-4890-9100-95d982ee30cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098d44ed90>]}
[0m23:06:01.153423 [info ] [MainThread]: 
[0m23:06:01.154652 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:06:01.156318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:06:01.249501 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:06:01.250776 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:06:01.251884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:01.259131 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m23:06:01.261822 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:06:01.263702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now create_company_dw_analytics)
[0m23:06:01.265002 [debug] [ThreadPool]: Creating schema "database: "company_dw"
schema: "analytics"
"
[0m23:06:01.275262 [debug] [ThreadPool]: Using postgres connection "create_company_dw_analytics"
[0m23:06:01.276451 [debug] [ThreadPool]: On create_company_dw_analytics: BEGIN
[0m23:06:01.277557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:06:01.283373 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:06:01.284706 [debug] [ThreadPool]: Using postgres connection "create_company_dw_analytics"
[0m23:06:01.286025 [debug] [ThreadPool]: On create_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "create_company_dw_analytics"} */
create schema if not exists "analytics"
[0m23:06:01.287967 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m23:06:01.289990 [debug] [ThreadPool]: On create_company_dw_analytics: COMMIT
[0m23:06:01.291011 [debug] [ThreadPool]: Using postgres connection "create_company_dw_analytics"
[0m23:06:01.291996 [debug] [ThreadPool]: On create_company_dw_analytics: COMMIT
[0m23:06:01.293815 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m23:06:01.294857 [debug] [ThreadPool]: On create_company_dw_analytics: Close
[0m23:06:01.297241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_company_dw_analytics, now list_company_dw_analytics)
[0m23:06:01.307288 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m23:06:01.308340 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m23:06:01.309321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:06:01.314398 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m23:06:01.315379 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m23:06:01.316404 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:06:01.319863 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:06:01.321746 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m23:06:01.322849 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m23:06:01.330837 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:01.331801 [debug] [MainThread]: On master: BEGIN
[0m23:06:01.332571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:06:01.337646 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:06:01.338582 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:01.339716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:06:01.346135 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m23:06:01.348007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a536f51-369f-4890-9100-95d982ee30cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098d1cca30>]}
[0m23:06:01.349011 [debug] [MainThread]: On master: ROLLBACK
[0m23:06:01.350075 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:01.350910 [debug] [MainThread]: On master: BEGIN
[0m23:06:01.352210 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:06:01.353055 [debug] [MainThread]: On master: COMMIT
[0m23:06:01.353890 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:01.354821 [debug] [MainThread]: On master: COMMIT
[0m23:06:01.355913 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:06:01.356786 [debug] [MainThread]: On master: Close
[0m23:06:01.357883 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:06:01.358832 [info ] [MainThread]: 
[0m23:06:01.368146 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:06:01.369499 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m23:06:01.370699 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m23:06:01.371645 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:06:01.384052 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:06:01.386599 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:06:01.444178 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:06:01.449863 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:06:01.450793 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m23:06:01.451659 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:06:01.457815 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m23:06:01.459651 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:06:01.461215 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."bitcoin_trades" where ignore = 0

),


final as (

    select
        open_timestamp,
        close_timestamp,
        open,
        high,
        low,
        close,
        volume,
        quote,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minute from open_timestamp) = 0 
            and extract(second from open_timestamp) = 0
                then true
            when extract(minute from close_timestamp) = 59 
            and extract(second from close_timestamp) = 59.999
                then true
            else false
        end as include_flag
            

    from source

)

select * from final
  );
  
[0m23:06:01.463069 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw.bitcoin_trades" does not exist
LINE 16:     select * from "company_dw"."raw"."bitcoin_trades" where ...
                           ^

[0m23:06:01.464064 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: ROLLBACK
[0m23:06:01.465399 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m23:06:01.468841 [debug] [Thread-1  ]: Database Error in model stg_kaggle__btcusdt (models/staging/kaggle/stg_kaggle__btcusdt.sql)
  relation "raw.bitcoin_trades" does not exist
  LINE 16:     select * from "company_dw"."raw"."bitcoin_trades" where ...
                             ^
  compiled code at target/run/dbt_btc_transform/models/staging/kaggle/stg_kaggle__btcusdt.sql
[0m23:06:01.471240 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a536f51-369f-4890-9100-95d982ee30cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098e140640>]}
[0m23:06:01.472577 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model analytics.stg_kaggle__btcusdt ............ [[31mERROR[0m in 0.10s]
[0m23:06:01.474130 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:06:01.477630 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:01.478643 [debug] [MainThread]: On master: BEGIN
[0m23:06:01.479564 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:06:01.484799 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:06:01.486463 [debug] [MainThread]: On master: COMMIT
[0m23:06:01.487482 [debug] [MainThread]: Using postgres connection "master"
[0m23:06:01.488497 [debug] [MainThread]: On master: COMMIT
[0m23:06:01.489729 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:06:01.490590 [debug] [MainThread]: On master: Close
[0m23:06:01.491661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:06:01.492643 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m23:06:01.493521 [info ] [MainThread]: 
[0m23:06:01.494628 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m23:06:01.496030 [debug] [MainThread]: Command end result
[0m23:06:01.496765 [info ] [MainThread]: 
[0m23:06:01.497729 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:06:01.498543 [info ] [MainThread]: 
[0m23:06:01.499500 [error] [MainThread]:   Database Error in model stg_kaggle__btcusdt (models/staging/kaggle/stg_kaggle__btcusdt.sql)
  relation "raw.bitcoin_trades" does not exist
  LINE 16:     select * from "company_dw"."raw"."bitcoin_trades" where ...
                             ^
  compiled code at target/run/dbt_btc_transform/models/staging/kaggle/stg_kaggle__btcusdt.sql
[0m23:06:01.500710 [info ] [MainThread]: 
[0m23:06:01.501722 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:06:01.503046 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.0750957, "process_user_time": 4.790515, "process_kernel_time": 0.14309, "process_mem_max_rss": "113344", "process_out_blocks": "1113", "command_success": false, "process_in_blocks": "0"}
[0m23:06:01.504007 [debug] [MainThread]: Command `dbt run` failed at 23:06:01.503887 after 3.08 seconds
[0m23:06:01.505098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0990bc8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098f4d8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098d5c7820>]}
[0m23:06:01.505962 [debug] [MainThread]: Flushing usage events
[0m23:07:25.333230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3368e7f130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3366aeb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3366aeb640>]}


============================== 23:07:25.341729 | 665c6dd0-1afa-4525-afc8-c3e8a13c2da2 ==============================
[0m23:07:25.341729 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:07:25.343201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:07:25.569800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '665c6dd0-1afa-4525-afc8-c3e8a13c2da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33664ebdf0>]}
[0m23:07:25.638971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '665c6dd0-1afa-4525-afc8-c3e8a13c2da2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3369408040>]}
[0m23:07:25.640441 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:07:25.675338 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m23:07:25.902746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:07:25.904273 [debug] [MainThread]: Partial parsing: updated file: dbt_btc_transform://models/staging/kaggle/docs/src_kaggle.yml
[0m23:07:26.294243 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_btc_transform.stg_kaggle__btcusdt' (models/staging/kaggle/stg_kaggle__btcusdt.sql) depends on a source named 'raw.bitcoin_trades' which was not found
[0m23:07:26.296137 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0314804, "process_user_time": 2.893429, "process_kernel_time": 0.127083, "process_mem_max_rss": "104284", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m23:07:26.297274 [debug] [MainThread]: Command `dbt run` failed at 23:07:26.297151 after 1.03 seconds
[0m23:07:26.298174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3368e7f130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3365965850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33655d1b80>]}
[0m23:07:26.299026 [debug] [MainThread]: Flushing usage events
[0m23:09:12.896270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6df10590d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6deeceb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6deeceb5b0>]}


============================== 23:09:12.905066 | c5701e66-9eec-4f68-bfe6-13aa279a9233 ==============================
[0m23:09:12.905066 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:09:12.906462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:09:13.139059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5701e66-9eec-4f68-bfe6-13aa279a9233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dee6e5fa0>]}
[0m23:09:13.209540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5701e66-9eec-4f68-bfe6-13aa279a9233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6deeea9100>]}
[0m23:09:13.210939 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:09:13.242940 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m23:09:13.381338 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m23:09:13.382462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c5701e66-9eec-4f68-bfe6-13aa279a9233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6df0002880>]}
[0m23:09:15.545105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5701e66-9eec-4f68-bfe6-13aa279a9233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ded6d0fd0>]}
[0m23:09:15.561309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5701e66-9eec-4f68-bfe6-13aa279a9233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ded686cd0>]}
[0m23:09:15.562810 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m23:09:15.563881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5701e66-9eec-4f68-bfe6-13aa279a9233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ded6d0df0>]}
[0m23:09:15.565734 [info ] [MainThread]: 
[0m23:09:15.566864 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:09:15.568553 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:09:15.669898 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:09:15.671347 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:09:15.672488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:15.680527 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m23:09:15.683241 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:09:15.685875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m23:09:15.698146 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m23:09:15.699425 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m23:09:15.700527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:09:15.706257 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:09:15.707284 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m23:09:15.708361 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:09:15.712070 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m23:09:15.714178 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m23:09:15.715381 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m23:09:15.723000 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:15.724032 [debug] [MainThread]: On master: BEGIN
[0m23:09:15.724835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:09:15.730150 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:09:15.731125 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:15.732202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:09:15.738655 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m23:09:15.740565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5701e66-9eec-4f68-bfe6-13aa279a9233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dedaf7220>]}
[0m23:09:15.741620 [debug] [MainThread]: On master: ROLLBACK
[0m23:09:15.742744 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:15.743606 [debug] [MainThread]: On master: BEGIN
[0m23:09:15.744858 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:09:15.745706 [debug] [MainThread]: On master: COMMIT
[0m23:09:15.746558 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:15.747405 [debug] [MainThread]: On master: COMMIT
[0m23:09:15.748403 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:09:15.749227 [debug] [MainThread]: On master: Close
[0m23:09:15.750270 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:09:15.751232 [info ] [MainThread]: 
[0m23:09:15.761166 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:09:15.762393 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m23:09:15.763468 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m23:09:15.764310 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:09:15.776448 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:09:15.780441 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:09:15.838150 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:09:15.842179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:09:15.843255 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m23:09:15.844174 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:09:15.849286 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m23:09:15.850466 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:09:15.852289 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    select
        open_timestamp,
        close_timestamp,
        open,
        high,
        low,
        close,
        volume,
        quote,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minute from open_timestamp) = 0 
            and extract(second from open_timestamp) = 0
                then true
            when extract(minute from close_timestamp) = 59 
            and extract(second from close_timestamp) = 59.999
                then true
            else false
        end as include_flag
            

    from source

)

select * from final
  );
  
[0m23:09:15.855134 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "open_timestamp" does not exist
LINE 24:         open_timestamp,
                 ^

[0m23:09:15.856388 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: ROLLBACK
[0m23:09:15.857859 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m23:09:15.861110 [debug] [Thread-1  ]: Database Error in model stg_kaggle__btcusdt (models/staging/kaggle/stg_kaggle__btcusdt.sql)
  column "open_timestamp" does not exist
  LINE 24:         open_timestamp,
                   ^
  compiled code at target/run/dbt_btc_transform/models/staging/kaggle/stg_kaggle__btcusdt.sql
[0m23:09:15.863383 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5701e66-9eec-4f68-bfe6-13aa279a9233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6deda8a5b0>]}
[0m23:09:15.864641 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model analytics.stg_kaggle__btcusdt ............ [[31mERROR[0m in 0.10s]
[0m23:09:15.865981 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:09:15.868914 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:15.869704 [debug] [MainThread]: On master: BEGIN
[0m23:09:15.870554 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:09:15.875801 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:09:15.876862 [debug] [MainThread]: On master: COMMIT
[0m23:09:15.877708 [debug] [MainThread]: Using postgres connection "master"
[0m23:09:15.878537 [debug] [MainThread]: On master: COMMIT
[0m23:09:15.879533 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:09:15.880652 [debug] [MainThread]: On master: Close
[0m23:09:15.881728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:15.882582 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m23:09:15.883453 [info ] [MainThread]: 
[0m23:09:15.884353 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m23:09:15.885657 [debug] [MainThread]: Command end result
[0m23:09:15.886497 [info ] [MainThread]: 
[0m23:09:15.887475 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:09:15.888326 [info ] [MainThread]: 
[0m23:09:15.889367 [error] [MainThread]:   Database Error in model stg_kaggle__btcusdt (models/staging/kaggle/stg_kaggle__btcusdt.sql)
  column "open_timestamp" does not exist
  LINE 24:         open_timestamp,
                   ^
  compiled code at target/run/dbt_btc_transform/models/staging/kaggle/stg_kaggle__btcusdt.sql
[0m23:09:15.890298 [info ] [MainThread]: 
[0m23:09:15.891200 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:09:15.892559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.07461, "process_user_time": 4.858029, "process_kernel_time": 0.164388, "process_mem_max_rss": "113236", "process_out_blocks": "1109", "command_success": false, "process_in_blocks": "0"}
[0m23:09:15.893657 [debug] [MainThread]: Command `dbt run` failed at 23:09:15.893539 after 3.08 seconds
[0m23:09:15.894603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6df10590d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ded686460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ded686490>]}
[0m23:09:15.895769 [debug] [MainThread]: Flushing usage events
[0m23:11:05.000516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd092bc80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd09082b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd09082b5e0>]}


============================== 23:11:05.009046 | 03e0a3ef-c737-46d3-942c-c315c22c051d ==============================
[0m23:11:05.009046 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:11:05.010456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:11:05.246644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03e0a3ef-c737-46d3-942c-c315c22c051d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0927ca310>]}
[0m23:11:05.324907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03e0a3ef-c737-46d3-942c-c315c22c051d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0901f89a0>]}
[0m23:11:05.326373 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:11:05.357868 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m23:11:05.495194 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m23:11:05.496307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '03e0a3ef-c737-46d3-942c-c315c22c051d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd091b89c70>]}
[0m23:11:07.598608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03e0a3ef-c737-46d3-942c-c315c22c051d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08f44efa0>]}
[0m23:11:07.614533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03e0a3ef-c737-46d3-942c-c315c22c051d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08f1c6d00>]}
[0m23:11:07.615982 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m23:11:07.617002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03e0a3ef-c737-46d3-942c-c315c22c051d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08f44edc0>]}
[0m23:11:07.618886 [info ] [MainThread]: 
[0m23:11:07.620072 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:11:07.621737 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:11:07.718936 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:11:07.720331 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:11:07.721454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:07.728911 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m23:11:07.731606 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:11:07.734110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m23:11:07.745368 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m23:11:07.746395 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m23:11:07.747326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:11:07.752597 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m23:11:07.753648 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m23:11:07.754738 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:11:07.758611 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m23:11:07.760694 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m23:11:07.761872 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m23:11:07.769431 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:07.770423 [debug] [MainThread]: On master: BEGIN
[0m23:11:07.771265 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:11:07.776099 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:11:07.777025 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:07.778150 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:11:07.784385 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m23:11:07.786230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03e0a3ef-c737-46d3-942c-c315c22c051d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08f87deb0>]}
[0m23:11:07.787305 [debug] [MainThread]: On master: ROLLBACK
[0m23:11:07.788528 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:07.789338 [debug] [MainThread]: On master: BEGIN
[0m23:11:07.790745 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:11:07.791539 [debug] [MainThread]: On master: COMMIT
[0m23:11:07.792315 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:07.793097 [debug] [MainThread]: On master: COMMIT
[0m23:11:07.794219 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:11:07.795028 [debug] [MainThread]: On master: Close
[0m23:11:07.796156 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:11:07.797052 [info ] [MainThread]: 
[0m23:11:07.807051 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:11:07.808358 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m23:11:07.809425 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m23:11:07.810255 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:11:07.822529 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:11:07.827036 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:11:07.885540 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:11:07.887853 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:11:07.888746 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m23:11:07.889636 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:11:07.894803 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m23:11:07.895804 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:11:07.896926 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    select
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minute from open_time) = 0 
            and extract(second from open_time) = 0
                then true
            when extract(minute from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as include_flag
            

    from source

)

select * from final
  );
  
[0m23:11:07.900504 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "quote" does not exist
LINE 31:         quote,
                 ^

[0m23:11:07.901570 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: ROLLBACK
[0m23:11:07.902994 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m23:11:07.907006 [debug] [Thread-1  ]: Database Error in model stg_kaggle__btcusdt (models/staging/kaggle/stg_kaggle__btcusdt.sql)
  column "quote" does not exist
  LINE 31:         quote,
                   ^
  compiled code at target/run/dbt_btc_transform/models/staging/kaggle/stg_kaggle__btcusdt.sql
[0m23:11:07.909931 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e0a3ef-c737-46d3-942c-c315c22c051d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08f87d580>]}
[0m23:11:07.911650 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model analytics.stg_kaggle__btcusdt ............ [[31mERROR[0m in 0.10s]
[0m23:11:07.913134 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:11:07.917200 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:07.918169 [debug] [MainThread]: On master: BEGIN
[0m23:11:07.919367 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:11:07.924710 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:11:07.925709 [debug] [MainThread]: On master: COMMIT
[0m23:11:07.926565 [debug] [MainThread]: Using postgres connection "master"
[0m23:11:07.927451 [debug] [MainThread]: On master: COMMIT
[0m23:11:07.928580 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:11:07.929457 [debug] [MainThread]: On master: Close
[0m23:11:07.930507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:07.931360 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m23:11:07.932423 [info ] [MainThread]: 
[0m23:11:07.933367 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m23:11:07.934730 [debug] [MainThread]: Command end result
[0m23:11:07.935550 [info ] [MainThread]: 
[0m23:11:07.936530 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:11:07.937444 [info ] [MainThread]: 
[0m23:11:07.938691 [error] [MainThread]:   Database Error in model stg_kaggle__btcusdt (models/staging/kaggle/stg_kaggle__btcusdt.sql)
  column "quote" does not exist
  LINE 31:         quote,
                   ^
  compiled code at target/run/dbt_btc_transform/models/staging/kaggle/stg_kaggle__btcusdt.sql
[0m23:11:07.939735 [info ] [MainThread]: 
[0m23:11:07.940853 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:11:07.942488 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.015794, "process_user_time": 4.803863, "process_kernel_time": 0.169619, "process_mem_max_rss": "113160", "process_out_blocks": "1109", "command_success": false, "process_in_blocks": "0"}
[0m23:11:07.943612 [debug] [MainThread]: Command `dbt run` failed at 23:11:07.943470 after 3.02 seconds
[0m23:11:07.944613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd092bc80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd090136610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd08f1c6130>]}
[0m23:11:07.945718 [debug] [MainThread]: Flushing usage events
[0m23:12:42.691809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd910901130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90e5996a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90e599640>]}


============================== 23:12:42.700482 | 588563db-cc79-4439-95ac-a9de2019a7e3 ==============================
[0m23:12:42.700482 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:12:42.701873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:12:42.945981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '588563db-cc79-4439-95ac-a9de2019a7e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90df78df0>]}
[0m23:12:43.029649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '588563db-cc79-4439-95ac-a9de2019a7e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd910e8a040>]}
[0m23:12:43.031113 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:12:43.063444 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m23:12:43.219449 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m23:12:43.220935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '588563db-cc79-4439-95ac-a9de2019a7e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90f941b50>]}
[0m23:12:45.652648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '588563db-cc79-4439-95ac-a9de2019a7e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90cf4f130>]}
[0m23:12:45.667693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '588563db-cc79-4439-95ac-a9de2019a7e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90cf06ca0>]}
[0m23:12:45.669029 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m23:12:45.670008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '588563db-cc79-4439-95ac-a9de2019a7e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90cf4fe50>]}
[0m23:12:45.671997 [info ] [MainThread]: 
[0m23:12:45.673256 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:12:45.675207 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:12:45.771561 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:12:45.772899 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:12:45.774041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:45.781329 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m23:12:45.784025 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:12:45.786574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m23:12:45.798547 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m23:12:45.799757 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m23:12:45.800752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:45.806384 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:12:45.807698 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m23:12:45.808842 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:12:45.813762 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m23:12:45.815927 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m23:12:45.817195 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m23:12:45.824990 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:45.825943 [debug] [MainThread]: On master: BEGIN
[0m23:12:45.826784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:12:45.831823 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:12:45.832815 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:45.834004 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:12:45.840567 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m23:12:45.842576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '588563db-cc79-4439-95ac-a9de2019a7e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90d334f70>]}
[0m23:12:45.843585 [debug] [MainThread]: On master: ROLLBACK
[0m23:12:45.844756 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:45.845533 [debug] [MainThread]: On master: BEGIN
[0m23:12:45.846835 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:12:45.847650 [debug] [MainThread]: On master: COMMIT
[0m23:12:45.848466 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:45.849313 [debug] [MainThread]: On master: COMMIT
[0m23:12:45.850362 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:12:45.851234 [debug] [MainThread]: On master: Close
[0m23:12:45.852268 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:12:45.853472 [info ] [MainThread]: 
[0m23:12:45.863296 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:12:45.864938 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m23:12:45.866075 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m23:12:45.866989 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:12:45.879246 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:12:45.883513 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:12:45.943278 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:12:45.947651 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:12:45.948803 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m23:12:45.949784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:12:45.954906 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m23:12:45.956056 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:12:45.957044 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    select
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minute from open_time) = 0 
            and extract(second from open_time) = 0
                then true
            when extract(minute from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as include_flag
            

    from source

)

select * from final
  );
  
[0m23:12:45.960121 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "quote" does not exist
LINE 31:         quote,
                 ^

[0m23:12:45.961060 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: ROLLBACK
[0m23:12:45.962328 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m23:12:45.965495 [debug] [Thread-1  ]: Database Error in model stg_kaggle__btcusdt (models/staging/kaggle/stg_kaggle__btcusdt.sql)
  column "quote" does not exist
  LINE 31:         quote,
                   ^
  compiled code at target/run/dbt_btc_transform/models/staging/kaggle/stg_kaggle__btcusdt.sql
[0m23:12:45.967879 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '588563db-cc79-4439-95ac-a9de2019a7e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90dbd58e0>]}
[0m23:12:45.969100 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model analytics.stg_kaggle__btcusdt ............ [[31mERROR[0m in 0.10s]
[0m23:12:45.970356 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:12:45.973096 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:45.973925 [debug] [MainThread]: On master: BEGIN
[0m23:12:45.974691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:12:45.980122 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:12:45.981039 [debug] [MainThread]: On master: COMMIT
[0m23:12:45.981854 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:45.982696 [debug] [MainThread]: On master: COMMIT
[0m23:12:45.983726 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:12:45.984522 [debug] [MainThread]: On master: Close
[0m23:12:45.985574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:45.986390 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m23:12:45.987264 [info ] [MainThread]: 
[0m23:12:45.988550 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m23:12:45.989939 [debug] [MainThread]: Command end result
[0m23:12:45.990697 [info ] [MainThread]: 
[0m23:12:45.991576 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:12:45.992526 [info ] [MainThread]: 
[0m23:12:45.993536 [error] [MainThread]:   Database Error in model stg_kaggle__btcusdt (models/staging/kaggle/stg_kaggle__btcusdt.sql)
  column "quote" does not exist
  LINE 31:         quote,
                   ^
  compiled code at target/run/dbt_btc_transform/models/staging/kaggle/stg_kaggle__btcusdt.sql
[0m23:12:45.994405 [info ] [MainThread]: 
[0m23:12:45.995300 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:12:45.996823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.3803005, "process_user_time": 5.428149, "process_kernel_time": 0.148536, "process_mem_max_rss": "113112", "process_out_blocks": "1109", "command_success": false, "process_in_blocks": "0"}
[0m23:12:45.997858 [debug] [MainThread]: Command `dbt run` failed at 23:12:45.997676 after 3.38 seconds
[0m23:12:45.998885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd910901130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90dbdc6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd90cf06160>]}
[0m23:12:45.999670 [debug] [MainThread]: Flushing usage events
[0m23:12:51.826881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef7161070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef4dd9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef4dd95b0>]}


============================== 23:12:51.835264 | d3b0583e-9057-4728-8871-31352d5c652e ==============================
[0m23:12:51.835264 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:12:51.836602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:12:52.079473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3b0583e-9057-4728-8871-31352d5c652e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef60fde80>]}
[0m23:12:52.154580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3b0583e-9057-4728-8871-31352d5c652e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef5a79a90>]}
[0m23:12:52.156366 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:12:52.187673 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m23:12:52.429707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:12:52.430562 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:12:52.484696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3b0583e-9057-4728-8871-31352d5c652e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef3e9adc0>]}
[0m23:12:52.500665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3b0583e-9057-4728-8871-31352d5c652e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef3ebbca0>]}
[0m23:12:52.501994 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m23:12:52.503046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3b0583e-9057-4728-8871-31352d5c652e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef3fd3610>]}
[0m23:12:52.505187 [info ] [MainThread]: 
[0m23:12:52.506482 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:12:52.508345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:12:52.617315 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:12:52.618654 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:12:52.619954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:52.627804 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m23:12:52.630560 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:12:52.633427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m23:12:52.645413 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m23:12:52.646656 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m23:12:52.647726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:12:52.653547 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:12:52.654724 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m23:12:52.655888 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:12:52.660144 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m23:12:52.662557 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m23:12:52.664019 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m23:12:52.672580 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:52.673595 [debug] [MainThread]: On master: BEGIN
[0m23:12:52.674475 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:12:52.680228 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:12:52.681561 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:52.683008 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:12:52.690698 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m23:12:52.693005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3b0583e-9057-4728-8871-31352d5c652e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef47d9d60>]}
[0m23:12:52.694372 [debug] [MainThread]: On master: ROLLBACK
[0m23:12:52.695728 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:52.696803 [debug] [MainThread]: On master: BEGIN
[0m23:12:52.698440 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:12:52.699496 [debug] [MainThread]: On master: COMMIT
[0m23:12:52.700500 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:52.701453 [debug] [MainThread]: On master: COMMIT
[0m23:12:52.702733 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:12:52.703711 [debug] [MainThread]: On master: Close
[0m23:12:52.704933 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:12:52.706016 [info ] [MainThread]: 
[0m23:12:52.716608 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:12:52.718185 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m23:12:52.719463 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m23:12:52.720457 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:12:52.734566 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:12:52.737511 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:12:52.804591 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:12:52.807938 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:12:52.809123 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m23:12:52.810184 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:12:52.815439 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m23:12:52.816568 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:12:52.817795 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    select
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minute from open_time) = 0 
            and extract(second from open_time) = 0
                then true
            when extract(minute from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as include_flag
            

    from source

)

select * from final
  );
  
[0m23:12:52.820271 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "quote" does not exist
LINE 31:         quote,
                 ^

[0m23:12:52.821337 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: ROLLBACK
[0m23:12:52.822996 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m23:12:52.826895 [debug] [Thread-1  ]: Database Error in model stg_kaggle__btcusdt (models/staging/kaggle/stg_kaggle__btcusdt.sql)
  column "quote" does not exist
  LINE 31:         quote,
                   ^
  compiled code at target/run/dbt_btc_transform/models/staging/kaggle/stg_kaggle__btcusdt.sql
[0m23:12:52.829537 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b0583e-9057-4728-8871-31352d5c652e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef4df62e0>]}
[0m23:12:52.830877 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model analytics.stg_kaggle__btcusdt ............ [[31mERROR[0m in 0.11s]
[0m23:12:52.832399 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:12:52.835384 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:52.836490 [debug] [MainThread]: On master: BEGIN
[0m23:12:52.837501 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:12:52.842801 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:12:52.843956 [debug] [MainThread]: On master: COMMIT
[0m23:12:52.844954 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:52.845944 [debug] [MainThread]: On master: COMMIT
[0m23:12:52.847330 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:12:52.848308 [debug] [MainThread]: On master: Close
[0m23:12:52.849748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:52.850864 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m23:12:52.851879 [info ] [MainThread]: 
[0m23:12:52.852868 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m23:12:52.854679 [debug] [MainThread]: Command end result
[0m23:12:52.855615 [info ] [MainThread]: 
[0m23:12:52.856728 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:12:52.857659 [info ] [MainThread]: 
[0m23:12:52.858888 [error] [MainThread]:   Database Error in model stg_kaggle__btcusdt (models/staging/kaggle/stg_kaggle__btcusdt.sql)
  column "quote" does not exist
  LINE 31:         quote,
                   ^
  compiled code at target/run/dbt_btc_transform/models/staging/kaggle/stg_kaggle__btcusdt.sql
[0m23:12:52.859960 [info ] [MainThread]: 
[0m23:12:52.861031 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:12:52.862809 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1130038, "process_user_time": 3.196153, "process_kernel_time": 0.188789, "process_mem_max_rss": "109336", "process_out_blocks": "32", "command_success": false, "process_in_blocks": "0"}
[0m23:12:52.864140 [debug] [MainThread]: Command `dbt run` failed at 23:12:52.863976 after 1.11 seconds
[0m23:12:52.865366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef7161070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef5a79a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef3ebb2b0>]}
[0m23:12:52.866426 [debug] [MainThread]: Flushing usage events
[0m23:13:57.404562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e3b75130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e17d96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e17d9640>]}


============================== 23:13:57.411706 | b4967f96-d4df-4a0c-b473-0340d0a32256 ==============================
[0m23:13:57.411706 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:13:57.412973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:13:57.652499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4967f96-d4df-4a0c-b473-0340d0a32256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e1a22070>]}
[0m23:13:57.724604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4967f96-d4df-4a0c-b473-0340d0a32256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e1997f70>]}
[0m23:13:57.726173 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:13:57.756034 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m23:13:57.900569 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m23:13:57.901685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4967f96-d4df-4a0c-b473-0340d0a32256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e2b9eb50>]}
[0m23:14:00.016553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4967f96-d4df-4a0c-b473-0340d0a32256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e01ce130>]}
[0m23:14:00.032932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4967f96-d4df-4a0c-b473-0340d0a32256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e0186ca0>]}
[0m23:14:00.034062 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m23:14:00.034966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4967f96-d4df-4a0c-b473-0340d0a32256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e01cee20>]}
[0m23:14:00.036692 [info ] [MainThread]: 
[0m23:14:00.037812 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:14:00.040109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:14:00.138136 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:14:00.139420 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:14:00.140950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:00.148338 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m23:14:00.151115 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:14:00.153794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m23:14:00.166172 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m23:14:00.167348 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m23:14:00.168323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:14:00.174135 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:14:00.175349 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m23:14:00.176515 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:14:00.180495 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m23:14:00.182669 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m23:14:00.183906 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m23:14:00.191616 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:00.192677 [debug] [MainThread]: On master: BEGIN
[0m23:14:00.193597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:14:00.198657 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:14:00.199668 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:00.200960 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:14:00.207648 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m23:14:00.209576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4967f96-d4df-4a0c-b473-0340d0a32256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e05f3850>]}
[0m23:14:00.210577 [debug] [MainThread]: On master: ROLLBACK
[0m23:14:00.211674 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:00.212698 [debug] [MainThread]: On master: BEGIN
[0m23:14:00.214014 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:14:00.214890 [debug] [MainThread]: On master: COMMIT
[0m23:14:00.215694 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:00.216583 [debug] [MainThread]: On master: COMMIT
[0m23:14:00.217705 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:14:00.218605 [debug] [MainThread]: On master: Close
[0m23:14:00.219667 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:14:00.220909 [info ] [MainThread]: 
[0m23:14:00.231057 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:14:00.232291 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m23:14:00.233365 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m23:14:00.234276 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:14:00.246560 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:00.248880 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:14:00.306225 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:00.309760 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:00.310915 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m23:14:00.311882 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:14:00.316680 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m23:14:00.318040 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:00.319112 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    select
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote_asset_volume,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minute from open_time) = 0 
            and extract(second from open_time) = 0
                then true
            when extract(minute from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as include_flag
            

    from source

)

select * from final
  );
  
[0m23:14:00.338406 [debug] [Thread-1  ]: SQL status: SELECT 9999 in 0.018 seconds
[0m23:14:00.347443 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:00.348415 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp" rename to "stg_kaggle__btcusdt"
[0m23:14:00.349813 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:00.373573 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m23:14:00.374553 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:00.375554 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m23:14:00.379756 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m23:14:00.390217 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup"
[0m23:14:00.396432 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:00.397397 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
drop table if exists "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup" cascade
[0m23:14:00.398697 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m23:14:00.402018 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m23:14:00.404331 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4967f96-d4df-4a0c-b473-0340d0a32256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e379ea30>]}
[0m23:14:00.405690 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.stg_kaggle__btcusdt ................ [[32mSELECT 9999[0m in 0.17s]
[0m23:14:00.407044 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:14:00.409947 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:00.410730 [debug] [MainThread]: On master: BEGIN
[0m23:14:00.411633 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:14:00.416346 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:14:00.417233 [debug] [MainThread]: On master: COMMIT
[0m23:14:00.418051 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:00.419188 [debug] [MainThread]: On master: COMMIT
[0m23:14:00.420283 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:14:00.421077 [debug] [MainThread]: On master: Close
[0m23:14:00.422192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:14:00.423135 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m23:14:00.423969 [info ] [MainThread]: 
[0m23:14:00.424882 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m23:14:00.426287 [debug] [MainThread]: Command end result
[0m23:14:00.427048 [info ] [MainThread]: 
[0m23:14:00.427996 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:14:00.428828 [info ] [MainThread]: 
[0m23:14:00.429718 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:14:00.431194 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0994291, "process_user_time": 4.848788, "process_kernel_time": 0.151838, "process_mem_max_rss": "113044", "process_out_blocks": "1110", "process_in_blocks": "0"}
[0m23:14:00.432223 [debug] [MainThread]: Command `dbt run` succeeded at 23:14:00.432107 after 3.10 seconds
[0m23:14:00.433134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e3b75130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e10d7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e1997f70>]}
[0m23:14:00.434019 [debug] [MainThread]: Flushing usage events
[0m23:14:05.281402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c143220a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c11f98640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c11f985e0>]}


============================== 23:14:05.288652 | d9c73ad3-7e7b-45ec-b860-4d7fc735dc16 ==============================
[0m23:14:05.288652 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:14:05.289898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models stg_kaggle__btcusdt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:14:05.530573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9c73ad3-7e7b-45ec-b860-4d7fc735dc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c121d8d30>]}
[0m23:14:05.602390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9c73ad3-7e7b-45ec-b860-4d7fc735dc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c11fc8a60>]}
[0m23:14:05.603762 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:14:05.640377 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m23:14:05.867551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:14:05.868460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:14:05.920690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9c73ad3-7e7b-45ec-b860-4d7fc735dc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c1105bdf0>]}
[0m23:14:05.945723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9c73ad3-7e7b-45ec-b860-4d7fc735dc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c11193940>]}
[0m23:14:05.946888 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m23:14:05.947881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9c73ad3-7e7b-45ec-b860-4d7fc735dc16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c115977f0>]}
[0m23:14:05.949610 [info ] [MainThread]: 
[0m23:14:05.950550 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:14:05.953469 [debug] [MainThread]: Command end result
[0m23:14:05.955054 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7458737, "process_user_time": 2.664843, "process_kernel_time": 0.129893, "process_mem_max_rss": "103428", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m23:14:05.957088 [debug] [MainThread]: Command `dbt test` succeeded at 23:14:05.956610 after 0.75 seconds
[0m23:14:05.958940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c143220a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c119b42b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c11193970>]}
[0m23:14:05.959927 [debug] [MainThread]: Flushing usage events
[0m23:14:10.585834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad3afcefa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad38c6b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad38c6b790>]}


============================== 23:14:10.593934 | c2a5db0a-2585-4756-bf81-9b8fd7019922 ==============================
[0m23:14:10.593934 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:14:10.595111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m23:14:10.818332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2a5db0a-2585-4756-bf81-9b8fd7019922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad38c91fd0>]}
[0m23:14:10.889288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2a5db0a-2585-4756-bf81-9b8fd7019922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad3b55fee0>]}
[0m23:14:10.890651 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:14:10.922077 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:14:11.092000 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:14:11.093694 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25
[0m23:14:11.094859 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:14:11.095903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c2a5db0a-2585-4756-bf81-9b8fd7019922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad3a026220>]}
[0m23:14:13.368982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2a5db0a-2585-4756-bf81-9b8fd7019922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad3784d130>]}
[0m23:14:13.383773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2a5db0a-2585-4756-bf81-9b8fd7019922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad375cae80>]}
[0m23:14:13.384881 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m23:14:13.385809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2a5db0a-2585-4756-bf81-9b8fd7019922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad375cadc0>]}
[0m23:14:13.387848 [info ] [MainThread]: 
[0m23:14:13.389001 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:14:13.390828 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m23:14:13.496734 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m23:14:13.498245 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m23:14:13.499403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:13.508470 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m23:14:13.509882 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m23:14:13.511784 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m23:14:13.516990 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m23:14:13.519713 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m23:14:13.521291 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m23:14:13.531929 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:13.533282 [debug] [MainThread]: On master: BEGIN
[0m23:14:13.534369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:14:13.540892 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:14:13.542301 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:13.544012 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:14:13.554019 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m23:14:13.556361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2a5db0a-2585-4756-bf81-9b8fd7019922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad375e8430>]}
[0m23:14:13.557614 [debug] [MainThread]: On master: ROLLBACK
[0m23:14:13.559101 [debug] [MainThread]: On master: Close
[0m23:14:13.561007 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:14:13.562335 [info ] [MainThread]: 
[0m23:14:13.591199 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:14:13.592607 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m23:14:13.594125 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:14:13.609649 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:13.612286 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:14:13.613973 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:14:13.616556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:14:13.617626 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m23:14:13.619052 [debug] [MainThread]: Command end result
[0m23:14:13.845214 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m23:14:13.851032 [info ] [MainThread]: Building catalog
[0m23:14:13.896811 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m23:14:13.912966 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m23:14:13.914393 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m23:14:13.916248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:13.922936 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:14:13.924317 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m23:14:13.925892 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('btcusdt')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_kaggle__btcusdt')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m23:14:13.932691 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.004 seconds
[0m23:14:13.942850 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m23:14:13.944928 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m23:14:14.056468 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m23:14:14.058132 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.551128, "process_user_time": 5.419331, "process_kernel_time": 0.164776, "process_mem_max_rss": "166628", "process_out_blocks": "6167", "process_in_blocks": "0"}
[0m23:14:14.059536 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:14:14.059328 after 3.55 seconds
[0m23:14:14.060617 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:14:14.061625 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m23:14:14.062692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad3afcefa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad3aa42c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad381a9910>]}
[0m23:14:14.063913 [debug] [MainThread]: Flushing usage events
[0m23:14:19.938662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f481b70a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f45e2b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f45e2b5e0>]}


============================== 23:14:19.946819 | d8d208c0-56c8-4e20-afb0-9f9fad52ffdf ==============================
[0m23:14:19.946819 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:14:19.948135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:14:20.187490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8d208c0-56c8-4e20-afb0-9f9fad52ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f47dca310>]}
[0m23:14:20.264814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8d208c0-56c8-4e20-afb0-9f9fad52ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f457f99a0>]}
[0m23:14:20.266289 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:14:20.298465 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m23:14:20.439719 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:14:20.440841 [debug] [MainThread]: previous checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m23:14:20.441668 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:14:20.442631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd8d208c0-56c8-4e20-afb0-9f9fad52ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f47178c70>]}
[0m23:14:22.686820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8d208c0-56c8-4e20-afb0-9f9fad52ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f44a4bfa0>]}
[0m23:14:22.700060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8d208c0-56c8-4e20-afb0-9f9fad52ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f447c6d00>]}
[0m23:14:22.701240 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m23:14:22.702166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d208c0-56c8-4e20-afb0-9f9fad52ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f44a4bdc0>]}
[0m23:14:22.703903 [info ] [MainThread]: 
[0m23:14:22.705168 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:14:22.706734 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:14:22.808413 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:14:22.809920 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:14:22.811094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:22.818704 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m23:14:22.821375 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:14:22.824149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m23:14:22.836243 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m23:14:22.837517 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m23:14:22.838744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:14:22.845174 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:14:22.846463 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m23:14:22.847681 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:14:22.852010 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m23:14:22.854461 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m23:14:22.855809 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m23:14:22.864527 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:22.865631 [debug] [MainThread]: On master: BEGIN
[0m23:14:22.866658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:14:22.872035 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:14:22.873057 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:22.874274 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:14:22.882131 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m23:14:22.884107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d208c0-56c8-4e20-afb0-9f9fad52ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f44e76d30>]}
[0m23:14:22.885504 [debug] [MainThread]: On master: ROLLBACK
[0m23:14:22.886791 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:22.887772 [debug] [MainThread]: On master: BEGIN
[0m23:14:22.889215 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:14:22.890088 [debug] [MainThread]: On master: COMMIT
[0m23:14:22.890900 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:22.891784 [debug] [MainThread]: On master: COMMIT
[0m23:14:22.892908 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:14:22.893754 [debug] [MainThread]: On master: Close
[0m23:14:22.894941 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:14:22.895962 [info ] [MainThread]: 
[0m23:14:22.906125 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:14:22.907479 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m23:14:22.908521 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m23:14:22.909452 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:14:22.921976 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:22.926107 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:14:22.985373 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:22.992386 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:22.994362 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m23:14:22.996870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:14:23.005836 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m23:14:23.007000 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:23.008148 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    select
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote_asset_volume,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minute from open_time) = 0 
            and extract(second from open_time) = 0
                then true
            when extract(minute from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as include_flag
            

    from source

)

select * from final
  );
  
[0m23:14:23.027993 [debug] [Thread-1  ]: SQL status: SELECT 9999 in 0.019 seconds
[0m23:14:23.037685 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:23.038904 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt" rename to "stg_kaggle__btcusdt__dbt_backup"
[0m23:14:23.040591 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:23.046395 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:23.047438 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp" rename to "stg_kaggle__btcusdt"
[0m23:14:23.048917 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:14:23.081537 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m23:14:23.082607 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:23.083624 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m23:14:23.087054 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m23:14:23.096603 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup"
[0m23:14:23.103571 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:23.104719 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
drop table if exists "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup" cascade
[0m23:14:23.108021 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m23:14:23.111580 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m23:14:23.114576 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d208c0-56c8-4e20-afb0-9f9fad52ffdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f47dca280>]}
[0m23:14:23.116139 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.stg_kaggle__btcusdt ................ [[32mSELECT 9999[0m in 0.20s]
[0m23:14:23.117492 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:14:23.120452 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:23.121390 [debug] [MainThread]: On master: BEGIN
[0m23:14:23.122156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:14:23.127027 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:14:23.128049 [debug] [MainThread]: On master: COMMIT
[0m23:14:23.129128 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:23.130088 [debug] [MainThread]: On master: COMMIT
[0m23:14:23.131418 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:14:23.132501 [debug] [MainThread]: On master: Close
[0m23:14:23.133674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:14:23.134574 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m23:14:23.135465 [info ] [MainThread]: 
[0m23:14:23.136404 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m23:14:23.137870 [debug] [MainThread]: Command end result
[0m23:14:23.138784 [info ] [MainThread]: 
[0m23:14:23.139938 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:14:23.140932 [info ] [MainThread]: 
[0m23:14:23.141941 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:14:23.143439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.279586, "process_user_time": 5.444683, "process_kernel_time": 0.175765, "process_mem_max_rss": "113100", "process_out_blocks": "1112", "process_in_blocks": "0"}
[0m23:14:23.144746 [debug] [MainThread]: Command `dbt run` succeeded at 23:14:23.144612 after 3.28 seconds
[0m23:14:23.145921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f481b70a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f45736610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f447c64c0>]}
[0m23:14:23.147316 [debug] [MainThread]: Flushing usage events
[0m23:14:27.620685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3971c18fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396f8ab550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396f8ab4f0>]}


============================== 23:14:27.628434 | 1e0edd86-bd78-445a-b30a-80d7651b0c2d ==============================
[0m23:14:27.628434 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:14:27.629663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models stg_kaggle__btcusdt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:14:27.868128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e0edd86-bd78-445a-b30a-80d7651b0c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39717dcf40>]}
[0m23:14:27.942747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e0edd86-bd78-445a-b30a-80d7651b0c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396faba610>]}
[0m23:14:27.944231 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:14:27.975422 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m23:14:28.203721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:14:28.204607 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:14:28.259658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e0edd86-bd78-445a-b30a-80d7651b0c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396e915130>]}
[0m23:14:28.286064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e0edd86-bd78-445a-b30a-80d7651b0c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396ed938e0>]}
[0m23:14:28.287185 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m23:14:28.288092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e0edd86-bd78-445a-b30a-80d7651b0c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396f146220>]}
[0m23:14:28.289824 [info ] [MainThread]: 
[0m23:14:28.290779 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:14:28.293660 [debug] [MainThread]: Command end result
[0m23:14:28.295183 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7498387, "process_user_time": 2.816991, "process_kernel_time": 0.137916, "process_mem_max_rss": "103412", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m23:14:28.296874 [debug] [MainThread]: Command `dbt test` succeeded at 23:14:28.296413 after 0.75 seconds
[0m23:14:28.298244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3971c18fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396f5740a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396ed938e0>]}
[0m23:14:28.299164 [debug] [MainThread]: Flushing usage events
[0m23:14:33.633292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0cd48070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0a9d28b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0a9d2850>]}


============================== 23:14:33.640599 | 94dfc9d7-82ce-4620-bffc-dd0996de8d7f ==============================
[0m23:14:33.640599 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:14:33.641841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:14:33.875510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94dfc9d7-82ce-4620-bffc-dd0996de8d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0a3fc7f0>]}
[0m23:14:33.954562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94dfc9d7-82ce-4620-bffc-dd0996de8d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0a9fd550>]}
[0m23:14:33.956119 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:14:33.990167 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:14:34.144667 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:14:34.145867 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25
[0m23:14:34.146687 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:14:34.147797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '94dfc9d7-82ce-4620-bffc-dd0996de8d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0be04e50>]}
[0m23:14:36.416800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94dfc9d7-82ce-4620-bffc-dd0996de8d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0938d130>]}
[0m23:14:36.433582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94dfc9d7-82ce-4620-bffc-dd0996de8d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0934af10>]}
[0m23:14:36.434758 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m23:14:36.435682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94dfc9d7-82ce-4620-bffc-dd0996de8d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0934ae50>]}
[0m23:14:36.437997 [info ] [MainThread]: 
[0m23:14:36.439004 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:14:36.440539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m23:14:36.536230 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m23:14:36.537468 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m23:14:36.538639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:36.545624 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:14:36.546958 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m23:14:36.548194 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m23:14:36.552396 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m23:14:36.554818 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m23:14:36.556290 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m23:14:36.565048 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:36.566197 [debug] [MainThread]: On master: BEGIN
[0m23:14:36.567187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:14:36.572539 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:14:36.573664 [debug] [MainThread]: Using postgres connection "master"
[0m23:14:36.575094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:14:36.583366 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m23:14:36.585461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94dfc9d7-82ce-4620-bffc-dd0996de8d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c093694c0>]}
[0m23:14:36.586498 [debug] [MainThread]: On master: ROLLBACK
[0m23:14:36.587638 [debug] [MainThread]: On master: Close
[0m23:14:36.588844 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:14:36.589893 [info ] [MainThread]: 
[0m23:14:36.599434 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:14:36.600593 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m23:14:36.601587 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:14:36.615423 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:14:36.617643 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:14:36.619054 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:14:36.621621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:14:36.622488 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m23:14:36.623575 [debug] [MainThread]: Command end result
[0m23:14:36.851697 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m23:14:36.852608 [info ] [MainThread]: Building catalog
[0m23:14:36.868791 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m23:14:36.880608 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m23:14:36.881658 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m23:14:36.882550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:36.888360 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:14:36.889334 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m23:14:36.890511 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_kaggle__btcusdt')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('btcusdt')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m23:14:36.894818 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m23:14:36.903027 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m23:14:36.904595 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m23:14:37.001947 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m23:14:37.003613 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.4569237, "process_user_time": 5.282321, "process_kernel_time": 0.197651, "process_mem_max_rss": "166632", "process_out_blocks": "6167", "process_in_blocks": "0"}
[0m23:14:37.004800 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:14:37.004681 after 3.46 seconds
[0m23:14:37.005629 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:14:37.006451 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m23:14:37.007312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0cd48070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c09ad3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0c7d7700>]}
[0m23:14:37.008214 [debug] [MainThread]: Flushing usage events
[0m23:17:56.220417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89b6ee100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8993596a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff899359640>]}


============================== 23:17:56.229379 | 6a1bd56b-0ba5-4665-b30c-09f03903448f ==============================
[0m23:17:56.229379 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:17:56.230615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:17:56.459373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a1bd56b-0ba5-4665-b30c-09f03903448f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89937f3d0>]}
[0m23:17:56.530359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a1bd56b-0ba5-4665-b30c-09f03903448f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89bc76df0>]}
[0m23:17:56.531700 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:17:56.564004 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m23:17:56.707032 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:17:56.708219 [debug] [MainThread]: previous checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m23:17:56.709049 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:17:56.710079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6a1bd56b-0ba5-4665-b30c-09f03903448f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89a68b2b0>]}
[0m23:17:58.899885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a1bd56b-0ba5-4665-b30c-09f03903448f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff897d4e130>]}
[0m23:17:58.915416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a1bd56b-0ba5-4665-b30c-09f03903448f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff897d06ca0>]}
[0m23:17:58.916804 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m23:17:58.917791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a1bd56b-0ba5-4665-b30c-09f03903448f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff897d4ee20>]}
[0m23:17:58.919608 [info ] [MainThread]: 
[0m23:17:58.920818 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:17:58.922392 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m23:17:59.019232 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m23:17:59.020485 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m23:17:59.021811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:17:59.029365 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m23:17:59.032030 [debug] [ThreadPool]: On list_company_dw: Close
[0m23:17:59.034671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m23:17:59.046025 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m23:17:59.047027 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m23:17:59.047975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:17:59.053351 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m23:17:59.054410 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m23:17:59.055508 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:17:59.059387 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m23:17:59.061452 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m23:17:59.062664 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m23:17:59.070714 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:59.071785 [debug] [MainThread]: On master: BEGIN
[0m23:17:59.072610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:17:59.077844 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:17:59.078808 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:59.080002 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:17:59.086930 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m23:17:59.088700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a1bd56b-0ba5-4665-b30c-09f03903448f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff898141400>]}
[0m23:17:59.089706 [debug] [MainThread]: On master: ROLLBACK
[0m23:17:59.090830 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:59.091626 [debug] [MainThread]: On master: BEGIN
[0m23:17:59.092862 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:17:59.093766 [debug] [MainThread]: On master: COMMIT
[0m23:17:59.094519 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:59.095344 [debug] [MainThread]: On master: COMMIT
[0m23:17:59.096349 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:17:59.097213 [debug] [MainThread]: On master: Close
[0m23:17:59.098216 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:17:59.099090 [info ] [MainThread]: 
[0m23:17:59.108824 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:17:59.110126 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m23:17:59.111171 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m23:17:59.112030 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:17:59.124366 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:17:59.128912 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:17:59.186621 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:17:59.190513 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:17:59.191654 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m23:17:59.192643 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:17:59.197479 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m23:17:59.198523 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:17:59.199904 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    select
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote_asset_volume,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minute from open_time) = 0 
            and extract(second from open_time) = 0
                then true
            when extract(minute from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as include_flag
            

    from source

)

select * from final
  );
  
[0m23:17:59.219298 [debug] [Thread-1  ]: SQL status: SELECT 9999 in 0.017 seconds
[0m23:17:59.228303 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:17:59.229248 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt" rename to "stg_kaggle__btcusdt__dbt_backup"
[0m23:17:59.230646 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:17:59.235282 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:17:59.236179 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp" rename to "stg_kaggle__btcusdt"
[0m23:17:59.237465 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:17:59.265796 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m23:17:59.266929 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:17:59.267935 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m23:17:59.270245 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m23:17:59.279127 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup"
[0m23:17:59.285128 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:17:59.286077 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
drop table if exists "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup" cascade
[0m23:17:59.289483 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m23:17:59.293115 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m23:17:59.295396 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a1bd56b-0ba5-4665-b30c-09f03903448f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89bc21f10>]}
[0m23:17:59.296639 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.stg_kaggle__btcusdt ................ [[32mSELECT 9999[0m in 0.18s]
[0m23:17:59.297966 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:17:59.300736 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:59.301509 [debug] [MainThread]: On master: BEGIN
[0m23:17:59.302274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:17:59.307410 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:17:59.308386 [debug] [MainThread]: On master: COMMIT
[0m23:17:59.309167 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:59.310165 [debug] [MainThread]: On master: COMMIT
[0m23:17:59.311271 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:17:59.312056 [debug] [MainThread]: On master: Close
[0m23:17:59.312984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:17:59.313830 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m23:17:59.314664 [info ] [MainThread]: 
[0m23:17:59.315612 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m23:17:59.316976 [debug] [MainThread]: Command end result
[0m23:17:59.317741 [info ] [MainThread]: 
[0m23:17:59.318621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:17:59.319506 [info ] [MainThread]: 
[0m23:17:59.320410 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:17:59.321765 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1724973, "process_user_time": 4.8642, "process_kernel_time": 0.151055, "process_mem_max_rss": "113016", "process_out_blocks": "1112", "process_in_blocks": "0"}
[0m23:17:59.322763 [debug] [MainThread]: Command `dbt run` succeeded at 23:17:59.322647 after 3.17 seconds
[0m23:17:59.323652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89b6ee100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8989f6d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89bc76df0>]}
[0m23:17:59.324508 [debug] [MainThread]: Flushing usage events
[0m23:18:03.685032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40032480d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4000eab610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4000eab5b0>]}


============================== 23:18:03.692464 | dee36459-abaf-4b3f-9fe9-c2de2fb51fb5 ==============================
[0m23:18:03.692464 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:18:03.693693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models stg_kaggle__btcusdt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:18:03.918015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dee36459-abaf-4b3f-9fe9-c2de2fb51fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4000bd7fa0>]}
[0m23:18:03.985650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dee36459-abaf-4b3f-9fe9-c2de2fb51fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4001069100>]}
[0m23:18:03.986911 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:18:04.016632 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m23:18:04.231663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:18:04.232606 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:18:04.284204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dee36459-abaf-4b3f-9fe9-c2de2fb51fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffff5be20>]}
[0m23:18:04.310238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dee36459-abaf-4b3f-9fe9-c2de2fb51fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f400079c730>]}
[0m23:18:04.311333 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m23:18:04.312244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dee36459-abaf-4b3f-9fe9-c2de2fb51fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40003d3400>]}
[0m23:18:04.314097 [info ] [MainThread]: 
[0m23:18:04.315039 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:18:04.317806 [debug] [MainThread]: Command end result
[0m23:18:04.319170 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.72219104, "process_user_time": 2.584052, "process_kernel_time": 0.102388, "process_mem_max_rss": "103384", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m23:18:04.320917 [debug] [MainThread]: Command `dbt test` succeeded at 23:18:04.320563 after 0.72 seconds
[0m23:18:04.322296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40032480d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4000ec8640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f400079c730>]}
[0m23:18:04.323230 [debug] [MainThread]: Flushing usage events
[0m23:18:08.710281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77f5a1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77d22b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77d22b7f0>]}


============================== 23:18:08.717530 | 50c02cb8-61b0-48e3-8ae5-e7874e0b9373 ==============================
[0m23:18:08.717530 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:18:08.718811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:18:08.945972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50c02cb8-61b0-48e3-8ae5-e7874e0b9373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77f18a850>]}
[0m23:18:09.014299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50c02cb8-61b0-48e3-8ae5-e7874e0b9373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77cbdbca0>]}
[0m23:18:09.015595 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:18:09.044932 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:18:09.179114 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:18:09.180161 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25
[0m23:18:09.180949 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:18:09.181885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '50c02cb8-61b0-48e3-8ae5-e7874e0b9373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77e5e4a90>]}
[0m23:18:11.278607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50c02cb8-61b0-48e3-8ae5-e7874e0b9373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77bbcd130>]}
[0m23:18:11.293066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50c02cb8-61b0-48e3-8ae5-e7874e0b9373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77bb8aee0>]}
[0m23:18:11.294032 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m23:18:11.295118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50c02cb8-61b0-48e3-8ae5-e7874e0b9373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77bb8ae20>]}
[0m23:18:11.297122 [info ] [MainThread]: 
[0m23:18:11.298189 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:18:11.299662 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m23:18:11.395917 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m23:18:11.397192 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m23:18:11.398235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:11.407387 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m23:18:11.408794 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m23:18:11.409956 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m23:18:11.414315 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m23:18:11.416720 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m23:18:11.418164 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m23:18:11.426651 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:11.427853 [debug] [MainThread]: On master: BEGIN
[0m23:18:11.428812 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:18:11.434181 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:18:11.435232 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:11.436510 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:18:11.444368 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m23:18:11.446384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50c02cb8-61b0-48e3-8ae5-e7874e0b9373', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77bba9490>]}
[0m23:18:11.447387 [debug] [MainThread]: On master: ROLLBACK
[0m23:18:11.448537 [debug] [MainThread]: On master: Close
[0m23:18:11.449764 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:18:11.450681 [info ] [MainThread]: 
[0m23:18:11.460045 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:18:11.461171 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m23:18:11.462075 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:18:11.474692 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m23:18:11.476988 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:18:11.478299 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m23:18:11.481267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:11.482040 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m23:18:11.483213 [debug] [MainThread]: Command end result
[0m23:18:11.671207 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m23:18:11.671999 [info ] [MainThread]: Building catalog
[0m23:18:11.687070 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m23:18:11.698532 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m23:18:11.699458 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m23:18:11.700223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:11.705199 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m23:18:11.706100 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m23:18:11.707152 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_kaggle__btcusdt')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('btcusdt')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m23:18:11.710765 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m23:18:11.717554 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m23:18:11.718733 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m23:18:11.798771 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m23:18:11.800436 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.1597471, "process_user_time": 4.832584, "process_kernel_time": 0.158378, "process_mem_max_rss": "166628", "process_out_blocks": "6167", "process_in_blocks": "0"}
[0m23:18:11.801566 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:18:11.801449 after 3.16 seconds
[0m23:18:11.802423 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:18:11.803327 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m23:18:11.804112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77f5a1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77fb349d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd77f048dc0>]}
[0m23:18:11.805015 [debug] [MainThread]: Flushing usage events
[0m16:13:07.818990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a4ca22b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a255a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a255a5b0>]}


============================== 16:13:07.827610 | 0e64dfa5-1180-4930-b7bb-fb55bae0adf6 ==============================
[0m16:13:07.827610 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:13:07.829119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'send_anonymous_usage_stats': 'True'}
[0m16:13:08.244942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e64dfa5-1180-4930-b7bb-fb55bae0adf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a39fc6a0>]}
[0m16:13:08.321608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e64dfa5-1180-4930-b7bb-fb55bae0adf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a324efa0>]}
[0m16:13:08.323031 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:13:08.355549 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m16:13:08.496660 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m16:13:08.497755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0e64dfa5-1180-4930-b7bb-fb55bae0adf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a39a1880>]}
[0m16:13:10.729381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e64dfa5-1180-4930-b7bb-fb55bae0adf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a0f05ee0>]}
[0m16:13:10.747674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e64dfa5-1180-4930-b7bb-fb55bae0adf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a0ec3ca0>]}
[0m16:13:10.748925 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m16:13:10.749818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e64dfa5-1180-4930-b7bb-fb55bae0adf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a0f05d00>]}
[0m16:13:10.751497 [info ] [MainThread]: 
[0m16:13:10.752678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:13:10.754245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m16:13:10.866609 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m16:13:10.867838 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:13:10.868837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:10.876217 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m16:13:10.878867 [debug] [ThreadPool]: On list_company_dw: Close
[0m16:13:10.880631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now create_company_dw_analytics)
[0m16:13:10.882001 [debug] [ThreadPool]: Creating schema "database: "company_dw"
schema: "analytics"
"
[0m16:13:10.892095 [debug] [ThreadPool]: Using postgres connection "create_company_dw_analytics"
[0m16:13:10.893446 [debug] [ThreadPool]: On create_company_dw_analytics: BEGIN
[0m16:13:10.894438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:10.900003 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m16:13:10.901138 [debug] [ThreadPool]: Using postgres connection "create_company_dw_analytics"
[0m16:13:10.902163 [debug] [ThreadPool]: On create_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "create_company_dw_analytics"} */
create schema if not exists "analytics"
[0m16:13:10.904032 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m16:13:10.905840 [debug] [ThreadPool]: On create_company_dw_analytics: COMMIT
[0m16:13:10.906741 [debug] [ThreadPool]: Using postgres connection "create_company_dw_analytics"
[0m16:13:10.907623 [debug] [ThreadPool]: On create_company_dw_analytics: COMMIT
[0m16:13:10.912945 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m16:13:10.913805 [debug] [ThreadPool]: On create_company_dw_analytics: Close
[0m16:13:10.915846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_company_dw_analytics, now list_company_dw_analytics)
[0m16:13:10.925192 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m16:13:10.926127 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m16:13:10.926952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:10.932024 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:13:10.933022 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m16:13:10.933975 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m16:13:10.937861 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m16:13:10.939847 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m16:13:10.940970 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m16:13:10.948695 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:10.949631 [debug] [MainThread]: On master: BEGIN
[0m16:13:10.950423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:13:10.956170 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:13:10.957238 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:10.958539 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:13:10.967308 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m16:13:10.969505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e64dfa5-1180-4930-b7bb-fb55bae0adf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a12c8df0>]}
[0m16:13:10.970526 [debug] [MainThread]: On master: ROLLBACK
[0m16:13:10.971699 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:10.972558 [debug] [MainThread]: On master: BEGIN
[0m16:13:10.974030 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:13:10.974935 [debug] [MainThread]: On master: COMMIT
[0m16:13:10.975709 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:10.976498 [debug] [MainThread]: On master: COMMIT
[0m16:13:10.977578 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:13:10.978421 [debug] [MainThread]: On master: Close
[0m16:13:10.979488 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:13:10.980335 [info ] [MainThread]: 
[0m16:13:10.989521 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m16:13:10.990685 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m16:13:10.991784 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m16:13:10.992747 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m16:13:11.004948 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:13:11.010049 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m16:13:11.074547 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:13:11.080580 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:13:11.081619 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m16:13:11.082477 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:11.087594 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m16:13:11.088560 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:13:11.089669 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    select
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote_asset_volume,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minute from open_time) = 0 
            and extract(second from open_time) = 0
                then true
            when extract(minute from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as include_flag
            

    from source

)

select * from final
  );
  
[0m16:13:13.138529 [debug] [Thread-1  ]: SQL status: SELECT 999999 in 2.047 seconds
[0m16:13:13.150641 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:13:13.151729 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp" rename to "stg_kaggle__btcusdt"
[0m16:13:13.153174 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:13:13.179632 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m16:13:13.180752 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:13:13.181692 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m16:13:13.191882 [debug] [Thread-1  ]: SQL status: COMMIT in 0.009 seconds
[0m16:13:13.201395 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup"
[0m16:13:13.208302 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:13:13.209337 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
drop table if exists "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup" cascade
[0m16:13:13.210875 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m16:13:13.214333 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m16:13:13.216757 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e64dfa5-1180-4930-b7bb-fb55bae0adf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a12da0d0>]}
[0m16:13:13.218081 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.stg_kaggle__btcusdt ................ [[32mSELECT 999999[0m in 2.22s]
[0m16:13:13.219683 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m16:13:13.222838 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:13.223644 [debug] [MainThread]: On master: BEGIN
[0m16:13:13.224384 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:13:13.231095 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:13:13.232153 [debug] [MainThread]: On master: COMMIT
[0m16:13:13.233017 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:13.233771 [debug] [MainThread]: On master: COMMIT
[0m16:13:13.235010 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:13:13.235985 [debug] [MainThread]: On master: Close
[0m16:13:13.237035 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:13.237814 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m16:13:13.238710 [info ] [MainThread]: 
[0m16:13:13.239800 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m16:13:13.241131 [debug] [MainThread]: Command end result
[0m16:13:13.241935 [info ] [MainThread]: 
[0m16:13:13.242914 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:13:13.244029 [info ] [MainThread]: 
[0m16:13:13.245648 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:13:13.248241 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5113916, "process_user_time": 5.761952, "process_kernel_time": 0.262413, "process_mem_max_rss": "113148", "process_out_blocks": "2193", "process_in_blocks": "0"}
[0m16:13:13.249480 [debug] [MainThread]: Command `dbt run` succeeded at 16:13:13.249301 after 5.51 seconds
[0m16:13:13.250445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a4ca22b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a12c8520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a12e3100>]}
[0m16:13:13.251286 [debug] [MainThread]: Flushing usage events
[0m16:13:17.247002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5198ee0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc517559610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5175595b0>]}


============================== 16:13:17.256914 | a9e42890-9fba-40c6-9f11-028facde1d78 ==============================
[0m16:13:17.256914 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:13:17.258227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models stg_kaggle__btcusdt', 'send_anonymous_usage_stats': 'True'}
[0m16:13:17.524529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9e42890-9fba-40c6-9f11-028facde1d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc519499430>]}
[0m16:13:17.599962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9e42890-9fba-40c6-9f11-028facde1d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc517717100>]}
[0m16:13:17.601369 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:13:17.631996 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m16:13:17.873442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:13:17.874282 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:13:17.932794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9e42890-9fba-40c6-9f11-028facde1d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5163d7e20>]}
[0m16:13:17.966244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9e42890-9fba-40c6-9f11-028facde1d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5167659a0>]}
[0m16:13:17.967326 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m16:13:17.968406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9e42890-9fba-40c6-9f11-028facde1d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc518246670>]}
[0m16:13:17.970447 [info ] [MainThread]: 
[0m16:13:17.971438 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:13:17.974359 [debug] [MainThread]: Command end result
[0m16:13:17.975890 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.8229299, "process_user_time": 2.768388, "process_kernel_time": 0.15952, "process_mem_max_rss": "103396", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m16:13:17.977181 [debug] [MainThread]: Command `dbt test` succeeded at 16:13:17.977046 after 0.82 seconds
[0m16:13:17.978188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5198ee0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc517576640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc517717100>]}
[0m16:13:17.979167 [debug] [MainThread]: Flushing usage events
[0m16:13:23.968498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f10fcb070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f0ec2b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f0ec2b850>]}


============================== 16:13:23.977326 | 72234519-498d-46a8-9238-6156c7a3589f ==============================
[0m16:13:23.977326 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:13:23.978606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m16:13:24.205970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72234519-498d-46a8-9238-6156c7a3589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f10bca7f0>]}
[0m16:13:24.284382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72234519-498d-46a8-9238-6156c7a3589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f0ec56550>]}
[0m16:13:24.285947 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:13:24.315796 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:13:24.464800 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:13:24.465947 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25
[0m16:13:24.466813 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:13:24.467791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '72234519-498d-46a8-9238-6156c7a3589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f10084e50>]}
[0m16:13:26.681728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72234519-498d-46a8-9238-6156c7a3589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f0d84f130>]}
[0m16:13:26.698647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72234519-498d-46a8-9238-6156c7a3589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f0d5c7be0>]}
[0m16:13:26.700198 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m16:13:26.701434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72234519-498d-46a8-9238-6156c7a3589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f0d5c7b20>]}
[0m16:13:26.703575 [info ] [MainThread]: 
[0m16:13:26.704819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:13:26.706573 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m16:13:26.804404 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m16:13:26.805677 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m16:13:26.806825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:26.813606 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m16:13:26.814962 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m16:13:26.816203 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:13:26.820952 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m16:13:26.823459 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m16:13:26.825281 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m16:13:26.835301 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:26.836487 [debug] [MainThread]: On master: BEGIN
[0m16:13:26.837600 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:13:26.843497 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:13:26.844651 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:26.846311 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:13:26.855734 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m16:13:26.858234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72234519-498d-46a8-9238-6156c7a3589f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f0d5ea190>]}
[0m16:13:26.859420 [debug] [MainThread]: On master: ROLLBACK
[0m16:13:26.860656 [debug] [MainThread]: On master: Close
[0m16:13:26.861971 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:13:26.862993 [info ] [MainThread]: 
[0m16:13:26.874256 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m16:13:26.875469 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m16:13:26.876453 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m16:13:26.890473 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:13:26.892944 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m16:13:26.894387 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m16:13:26.896927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:26.897723 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m16:13:26.899111 [debug] [MainThread]: Command end result
[0m16:13:27.100382 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m16:13:27.101231 [info ] [MainThread]: Building catalog
[0m16:13:27.115429 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m16:13:27.127249 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m16:13:27.128388 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m16:13:27.129230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:27.134275 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:13:27.135288 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m16:13:27.136416 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('btcusdt')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_kaggle__btcusdt')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m16:13:27.141406 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.004 seconds
[0m16:13:27.148825 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m16:13:27.151044 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m16:13:27.230362 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m16:13:27.231974 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.340287, "process_user_time": 5.820462, "process_kernel_time": 0.233607, "process_mem_max_rss": "191600", "process_out_blocks": "6167", "process_in_blocks": "0"}
[0m16:13:27.233289 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:13:27.233134 after 3.34 seconds
[0m16:13:27.234171 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:13:27.234936 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m16:13:27.235708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f10fcb070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f0e5e3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f0ec4f070>]}
[0m16:13:27.236600 [debug] [MainThread]: Flushing usage events
[0m16:18:13.608774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2672435070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26700ab610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26700ab5b0>]}


============================== 16:18:13.618344 | cdd8018c-cd81-403a-a0c8-5a4cba209bee ==============================
[0m16:18:13.618344 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:18:13.619693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'send_anonymous_usage_stats': 'True'}
[0m16:18:13.842434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdd8018c-cd81-403a-a0c8-5a4cba209bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266fde1490>]}
[0m16:18:13.911860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdd8018c-cd81-403a-a0c8-5a4cba209bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2670d46d00>]}
[0m16:18:13.913164 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:18:13.944399 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m16:18:14.093334 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:18:14.094423 [debug] [MainThread]: previous checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m16:18:14.095284 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:18:14.096238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cdd8018c-cd81-403a-a0c8-5a4cba209bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26714e2e50>]}
[0m16:18:16.270116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdd8018c-cd81-403a-a0c8-5a4cba209bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266eccafd0>]}
[0m16:18:16.283870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdd8018c-cd81-403a-a0c8-5a4cba209bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266ec84ca0>]}
[0m16:18:16.285411 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m16:18:16.286333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd8018c-cd81-403a-a0c8-5a4cba209bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266eccad00>]}
[0m16:18:16.288220 [info ] [MainThread]: 
[0m16:18:16.289426 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:18:16.290954 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m16:18:16.389863 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m16:18:16.391133 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:18:16.392279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:16.399247 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m16:18:16.402081 [debug] [ThreadPool]: On list_company_dw: Close
[0m16:18:16.404684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m16:18:16.415428 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m16:18:16.416390 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m16:18:16.417290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:18:16.422541 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:18:16.423595 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m16:18:16.424607 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m16:18:16.428306 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m16:18:16.430372 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m16:18:16.431586 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m16:18:16.439303 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:16.440349 [debug] [MainThread]: On master: BEGIN
[0m16:18:16.441264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:18:16.446060 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:18:16.447018 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:16.448273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:18:16.455841 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m16:18:16.457868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd8018c-cd81-403a-a0c8-5a4cba209bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266f06a340>]}
[0m16:18:16.458849 [debug] [MainThread]: On master: ROLLBACK
[0m16:18:16.460024 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:16.460915 [debug] [MainThread]: On master: BEGIN
[0m16:18:16.462333 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:18:16.463106 [debug] [MainThread]: On master: COMMIT
[0m16:18:16.464002 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:16.464857 [debug] [MainThread]: On master: COMMIT
[0m16:18:16.465973 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:18:16.466802 [debug] [MainThread]: On master: Close
[0m16:18:16.467889 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:18:16.468984 [info ] [MainThread]: 
[0m16:18:16.478923 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m16:18:16.480356 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m16:18:16.481439 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m16:18:16.482352 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m16:18:16.494676 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:18:16.499480 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m16:18:16.558937 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:18:16.563199 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:18:16.564328 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m16:18:16.565254 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:18:16.570841 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m16:18:16.572171 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:18:16.574196 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    select
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote_asset_volume,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minute from open_time) = 0 
            and extract(second from open_time) = 0
                then true
            when extract(minute from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as include_flag
            

    from source

)

select * from final
  );
  
[0m16:18:19.093710 [debug] [Thread-1  ]: SQL status: SELECT 999999 in 2.518 seconds
[0m16:18:19.103600 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:18:19.104630 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt" rename to "stg_kaggle__btcusdt__dbt_backup"
[0m16:18:19.106145 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:18:19.110993 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:18:19.112037 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp" rename to "stg_kaggle__btcusdt"
[0m16:18:19.113408 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:18:19.142028 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m16:18:19.143105 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:18:19.144057 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m16:18:19.151707 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m16:18:19.161167 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup"
[0m16:18:19.167202 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:18:19.168184 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
drop table if exists "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup" cascade
[0m16:18:19.181990 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.013 seconds
[0m16:18:19.185728 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m16:18:19.188231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd8018c-cd81-403a-a0c8-5a4cba209bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f267229e250>]}
[0m16:18:19.189620 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.stg_kaggle__btcusdt ................ [[32mSELECT 999999[0m in 2.71s]
[0m16:18:19.190877 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m16:18:19.194087 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:19.194969 [debug] [MainThread]: On master: BEGIN
[0m16:18:19.195769 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:18:19.201129 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:18:19.202227 [debug] [MainThread]: On master: COMMIT
[0m16:18:19.203029 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:19.203849 [debug] [MainThread]: On master: COMMIT
[0m16:18:19.205219 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:18:19.206018 [debug] [MainThread]: On master: Close
[0m16:18:19.207080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:18:19.208773 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m16:18:19.209591 [info ] [MainThread]: 
[0m16:18:19.210515 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m16:18:19.211854 [debug] [MainThread]: Command end result
[0m16:18:19.212919 [info ] [MainThread]: 
[0m16:18:19.213895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:18:19.214799 [info ] [MainThread]: 
[0m16:18:19.215725 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:18:19.217201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.677456, "process_user_time": 4.864631, "process_kernel_time": 0.175465, "process_mem_max_rss": "113000", "process_out_blocks": "1112", "process_in_blocks": "0"}
[0m16:18:19.218554 [debug] [MainThread]: Command `dbt run` succeeded at 16:18:19.218434 after 5.68 seconds
[0m16:18:19.219445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2672435070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266f9b65e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2670d46d00>]}
[0m16:18:19.220303 [debug] [MainThread]: Flushing usage events
[0m16:18:23.681351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3afa15070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ad6ab610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ad6ab5b0>]}


============================== 16:18:23.688804 | f8e68f1e-2d75-4b06-b55e-c7f7594c921a ==============================
[0m16:18:23.688804 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:18:23.689963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models stg_kaggle__btcusdt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:18:23.911049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8e68f1e-2d75-4b06-b55e-c7f7594c921a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ad3cd490>]}
[0m16:18:23.981847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8e68f1e-2d75-4b06-b55e-c7f7594c921a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ae327d00>]}
[0m16:18:23.983255 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:18:24.014333 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m16:18:24.236509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:18:24.237651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:18:24.291274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8e68f1e-2d75-4b06-b55e-c7f7594c921a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ac717dc0>]}
[0m16:18:24.317779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8e68f1e-2d75-4b06-b55e-c7f7594c921a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3acba1940>]}
[0m16:18:24.318788 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m16:18:24.319689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8e68f1e-2d75-4b06-b55e-c7f7594c921a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3acf760a0>]}
[0m16:18:24.321567 [info ] [MainThread]: 
[0m16:18:24.322468 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:18:24.325444 [debug] [MainThread]: Command end result
[0m16:18:24.326869 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7178794, "process_user_time": 2.623779, "process_kernel_time": 0.145428, "process_mem_max_rss": "103352", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m16:18:24.328330 [debug] [MainThread]: Command `dbt test` succeeded at 16:18:24.328156 after 0.72 seconds
[0m16:18:24.329873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3afa15070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ad3a86a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3acba1970>]}
[0m16:18:24.330862 [debug] [MainThread]: Flushing usage events
[0m16:18:29.861084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2194be8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f219286b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f219286b850>]}


============================== 16:18:29.868868 | 43643194-7cc7-4890-a46e-a918398718ee ==============================
[0m16:18:29.868868 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:18:29.870101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:18:30.093041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43643194-7cc7-4890-a46e-a918398718ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21947ca7f0>]}
[0m16:18:30.168341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43643194-7cc7-4890-a46e-a918398718ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2192896550>]}
[0m16:18:30.169973 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:18:30.201280 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:18:30.343112 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:18:30.344353 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25
[0m16:18:30.345406 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:18:30.346701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43643194-7cc7-4890-a46e-a918398718ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2193ca1e50>]}
[0m16:18:32.628131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43643194-7cc7-4890-a46e-a918398718ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2191490130>]}
[0m16:18:32.642909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43643194-7cc7-4890-a46e-a918398718ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2191446be0>]}
[0m16:18:32.644110 [info ] [MainThread]: Found 1 model, 1 source, 540 macros
[0m16:18:32.645133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43643194-7cc7-4890-a46e-a918398718ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2191446b20>]}
[0m16:18:32.647180 [info ] [MainThread]: 
[0m16:18:32.648335 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:18:32.649897 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m16:18:32.752066 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m16:18:32.753303 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m16:18:32.754468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:32.761056 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m16:18:32.762319 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m16:18:32.763665 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:18:32.767828 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m16:18:32.770221 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m16:18:32.771767 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m16:18:32.780504 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:32.781688 [debug] [MainThread]: On master: BEGIN
[0m16:18:32.782747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:18:32.788288 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:18:32.789414 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:32.790806 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:18:32.798928 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m16:18:32.800993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43643194-7cc7-4890-a46e-a918398718ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f219146c160>]}
[0m16:18:32.802043 [debug] [MainThread]: On master: ROLLBACK
[0m16:18:32.803159 [debug] [MainThread]: On master: Close
[0m16:18:32.804298 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:18:32.805227 [info ] [MainThread]: 
[0m16:18:32.814876 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m16:18:32.816040 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m16:18:32.817066 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m16:18:32.830216 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m16:18:32.832434 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m16:18:32.833963 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m16:18:32.836778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:18:32.837612 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m16:18:32.838959 [debug] [MainThread]: Command end result
[0m16:18:33.005981 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m16:18:33.006790 [info ] [MainThread]: Building catalog
[0m16:18:33.022306 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m16:18:33.034462 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m16:18:33.035464 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m16:18:33.036367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:33.041288 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m16:18:33.042301 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m16:18:33.043387 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_kaggle__btcusdt')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('btcusdt')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m16:18:33.047959 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m16:18:33.055374 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m16:18:33.056650 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m16:18:33.130368 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m16:18:33.131942 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.349978, "process_user_time": 5.222258, "process_kernel_time": 0.178296, "process_mem_max_rss": "191628", "process_out_blocks": "6167", "process_in_blocks": "0"}
[0m16:18:33.132978 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:18:33.132859 after 3.35 seconds
[0m16:18:33.133701 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:18:33.134354 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m16:18:33.135177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2194be8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f219300fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f219465c700>]}
[0m16:18:33.136030 [debug] [MainThread]: Flushing usage events
[0m18:06:36.553928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3af610d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e38bd9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e38bd95b0>]}


============================== 18:06:36.564145 | 68c84c7e-c5ea-4fef-9dfe-63ea114ac2e5 ==============================
[0m18:06:36.564145 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:06:36.565705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:06:36.805474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68c84c7e-c5ea-4fef-9dfe-63ea114ac2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3ab18430>]}
[0m18:06:36.889791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68c84c7e-c5ea-4fef-9dfe-63ea114ac2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e38d97100>]}
[0m18:06:36.891685 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:06:36.927135 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:06:37.109953 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:06:37.111057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '68c84c7e-c5ea-4fef-9dfe-63ea114ac2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e39f14880>]}
[0m18:06:39.422655 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:06:39.423809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '68c84c7e-c5ea-4fef-9dfe-63ea114ac2e5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e375d4cd0>]}
[0m18:06:39.860029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68c84c7e-c5ea-4fef-9dfe-63ea114ac2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e38153040>]}
[0m18:06:39.876931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68c84c7e-c5ea-4fef-9dfe-63ea114ac2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3849fd90>]}
[0m18:06:39.878111 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:06:39.879083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68c84c7e-c5ea-4fef-9dfe-63ea114ac2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e381534f0>]}
[0m18:06:39.881332 [info ] [MainThread]: 
[0m18:06:39.882717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:06:39.884529 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m18:06:39.931198 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m18:06:39.932332 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m18:06:39.933216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:39.939749 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m18:06:39.941822 [debug] [ThreadPool]: On list_company_dw: Close
[0m18:06:39.948774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m18:06:39.957985 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:06:39.958943 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:06:39.959800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:39.964572 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:06:39.965503 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:06:39.966433 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:06:39.970729 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m18:06:39.972819 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:06:39.973969 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:06:39.981409 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:39.982358 [debug] [MainThread]: On master: BEGIN
[0m18:06:39.983156 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:39.988033 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:06:39.989047 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:39.990183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:06:39.998288 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:06:40.000441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68c84c7e-c5ea-4fef-9dfe-63ea114ac2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3aaf22e0>]}
[0m18:06:40.001460 [debug] [MainThread]: On master: ROLLBACK
[0m18:06:40.002579 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:40.003390 [debug] [MainThread]: On master: BEGIN
[0m18:06:40.004986 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:06:40.005942 [debug] [MainThread]: On master: COMMIT
[0m18:06:40.006805 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:40.007754 [debug] [MainThread]: On master: COMMIT
[0m18:06:40.008866 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:06:40.009901 [debug] [MainThread]: On master: Close
[0m18:06:40.011220 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:06:40.012647 [info ] [MainThread]: 
[0m18:06:40.024331 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:06:40.025640 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m18:06:40.026754 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m18:06:40.027678 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:06:40.041106 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:06:40.044150 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:06:40.100263 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:06:40.104060 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:06:40.105297 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m18:06:40.106361 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:40.111725 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m18:06:40.112837 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:06:40.114086 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    select
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote_asset_volume,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        open_time::date as open_date,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minutes from open_time) = 0
            and extract(second from open_time) = 0
                then true
            else false
        end as hour_start,

        case    
            when extract(minute from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as hour_end
            

    from source

)

select * from final
  );
  
[0m18:06:42.642285 [debug] [Thread-1  ]: SQL status: SELECT 999999 in 2.527 seconds
[0m18:06:42.651950 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:06:42.652944 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt" rename to "stg_kaggle__btcusdt__dbt_backup"
[0m18:06:42.654557 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:06:42.659298 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:06:42.660282 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp" rename to "stg_kaggle__btcusdt"
[0m18:06:42.661615 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:06:42.688176 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m18:06:42.689366 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:06:42.690320 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m18:06:42.709981 [debug] [Thread-1  ]: SQL status: COMMIT in 0.019 seconds
[0m18:06:42.721569 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup"
[0m18:06:42.729120 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:06:42.730481 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
drop table if exists "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup" cascade
[0m18:06:42.760683 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.029 seconds
[0m18:06:42.774483 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m18:06:42.778231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68c84c7e-c5ea-4fef-9dfe-63ea114ac2e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e37157af0>]}
[0m18:06:42.779675 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.stg_kaggle__btcusdt ................ [[32mSELECT 999999[0m in 2.75s]
[0m18:06:42.780995 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:06:42.784124 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:42.785046 [debug] [MainThread]: On master: BEGIN
[0m18:06:42.785921 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:42.791030 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:06:42.791969 [debug] [MainThread]: On master: COMMIT
[0m18:06:42.793075 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:42.793890 [debug] [MainThread]: On master: COMMIT
[0m18:06:42.794913 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:06:42.795756 [debug] [MainThread]: On master: Close
[0m18:06:42.796712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:42.797495 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m18:06:42.798351 [info ] [MainThread]: 
[0m18:06:42.799286 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m18:06:42.800704 [debug] [MainThread]: Command end result
[0m18:06:42.801506 [info ] [MainThread]: 
[0m18:06:42.802475 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:42.803325 [info ] [MainThread]: 
[0m18:06:42.804275 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:06:42.805737 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.331311, "process_user_time": 5.761764, "process_kernel_time": 0.294647, "process_mem_max_rss": "114964", "process_out_blocks": "1187", "process_in_blocks": "0"}
[0m18:06:42.806796 [debug] [MainThread]: Command `dbt run` succeeded at 18:06:42.806676 after 6.33 seconds
[0m18:06:42.807710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3af610d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3758ef40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e38d97100>]}
[0m18:06:42.808604 [debug] [MainThread]: Flushing usage events
[0m18:06:47.545032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1299df040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12766b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12766b520>]}


============================== 18:06:47.555505 | c2fd8b9b-ad71-424f-bf22-6a94e1e80419 ==============================
[0m18:06:47.555505 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:06:47.557633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models stg_kaggle__btcusdt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:06:47.829785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2fd8b9b-ad71-424f-bf22-6a94e1e80419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe127692580>]}
[0m18:06:47.910715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2fd8b9b-ad71-424f-bf22-6a94e1e80419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe128351c40>]}
[0m18:06:47.912165 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:06:47.944055 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:06:48.345787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:48.347524 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:48.445308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2fd8b9b-ad71-424f-bf22-6a94e1e80419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe126696130>]}
[0m18:06:48.478295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2fd8b9b-ad71-424f-bf22-6a94e1e80419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1267d9250>]}
[0m18:06:48.479718 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:06:48.480985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2fd8b9b-ad71-424f-bf22-6a94e1e80419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1267cc0d0>]}
[0m18:06:48.486100 [info ] [MainThread]: 
[0m18:06:48.488072 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:06:48.496997 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analytics'
[0m18:06:48.645009 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:06:48.646579 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:06:48.647806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:48.659214 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:06:48.660498 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:06:48.661706 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:06:48.669703 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m18:06:48.672571 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:06:48.674223 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:06:48.685635 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:48.686874 [debug] [MainThread]: On master: BEGIN
[0m18:06:48.687973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:48.694736 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:06:48.696068 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:48.697745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:06:48.714789 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m18:06:48.720145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2fd8b9b-ad71-424f-bf22-6a94e1e80419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe12625c910>]}
[0m18:06:48.722777 [debug] [MainThread]: On master: ROLLBACK
[0m18:06:48.725765 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:48.727877 [debug] [MainThread]: On master: BEGIN
[0m18:06:48.730683 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:06:48.732344 [debug] [MainThread]: On master: COMMIT
[0m18:06:48.733791 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:48.735825 [debug] [MainThread]: On master: COMMIT
[0m18:06:48.738636 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:06:48.742582 [debug] [MainThread]: On master: Close
[0m18:06:48.746689 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:06:48.749170 [info ] [MainThread]: 
[0m18:06:48.772635 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:06:48.773934 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:06:48.775186 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:06:48.776522 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:06:48.777597 [info ] [Thread-1  ]: 1 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_end__True__False ... [RUN]
[0m18:06:48.779507 [info ] [Thread-2  ]: 2 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_start__True__False . [RUN]
[0m18:06:48.781458 [info ] [Thread-3  ]: 3 of 18 START test not_null_stg_kaggle__btcusdt_close .......................... [RUN]
[0m18:06:48.783804 [info ] [Thread-4  ]: 4 of 18 START test not_null_stg_kaggle__btcusdt_close_time ..................... [RUN]
[0m18:06:48.786228 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872)
[0m18:06:48.788067 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m18:06:48.790040 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb'
[0m18:06:48.791759 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a'
[0m18:06:48.793205 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:06:48.794637 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:06:48.796104 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:06:48.797483 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:06:48.854034 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:06:48.856210 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:06:48.857085 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:06:48.863531 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:06:48.867889 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:06:48.869364 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:06:48.876887 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:06:48.877919 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:06:48.896886 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:06:48.901878 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:06:48.908107 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:06:48.912197 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:06:48.916617 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:06:48.918629 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: BEGIN
[0m18:06:48.919641 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:06:48.920861 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:06:48.921762 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:06:48.922532 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:06:48.923425 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: BEGIN
[0m18:06:48.924884 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: BEGIN
[0m18:06:48.926371 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: BEGIN
[0m18:06:48.927434 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:48.928451 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:06:48.929452 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:06:48.930185 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m18:06:48.933215 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:06:48.934775 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close is null



      
    ) dbt_internal_test
[0m18:06:48.936382 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m18:06:48.937478 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m18:06:48.939177 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m18:06:48.940210 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:06:48.941899 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:06:48.943358 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:06:48.944799 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_end as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_end

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m18:06:48.946618 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is null



      
    ) dbt_internal_test
[0m18:06:48.948305 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_start as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_start

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m18:06:49.046968 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.111 seconds
[0m18:06:49.058789 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: ROLLBACK
[0m18:06:49.060063 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.109 seconds
[0m18:06:49.063811 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: ROLLBACK
[0m18:06:49.064851 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: Close
[0m18:06:49.065830 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.116 seconds
[0m18:06:49.067092 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: Close
[0m18:06:49.068490 [info ] [Thread-3  ]: 3 of 18 PASS not_null_stg_kaggle__btcusdt_close ................................ [[32mPASS[0m in 0.28s]
[0m18:06:49.071657 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: ROLLBACK
[0m18:06:49.073303 [info ] [Thread-4  ]: 4 of 18 PASS not_null_stg_kaggle__btcusdt_close_time ........................... [[32mPASS[0m in 0.28s]
[0m18:06:49.075120 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:06:49.076691 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: Close
[0m18:06:49.077724 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:06:49.078968 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:06:49.080537 [info ] [Thread-1  ]: 1 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_end__True__False ......... [[32mPASS[0m in 0.29s]
[0m18:06:49.081844 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:06:49.083069 [info ] [Thread-3  ]: 5 of 18 START test not_null_stg_kaggle__btcusdt_high ........................... [RUN]
[0m18:06:49.085117 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:06:49.086746 [info ] [Thread-4  ]: 6 of 18 START test not_null_stg_kaggle__btcusdt_hour_end ....................... [RUN]
[0m18:06:49.088160 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m18:06:49.089603 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:06:49.090436 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.138 seconds
[0m18:06:49.091724 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m18:06:49.092794 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:06:49.094027 [info ] [Thread-1  ]: 7 of 18 START test not_null_stg_kaggle__btcusdt_hour_start ..................... [RUN]
[0m18:06:49.096853 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: ROLLBACK
[0m18:06:49.097905 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:06:49.104810 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:06:49.105847 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m18:06:49.107293 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: Close
[0m18:06:49.113120 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:06:49.114659 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:06:49.116774 [info ] [Thread-2  ]: 2 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_start__True__False ....... [[32mPASS[0m in 0.33s]
[0m18:06:49.117840 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:06:49.125106 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:06:49.126905 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:06:49.128023 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:06:49.132312 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:06:49.134286 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:06:49.140581 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:06:49.142283 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:06:49.143440 [info ] [Thread-2  ]: 8 of 18 START test not_null_stg_kaggle__btcusdt_low ............................ [RUN]
[0m18:06:49.144927 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:06:49.149145 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:06:49.150801 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m18:06:49.152252 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: BEGIN
[0m18:06:49.153357 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:06:49.155227 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:06:49.156424 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:06:49.157490 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:06:49.158190 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: BEGIN
[0m18:06:49.165305 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:06:49.167858 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: BEGIN
[0m18:06:49.169492 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:06:49.171381 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:49.172369 [debug] [Thread-3  ]: SQL status: BEGIN in 0.016 seconds
[0m18:06:49.173688 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:06:49.175852 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:06:49.180814 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:06:49.181693 [debug] [Thread-4  ]: SQL status: BEGIN in 0.012 seconds
[0m18:06:49.183669 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where high is null



      
    ) dbt_internal_test
[0m18:06:49.185410 [debug] [Thread-1  ]: SQL status: BEGIN in 0.014 seconds
[0m18:06:49.187255 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:06:49.189045 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:06:49.190011 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:06:49.191563 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_end
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_end is null



      
    ) dbt_internal_test
[0m18:06:49.192948 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: BEGIN
[0m18:06:49.194371 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_start
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_start is null



      
    ) dbt_internal_test
[0m18:06:49.196198 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:06:49.206893 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m18:06:49.208970 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:06:49.210822 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where low is null



      
    ) dbt_internal_test
[0m18:06:49.256549 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.068 seconds
[0m18:06:49.260697 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: ROLLBACK
[0m18:06:49.262837 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: Close
[0m18:06:49.265108 [info ] [Thread-3  ]: 5 of 18 PASS not_null_stg_kaggle__btcusdt_high ................................. [[32mPASS[0m in 0.18s]
[0m18:06:49.268144 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:06:49.270523 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:06:49.272197 [info ] [Thread-3  ]: 9 of 18 START test not_null_stg_kaggle__btcusdt_number_of_trades ............... [RUN]
[0m18:06:49.273872 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m18:06:49.275519 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:06:49.286620 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:06:49.290866 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.092 seconds
[0m18:06:49.291803 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:06:49.292680 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.097 seconds
[0m18:06:49.295204 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: ROLLBACK
[0m18:06:49.300247 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:06:49.303712 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: ROLLBACK
[0m18:06:49.304573 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.092 seconds
[0m18:06:49.305780 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: Close
[0m18:06:49.307370 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: Close
[0m18:06:49.309739 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: ROLLBACK
[0m18:06:49.311179 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:06:49.312993 [info ] [Thread-1  ]: 7 of 18 PASS not_null_stg_kaggle__btcusdt_hour_start ........................... [[32mPASS[0m in 0.21s]
[0m18:06:49.315035 [info ] [Thread-4  ]: 6 of 18 PASS not_null_stg_kaggle__btcusdt_hour_end ............................. [[32mPASS[0m in 0.22s]
[0m18:06:49.317316 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: Close
[0m18:06:49.319009 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: BEGIN
[0m18:06:49.320829 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:06:49.322417 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:06:49.324015 [info ] [Thread-2  ]: 8 of 18 PASS not_null_stg_kaggle__btcusdt_low .................................. [[32mPASS[0m in 0.17s]
[0m18:06:49.325289 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:06:49.326717 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:06:49.328111 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:06:49.329664 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:06:49.331736 [info ] [Thread-1  ]: 10 of 18 START test not_null_stg_kaggle__btcusdt_open .......................... [RUN]
[0m18:06:49.333530 [info ] [Thread-4  ]: 11 of 18 START test not_null_stg_kaggle__btcusdt_open_date ..................... [RUN]
[0m18:06:49.335405 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:06:49.336425 [debug] [Thread-3  ]: SQL status: BEGIN in 0.011 seconds
[0m18:06:49.337508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m18:06:49.338707 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m18:06:49.339967 [info ] [Thread-2  ]: 12 of 18 START test not_null_stg_kaggle__btcusdt_open_time ..................... [RUN]
[0m18:06:49.341305 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:06:49.342421 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:06:49.343548 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:06:49.344709 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m18:06:49.345843 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select number_of_trades
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where number_of_trades is null



      
    ) dbt_internal_test
[0m18:06:49.367591 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:06:49.375571 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:06:49.376703 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:06:49.388595 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:06:49.390104 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:06:49.391365 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:06:49.396432 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:06:49.397787 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:06:49.403140 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:06:49.408780 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:06:49.410630 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:06:49.412700 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:06:49.413594 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: BEGIN
[0m18:06:49.414789 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: BEGIN
[0m18:06:49.416160 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:06:49.418226 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:49.419742 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:06:49.421085 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: BEGIN
[0m18:06:49.424133 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:06:49.427991 [debug] [Thread-4  ]: SQL status: BEGIN in 0.008 seconds
[0m18:06:49.428869 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m18:06:49.430062 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:06:49.431001 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.053 seconds
[0m18:06:49.431837 [debug] [Thread-2  ]: SQL status: BEGIN in 0.008 seconds
[0m18:06:49.432868 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:06:49.434074 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_date
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_date is null



      
    ) dbt_internal_test
[0m18:06:49.436936 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: ROLLBACK
[0m18:06:49.438054 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:06:49.439304 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open is null



      
    ) dbt_internal_test
[0m18:06:49.441084 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: Close
[0m18:06:49.441910 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is null



      
    ) dbt_internal_test
[0m18:06:49.444424 [info ] [Thread-3  ]: 9 of 18 PASS not_null_stg_kaggle__btcusdt_number_of_trades ..................... [[32mPASS[0m in 0.17s]
[0m18:06:49.447097 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:06:49.450651 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:06:49.452857 [info ] [Thread-3  ]: 13 of 18 START test not_null_stg_kaggle__btcusdt_quote_asset_volume ............ [RUN]
[0m18:06:49.454759 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m18:06:49.456261 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:06:49.469704 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:06:49.472653 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:06:49.480320 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:06:49.485451 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:06:49.487814 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: BEGIN
[0m18:06:49.489575 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:06:49.499113 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m18:06:49.501626 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:06:49.503741 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where quote_asset_volume is null



      
    ) dbt_internal_test
[0m18:06:49.509502 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.066 seconds
[0m18:06:49.513553 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: ROLLBACK
[0m18:06:49.514941 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.069 seconds
[0m18:06:49.517496 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: Close
[0m18:06:49.521787 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: ROLLBACK
[0m18:06:49.524020 [info ] [Thread-1  ]: 10 of 18 PASS not_null_stg_kaggle__btcusdt_open ................................ [[32mPASS[0m in 0.19s]
[0m18:06:49.525322 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.085 seconds
[0m18:06:49.526848 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: Close
[0m18:06:49.528083 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:06:49.531091 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: ROLLBACK
[0m18:06:49.532972 [info ] [Thread-2  ]: 12 of 18 PASS not_null_stg_kaggle__btcusdt_open_time ........................... [[32mPASS[0m in 0.19s]
[0m18:06:49.535086 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:06:49.536952 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: Close
[0m18:06:49.538170 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:06:49.539606 [info ] [Thread-1  ]: 14 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ... [RUN]
[0m18:06:49.541553 [info ] [Thread-4  ]: 11 of 18 PASS not_null_stg_kaggle__btcusdt_open_date ........................... [[32mPASS[0m in 0.20s]
[0m18:06:49.543168 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:06:49.544733 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m18:06:49.546447 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:06:49.547726 [info ] [Thread-2  ]: 15 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume .. [RUN]
[0m18:06:49.549126 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:06:49.551394 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:06:49.552868 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m18:06:49.560424 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:06:49.561618 [info ] [Thread-4  ]: 16 of 18 START test not_null_stg_kaggle__btcusdt_volume ........................ [RUN]
[0m18:06:49.563048 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:06:49.565127 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m18:06:49.573110 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:06:49.574429 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:06:49.575313 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:06:49.581125 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:06:49.582251 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.077 seconds
[0m18:06:49.589783 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:06:49.591478 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:06:49.594817 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: ROLLBACK
[0m18:06:49.600844 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:06:49.602392 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:06:49.604292 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: Close
[0m18:06:49.606068 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: BEGIN
[0m18:06:49.606914 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:06:49.608612 [info ] [Thread-3  ]: 13 of 18 PASS not_null_stg_kaggle__btcusdt_quote_asset_volume .................. [[32mPASS[0m in 0.15s]
[0m18:06:49.609688 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:06:49.610705 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:49.615379 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:06:49.617873 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:06:49.619620 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: BEGIN
[0m18:06:49.622624 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:06:49.623916 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:06:49.626598 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:06:49.627541 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m18:06:49.625795 [info ] [Thread-3  ]: 17 of 18 START test unique_stg_kaggle__btcusdt_close_time ...................... [RUN]
[0m18:06:49.630540 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: BEGIN
[0m18:06:49.632809 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:06:49.635812 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m18:06:49.637973 [debug] [Thread-2  ]: SQL status: BEGIN in 0.014 seconds
[0m18:06:49.639769 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:06:49.641849 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_base_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_base_asset_volume is null



      
    ) dbt_internal_test
[0m18:06:49.643669 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:06:49.645466 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:06:49.659029 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:06:49.660219 [debug] [Thread-4  ]: SQL status: BEGIN in 0.021 seconds
[0m18:06:49.661496 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_quote_asset_volume is null



      
    ) dbt_internal_test
[0m18:06:49.663433 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:06:49.665341 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:06:49.666531 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where volume is null



      
    ) dbt_internal_test
[0m18:06:49.673175 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:06:49.677554 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:06:49.680785 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: BEGIN
[0m18:06:49.682459 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:06:49.691566 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m18:06:49.693173 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:06:49.694996 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    close_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is not null
group by close_time
having count(*) > 1



      
    ) dbt_internal_test
[0m18:06:49.723969 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.076 seconds
[0m18:06:49.730088 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: ROLLBACK
[0m18:06:49.732925 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: Close
[0m18:06:49.736004 [info ] [Thread-1  ]: 14 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ......... [[32mPASS[0m in 0.19s]
[0m18:06:49.740013 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:06:49.742468 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:06:49.744780 [info ] [Thread-1  ]: 18 of 18 START test unique_stg_kaggle__btcusdt_open_time ....................... [RUN]
[0m18:06:49.747792 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m18:06:49.750233 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:06:49.758826 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.094 seconds
[0m18:06:49.763058 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:06:49.764252 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.089 seconds
[0m18:06:49.767210 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: ROLLBACK
[0m18:06:49.772082 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: ROLLBACK
[0m18:06:49.774491 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: Close
[0m18:06:49.775386 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:06:49.776980 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: Close
[0m18:06:49.778591 [info ] [Thread-2  ]: 15 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume ........ [[32mPASS[0m in 0.23s]
[0m18:06:49.787085 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:06:49.790293 [info ] [Thread-4  ]: 16 of 18 PASS not_null_stg_kaggle__btcusdt_volume .............................. [[32mPASS[0m in 0.22s]
[0m18:06:49.792852 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:06:49.795840 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:06:49.798551 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:06:49.800432 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: BEGIN
[0m18:06:49.801821 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:49.808658 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m18:06:49.810439 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:06:49.812674 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    open_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is not null
group by open_time
having count(*) > 1



      
    ) dbt_internal_test
[0m18:06:50.810923 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.996 seconds
[0m18:06:50.813646 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: ROLLBACK
[0m18:06:50.815015 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: Close
[0m18:06:50.816518 [error] [Thread-1  ]: 18 of 18 FAIL 8 unique_stg_kaggle__btcusdt_open_time ........................... [[31mFAIL 8[0m in 1.07s]
[0m18:06:50.818954 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:06:50.964325 [debug] [Thread-3  ]: SQL status: SELECT 1 in 1.268 seconds
[0m18:06:50.966852 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: ROLLBACK
[0m18:06:50.968601 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: Close
[0m18:06:50.970018 [error] [Thread-3  ]: 17 of 18 FAIL 8 unique_stg_kaggle__btcusdt_close_time .......................... [[31mFAIL 8[0m in 1.33s]
[0m18:06:50.971518 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:06:50.974534 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:50.975453 [debug] [MainThread]: On master: BEGIN
[0m18:06:50.976271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:50.980952 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:06:50.982027 [debug] [MainThread]: On master: COMMIT
[0m18:06:50.982987 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:50.983939 [debug] [MainThread]: On master: COMMIT
[0m18:06:50.985293 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:06:50.986138 [debug] [MainThread]: On master: Close
[0m18:06:50.987487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:50.988228 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa' was properly closed.
[0m18:06:50.988997 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42' was properly closed.
[0m18:06:50.989853 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb' was properly closed.
[0m18:06:50.990699 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae' was properly closed.
[0m18:06:50.991612 [info ] [MainThread]: 
[0m18:06:50.992573 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m18:06:50.997370 [debug] [MainThread]: Command end result
[0m18:06:50.998312 [info ] [MainThread]: 
[0m18:06:50.999286 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:06:51.000246 [info ] [MainThread]: 
[0m18:06:51.001426 [error] [MainThread]: [31mFailure in test unique_stg_kaggle__btcusdt_open_time (models/staging/kaggle/docs/stg_kaggle__btcusdt.yml)[0m
[0m18:06:51.002453 [error] [MainThread]:   Got 8 results, configured to fail if != 0
[0m18:06:51.003320 [info ] [MainThread]: 
[0m18:06:51.004344 [info ] [MainThread]:   compiled code at target/compiled/dbt_btc_transform/models/staging/kaggle/docs/stg_kaggle__btcusdt.yml/unique_stg_kaggle__btcusdt_open_time.sql
[0m18:06:51.005237 [info ] [MainThread]: 
[0m18:06:51.006377 [error] [MainThread]: [31mFailure in test unique_stg_kaggle__btcusdt_close_time (models/staging/kaggle/docs/stg_kaggle__btcusdt.yml)[0m
[0m18:06:51.007345 [error] [MainThread]:   Got 8 results, configured to fail if != 0
[0m18:06:51.008258 [info ] [MainThread]: 
[0m18:06:51.009294 [info ] [MainThread]:   compiled code at target/compiled/dbt_btc_transform/models/staging/kaggle/docs/stg_kaggle__btcusdt.yml/unique_stg_kaggle__btcusdt_close_time.sql
[0m18:06:51.010157 [info ] [MainThread]: 
[0m18:06:51.011109 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=2 SKIP=0 TOTAL=18
[0m18:06:51.012666 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.550067, "process_user_time": 3.938306, "process_kernel_time": 0.262064, "process_mem_max_rss": "114168", "process_out_blocks": "142", "command_success": false, "process_in_blocks": "0"}
[0m18:06:51.013696 [debug] [MainThread]: Command `dbt test` failed at 18:06:51.013576 after 3.55 seconds
[0m18:06:51.014577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1299df040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1276dad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1262b1ac0>]}
[0m18:06:51.015510 [debug] [MainThread]: Flushing usage events
[0m18:07:51.523301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd502ee0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4df59610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4df595b0>]}


============================== 18:07:51.531879 | f0720294-7b68-4bfb-b6cd-f64424efb2a4 ==============================
[0m18:07:51.531879 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:07:51.533210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models int_hourly_trades', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:07:51.762145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0720294-7b68-4bfb-b6cd-f64424efb2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4fe99430>]}
[0m18:07:51.833261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0720294-7b68-4bfb-b6cd-f64424efb2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4e116100>]}
[0m18:07:51.834713 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:07:51.865364 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:07:52.124924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:07:52.125713 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:07:52.202267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0720294-7b68-4bfb-b6cd-f64424efb2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4cd96130>]}
[0m18:07:52.219616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0720294-7b68-4bfb-b6cd-f64424efb2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4cdbc760>]}
[0m18:07:52.220740 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:07:52.221716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0720294-7b68-4bfb-b6cd-f64424efb2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4d1110d0>]}
[0m18:07:52.224056 [info ] [MainThread]: 
[0m18:07:52.225190 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:07:52.226833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m18:07:52.339084 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m18:07:52.340460 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m18:07:52.341634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:52.348390 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m18:07:52.350830 [debug] [ThreadPool]: On list_company_dw: Close
[0m18:07:52.358922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m18:07:52.369723 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:07:52.370691 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:07:52.371582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:52.376576 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:07:52.377549 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:07:52.378561 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:07:52.382202 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m18:07:52.384256 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:07:52.385373 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:07:52.393083 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:52.393995 [debug] [MainThread]: On master: BEGIN
[0m18:07:52.394850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:52.399965 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:07:52.400944 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:52.402055 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:07:52.409093 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m18:07:52.411045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0720294-7b68-4bfb-b6cd-f64424efb2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4cd82c70>]}
[0m18:07:52.412034 [debug] [MainThread]: On master: ROLLBACK
[0m18:07:52.413178 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:52.414090 [debug] [MainThread]: On master: BEGIN
[0m18:07:52.415556 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:07:52.416339 [debug] [MainThread]: On master: COMMIT
[0m18:07:52.417178 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:52.418057 [debug] [MainThread]: On master: COMMIT
[0m18:07:52.419062 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:07:52.419908 [debug] [MainThread]: On master: Close
[0m18:07:52.421059 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:07:52.421937 [info ] [MainThread]: 
[0m18:07:52.431161 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.int_hourly_trades
[0m18:07:52.432385 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.int_hourly_trades ....................... [RUN]
[0m18:07:52.433683 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.int_hourly_trades)
[0m18:07:52.434627 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.int_hourly_trades
[0m18:07:52.447528 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:07:52.452137 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.int_hourly_trades
[0m18:07:52.507643 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:07:52.513979 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:07:52.515011 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: BEGIN
[0m18:07:52.515928 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:07:52.521010 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m18:07:52.521983 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:07:52.523376 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */

  
    

  create  table "company_dw"."analytics"."int_hourly_trades__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."analytics"."stg_kaggle__btcusdt"

),


final as (

    select distinct
        open_date,

        case
            when hour_start is true
                then extract(minutes from open_time)
        end as open_hour,

        case
            when hour_start is true
                then open
        end as open_price,

        case
            when hour_end is true
                then close
        end as close_price,       

        (close_price - open_price) * 1.0 / open_price as percent_gain

    from source
    where
        hour_start is true or hour_end is true

)

select * from final
  );
  
[0m18:07:52.525982 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "close_price" does not exist
LINE 41:         (close_price - open_price) * 1.0 / open_price as per...
                  ^
HINT:  Perhaps you meant to reference the column "source.close_time".

[0m18:07:52.526937 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: ROLLBACK
[0m18:07:52.528215 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: Close
[0m18:07:52.534147 [debug] [Thread-1  ]: Database Error in model int_hourly_trades (models/marts/intermediate/int_hourly_trades.sql)
  column "close_price" does not exist
  LINE 41:         (close_price - open_price) * 1.0 / open_price as per...
                    ^
  HINT:  Perhaps you meant to reference the column "source.close_time".
  compiled code at target/run/dbt_btc_transform/models/marts/intermediate/int_hourly_trades.sql
[0m18:07:52.536672 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0720294-7b68-4bfb-b6cd-f64424efb2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4e1605b0>]}
[0m18:07:52.537869 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model analytics.int_hourly_trades .............. [[31mERROR[0m in 0.10s]
[0m18:07:52.539104 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.int_hourly_trades
[0m18:07:52.542342 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:52.543184 [debug] [MainThread]: On master: BEGIN
[0m18:07:52.544011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:52.549640 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:07:52.550558 [debug] [MainThread]: On master: COMMIT
[0m18:07:52.551581 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:52.552320 [debug] [MainThread]: On master: COMMIT
[0m18:07:52.553502 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:07:52.554305 [debug] [MainThread]: On master: Close
[0m18:07:52.555629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:52.556498 [debug] [MainThread]: Connection 'model.dbt_btc_transform.int_hourly_trades' was properly closed.
[0m18:07:52.557607 [info ] [MainThread]: 
[0m18:07:52.558540 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m18:07:52.559874 [debug] [MainThread]: Command end result
[0m18:07:52.560682 [info ] [MainThread]: 
[0m18:07:52.561615 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:07:52.562472 [info ] [MainThread]: 
[0m18:07:52.563665 [error] [MainThread]:   Database Error in model int_hourly_trades (models/marts/intermediate/int_hourly_trades.sql)
  column "close_price" does not exist
  LINE 41:         (close_price - open_price) * 1.0 / open_price as per...
                    ^
  HINT:  Perhaps you meant to reference the column "source.close_time".
  compiled code at target/run/dbt_btc_transform/models/marts/intermediate/int_hourly_trades.sql
[0m18:07:52.564582 [info ] [MainThread]: 
[0m18:07:52.565424 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:07:52.566881 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1126593, "process_user_time": 3.245931, "process_kernel_time": 0.213871, "process_mem_max_rss": "109516", "process_out_blocks": "36", "command_success": false, "process_in_blocks": "0"}
[0m18:07:52.567947 [debug] [MainThread]: Command `dbt run` failed at 18:07:52.567833 after 1.11 seconds
[0m18:07:52.569114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd502ee0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4e116100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4d111430>]}
[0m18:07:52.570260 [debug] [MainThread]: Flushing usage events
[0m18:10:02.179644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6361821100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f635f4ab6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f635f4ab640>]}


============================== 18:10:02.188188 | b5e89591-969b-4a84-b3fd-0858e6f1c88f ==============================
[0m18:10:02.188188 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:10:02.189391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:10:02.432117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5e89591-969b-4a84-b3fd-0858e6f1c88f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f635f4ce3d0>]}
[0m18:10:02.502784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5e89591-969b-4a84-b3fd-0858e6f1c88f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6361db9df0>]}
[0m18:10:02.504259 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:10:02.532605 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:10:02.696312 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:10:02.697426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5e89591-969b-4a84-b3fd-0858e6f1c88f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63607cb2b0>]}
[0m18:10:04.714435 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:10:04.715920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5e89591-969b-4a84-b3fd-0858e6f1c88f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f635edfedc0>]}
[0m18:10:05.106124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5e89591-969b-4a84-b3fd-0858e6f1c88f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f635e993f40>]}
[0m18:10:05.120688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5e89591-969b-4a84-b3fd-0858e6f1c88f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f635ece1400>]}
[0m18:10:05.121700 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:10:05.122882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5e89591-969b-4a84-b3fd-0858e6f1c88f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f635e9bcc40>]}
[0m18:10:05.124901 [info ] [MainThread]: 
[0m18:10:05.126151 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:10:05.127758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m18:10:05.179090 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m18:10:05.180200 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m18:10:05.181115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:05.189362 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m18:10:05.191474 [debug] [ThreadPool]: On list_company_dw: Close
[0m18:10:05.198443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m18:10:05.207440 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:10:05.208304 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:10:05.209134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:05.214329 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:10:05.215292 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:10:05.216198 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:10:05.219837 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m18:10:05.221813 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:10:05.222961 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:10:05.230664 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:05.231728 [debug] [MainThread]: On master: BEGIN
[0m18:10:05.232639 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:05.237496 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:10:05.238437 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:05.239517 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:10:05.246917 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m18:10:05.248940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5e89591-969b-4a84-b3fd-0858e6f1c88f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63613b2dc0>]}
[0m18:10:05.249972 [debug] [MainThread]: On master: ROLLBACK
[0m18:10:05.251089 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:05.251928 [debug] [MainThread]: On master: BEGIN
[0m18:10:05.253270 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:10:05.254094 [debug] [MainThread]: On master: COMMIT
[0m18:10:05.254976 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:05.255825 [debug] [MainThread]: On master: COMMIT
[0m18:10:05.256874 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:05.257789 [debug] [MainThread]: On master: Close
[0m18:10:05.258949 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:10:05.259854 [info ] [MainThread]: 
[0m18:10:05.269026 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:10:05.270243 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m18:10:05.271302 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m18:10:05.272211 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:10:05.286133 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:10:05.289559 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:10:05.343359 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:10:05.345989 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:10:05.346884 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m18:10:05.347852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:10:05.352562 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m18:10:05.353650 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:10:05.354793 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    select
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote_asset_volume,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        open_time::date as open_date,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minutes from open_time) = 0
            and extract(second from open_time) = 0
                then true
            else false
        end as hour_start,

        case    
            when extract(minute from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as hour_end
            

    from source

)

select * from final
  );
  
[0m18:10:07.671777 [debug] [Thread-1  ]: SQL status: SELECT 999999 in 2.316 seconds
[0m18:10:07.680846 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:10:07.681894 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt" rename to "stg_kaggle__btcusdt__dbt_backup"
[0m18:10:07.683335 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:10:07.687989 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:10:07.688945 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp" rename to "stg_kaggle__btcusdt"
[0m18:10:07.690193 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:10:07.718342 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m18:10:07.719352 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:10:07.720262 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m18:10:07.728454 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m18:10:07.738864 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup"
[0m18:10:07.745098 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:10:07.746071 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
drop table if exists "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup" cascade
[0m18:10:07.766409 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.019 seconds
[0m18:10:07.769921 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m18:10:07.772347 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e89591-969b-4a84-b3fd-0858e6f1c88f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f635d9cf9d0>]}
[0m18:10:07.773607 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.stg_kaggle__btcusdt ................ [[32mSELECT 999999[0m in 2.50s]
[0m18:10:07.774976 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:10:07.777749 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:07.778660 [debug] [MainThread]: On master: BEGIN
[0m18:10:07.779523 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:07.784135 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:10:07.785097 [debug] [MainThread]: On master: COMMIT
[0m18:10:07.785932 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:07.786719 [debug] [MainThread]: On master: COMMIT
[0m18:10:07.787753 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:07.788589 [debug] [MainThread]: On master: Close
[0m18:10:07.789608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:07.790472 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m18:10:07.791384 [info ] [MainThread]: 
[0m18:10:07.792309 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m18:10:07.793673 [debug] [MainThread]: Command end result
[0m18:10:07.794528 [info ] [MainThread]: 
[0m18:10:07.795592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:07.796494 [info ] [MainThread]: 
[0m18:10:07.797447 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:10:07.798914 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6878977, "process_user_time": 5.117321, "process_kernel_time": 0.173673, "process_mem_max_rss": "114812", "process_out_blocks": "1187", "process_in_blocks": "0"}
[0m18:10:07.799995 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:07.799825 after 5.69 seconds
[0m18:10:07.800849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6361821100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6361db9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f635eccffd0>]}
[0m18:10:07.801967 [debug] [MainThread]: Flushing usage events
[0m18:10:12.445271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3920c48070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391e8ab610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391e8ab5b0>]}


============================== 18:10:12.453772 | 609d8ed7-d6aa-469e-aec0-209886094b93 ==============================
[0m18:10:12.453772 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:10:12.455057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models stg_kaggle__btcusdt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:10:12.676987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '609d8ed7-d6aa-469e-aec0-209886094b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391e5fc490>]}
[0m18:10:12.746539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '609d8ed7-d6aa-469e-aec0-209886094b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391f557a90>]}
[0m18:10:12.748015 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:10:12.777474 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:10:13.025520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:13.026366 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:13.098265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '609d8ed7-d6aa-469e-aec0-209886094b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391d916130>]}
[0m18:10:13.122954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '609d8ed7-d6aa-469e-aec0-209886094b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391dd992e0>]}
[0m18:10:13.124018 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:10:13.124952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '609d8ed7-d6aa-469e-aec0-209886094b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391dd8d1c0>]}
[0m18:10:13.128087 [info ] [MainThread]: 
[0m18:10:13.129175 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:10:13.136269 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analytics'
[0m18:10:13.248207 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:10:13.249191 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:10:13.250083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:13.255233 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:10:13.256158 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:10:13.257041 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:10:13.260437 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:10:13.262296 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:10:13.263452 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:10:13.271070 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:13.271911 [debug] [MainThread]: On master: BEGIN
[0m18:10:13.272703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:13.277596 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:10:13.278701 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:13.279805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:10:13.286566 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m18:10:13.288453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '609d8ed7-d6aa-469e-aec0-209886094b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391d534ee0>]}
[0m18:10:13.289417 [debug] [MainThread]: On master: ROLLBACK
[0m18:10:13.290490 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:13.291533 [debug] [MainThread]: On master: BEGIN
[0m18:10:13.292957 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:10:13.293830 [debug] [MainThread]: On master: COMMIT
[0m18:10:13.294603 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:13.295443 [debug] [MainThread]: On master: COMMIT
[0m18:10:13.296568 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:13.297749 [debug] [MainThread]: On master: Close
[0m18:10:13.298853 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:10:13.299856 [info ] [MainThread]: 
[0m18:10:13.309182 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:10:13.310034 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:10:13.310718 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:10:13.311620 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:10:13.312467 [info ] [Thread-1  ]: 1 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_end__True__False ... [RUN]
[0m18:10:13.313622 [info ] [Thread-2  ]: 2 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_start__True__False . [RUN]
[0m18:10:13.314898 [info ] [Thread-3  ]: 3 of 18 START test not_null_stg_kaggle__btcusdt_close .......................... [RUN]
[0m18:10:13.316003 [info ] [Thread-4  ]: 4 of 18 START test not_null_stg_kaggle__btcusdt_close_time ..................... [RUN]
[0m18:10:13.317143 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872)
[0m18:10:13.318296 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m18:10:13.319481 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb'
[0m18:10:13.320787 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a'
[0m18:10:13.321881 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:10:13.322899 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:10:13.323838 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:10:13.324964 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:10:13.354784 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:10:13.355668 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:10:13.367187 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:10:13.372809 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:10:13.375743 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:10:13.376614 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:10:13.383367 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:10:13.407601 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:10:13.419501 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:10:13.420213 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:10:13.424528 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:10:13.431566 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:10:13.432636 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:10:13.433905 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:10:13.435414 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:10:13.436310 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: BEGIN
[0m18:10:13.437678 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: BEGIN
[0m18:10:13.439058 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:10:13.440466 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: BEGIN
[0m18:10:13.441545 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:10:13.442594 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:10:13.443670 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: BEGIN
[0m18:10:13.444694 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:10:13.448213 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:10:13.452200 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m18:10:13.453164 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m18:10:13.454187 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:10:13.455569 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:10:13.456469 [debug] [Thread-3  ]: SQL status: BEGIN in 0.012 seconds
[0m18:10:13.457136 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m18:10:13.458039 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_start as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_start

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m18:10:13.459125 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_end as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_end

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m18:10:13.460417 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:10:13.461410 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:10:13.463999 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close is null



      
    ) dbt_internal_test
[0m18:10:13.465717 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is null



      
    ) dbt_internal_test
[0m18:10:13.595861 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.125 seconds
[0m18:10:13.596753 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.134 seconds
[0m18:10:13.597550 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.135 seconds
[0m18:10:13.598295 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.127 seconds
[0m18:10:13.604022 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: ROLLBACK
[0m18:10:13.606239 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: ROLLBACK
[0m18:10:13.608335 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: ROLLBACK
[0m18:10:13.610615 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: ROLLBACK
[0m18:10:13.612094 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: Close
[0m18:10:13.613189 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: Close
[0m18:10:13.614114 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: Close
[0m18:10:13.615087 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: Close
[0m18:10:13.616216 [info ] [Thread-3  ]: 3 of 18 PASS not_null_stg_kaggle__btcusdt_close ................................ [[32mPASS[0m in 0.30s]
[0m18:10:13.617833 [info ] [Thread-2  ]: 2 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_start__True__False ....... [[32mPASS[0m in 0.30s]
[0m18:10:13.619310 [info ] [Thread-1  ]: 1 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_end__True__False ......... [[32mPASS[0m in 0.30s]
[0m18:10:13.620696 [info ] [Thread-4  ]: 4 of 18 PASS not_null_stg_kaggle__btcusdt_close_time ........................... [[32mPASS[0m in 0.30s]
[0m18:10:13.622039 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:10:13.623295 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:10:13.624489 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:10:13.625724 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:10:13.626902 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:10:13.628022 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:10:13.629182 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:10:13.630222 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:10:13.631230 [info ] [Thread-3  ]: 5 of 18 START test not_null_stg_kaggle__btcusdt_high ........................... [RUN]
[0m18:10:13.632417 [info ] [Thread-2  ]: 6 of 18 START test not_null_stg_kaggle__btcusdt_hour_end ....................... [RUN]
[0m18:10:13.633938 [info ] [Thread-1  ]: 7 of 18 START test not_null_stg_kaggle__btcusdt_hour_start ..................... [RUN]
[0m18:10:13.634964 [info ] [Thread-4  ]: 8 of 18 START test not_null_stg_kaggle__btcusdt_low ............................ [RUN]
[0m18:10:13.636088 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m18:10:13.637148 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m18:10:13.638203 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m18:10:13.639142 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m18:10:13.640146 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:10:13.641266 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:10:13.642260 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:10:13.643100 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:10:13.648935 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:10:13.654492 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:10:13.660048 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:10:13.665571 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:10:13.668183 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:10:13.670321 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:10:13.675369 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:10:13.676420 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:10:13.681239 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:10:13.681966 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:10:13.686472 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:10:13.688176 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:10:13.691813 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:10:13.693259 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:10:13.694725 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: BEGIN
[0m18:10:13.696501 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:10:13.698068 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: BEGIN
[0m18:10:13.699156 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:10:13.699814 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:10:13.700965 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: BEGIN
[0m18:10:13.701999 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:10:13.703866 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: BEGIN
[0m18:10:13.704989 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:10:13.706801 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:10:13.707916 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m18:10:13.710708 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:10:13.711563 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m18:10:13.712661 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where high is null



      
    ) dbt_internal_test
[0m18:10:13.714038 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:10:13.715009 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m18:10:13.715737 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m18:10:13.717322 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_end
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_end is null



      
    ) dbt_internal_test
[0m18:10:13.718709 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:10:13.720070 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:10:13.721992 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_start
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_start is null



      
    ) dbt_internal_test
[0m18:10:13.723573 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where low is null



      
    ) dbt_internal_test
[0m18:10:13.780546 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.064 seconds
[0m18:10:13.786199 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: ROLLBACK
[0m18:10:13.788012 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: Close
[0m18:10:13.789875 [info ] [Thread-3  ]: 5 of 18 PASS not_null_stg_kaggle__btcusdt_high ................................. [[32mPASS[0m in 0.15s]
[0m18:10:13.792299 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:10:13.793733 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:10:13.795233 [info ] [Thread-3  ]: 9 of 18 START test not_null_stg_kaggle__btcusdt_number_of_trades ............... [RUN]
[0m18:10:13.796714 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m18:10:13.798365 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:10:13.808892 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:10:13.809939 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.089 seconds
[0m18:10:13.813943 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: ROLLBACK
[0m18:10:13.814916 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.090 seconds
[0m18:10:13.815628 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.090 seconds
[0m18:10:13.816660 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:10:13.817501 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: Close
[0m18:10:13.819638 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: ROLLBACK
[0m18:10:13.821838 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: ROLLBACK
[0m18:10:13.827097 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:10:13.829039 [info ] [Thread-2  ]: 6 of 18 PASS not_null_stg_kaggle__btcusdt_hour_end ............................. [[32mPASS[0m in 0.19s]
[0m18:10:13.831196 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: Close
[0m18:10:13.832790 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: Close
[0m18:10:13.834785 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:10:13.836901 [info ] [Thread-1  ]: 7 of 18 PASS not_null_stg_kaggle__btcusdt_hour_start ........................... [[32mPASS[0m in 0.20s]
[0m18:10:13.838135 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:10:13.839616 [info ] [Thread-4  ]: 8 of 18 PASS not_null_stg_kaggle__btcusdt_low .................................. [[32mPASS[0m in 0.20s]
[0m18:10:13.841297 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:10:13.843061 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:10:13.844203 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: BEGIN
[0m18:10:13.845593 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:10:13.846897 [info ] [Thread-2  ]: 10 of 18 START test not_null_stg_kaggle__btcusdt_open .......................... [RUN]
[0m18:10:13.848400 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:10:13.849565 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:10:13.850812 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:10:13.852102 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m18:10:13.853262 [info ] [Thread-1  ]: 11 of 18 START test not_null_stg_kaggle__btcusdt_open_date ..................... [RUN]
[0m18:10:13.855145 [info ] [Thread-4  ]: 12 of 18 START test not_null_stg_kaggle__btcusdt_open_time ..................... [RUN]
[0m18:10:13.856398 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:10:13.857577 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m18:10:13.859016 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m18:10:13.859886 [debug] [Thread-3  ]: SQL status: BEGIN in 0.010 seconds
[0m18:10:13.867195 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:10:13.868205 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:10:13.869210 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:10:13.870248 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:10:13.876789 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:10:13.883318 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:10:13.884120 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:10:13.885135 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select number_of_trades
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where number_of_trades is null



      
    ) dbt_internal_test
[0m18:10:13.890657 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:10:13.891472 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:10:13.892618 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:10:13.897622 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:10:13.918595 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:10:13.922150 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:10:13.924316 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: BEGIN
[0m18:10:13.926780 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:10:13.928053 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:10:13.930560 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:10:13.932236 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: BEGIN
[0m18:10:13.933797 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: BEGIN
[0m18:10:13.935736 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:10:13.937412 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m18:10:13.938837 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:10:13.941248 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:10:13.943815 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open is null



      
    ) dbt_internal_test
[0m18:10:13.946062 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m18:10:13.947446 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:10:13.949164 [debug] [Thread-4  ]: SQL status: BEGIN in 0.010 seconds
[0m18:10:13.952837 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_date
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_date is null



      
    ) dbt_internal_test
[0m18:10:13.954654 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:10:13.956709 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is null



      
    ) dbt_internal_test
[0m18:10:13.966800 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.074 seconds
[0m18:10:13.970521 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: ROLLBACK
[0m18:10:13.972552 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: Close
[0m18:10:13.974767 [info ] [Thread-3  ]: 9 of 18 PASS not_null_stg_kaggle__btcusdt_number_of_trades ..................... [[32mPASS[0m in 0.18s]
[0m18:10:13.976892 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:10:13.979100 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:10:13.980514 [info ] [Thread-3  ]: 13 of 18 START test not_null_stg_kaggle__btcusdt_quote_asset_volume ............ [RUN]
[0m18:10:13.982196 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m18:10:13.983440 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:10:13.994770 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:10:13.998434 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:10:13.999998 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.054 seconds
[0m18:10:14.004587 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:10:14.007893 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: ROLLBACK
[0m18:10:14.011164 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: Close
[0m18:10:14.012792 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:10:14.014269 [info ] [Thread-2  ]: 10 of 18 PASS not_null_stg_kaggle__btcusdt_open ................................ [[32mPASS[0m in 0.16s]
[0m18:10:14.016004 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: BEGIN
[0m18:10:14.019009 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:10:14.021138 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:10:14.023647 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:10:14.026752 [info ] [Thread-2  ]: 14 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ... [RUN]
[0m18:10:14.029282 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m18:10:14.031229 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.075 seconds
[0m18:10:14.032158 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:10:14.033292 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.075 seconds
[0m18:10:14.036644 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: ROLLBACK
[0m18:10:14.037715 [debug] [Thread-3  ]: SQL status: BEGIN in 0.017 seconds
[0m18:10:14.044440 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:10:14.046992 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: ROLLBACK
[0m18:10:14.048483 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: Close
[0m18:10:14.049279 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:10:14.051189 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: Close
[0m18:10:14.052367 [info ] [Thread-1  ]: 11 of 18 PASS not_null_stg_kaggle__btcusdt_open_date ........................... [[32mPASS[0m in 0.19s]
[0m18:10:14.053587 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where quote_asset_volume is null



      
    ) dbt_internal_test
[0m18:10:14.054531 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:10:14.056202 [info ] [Thread-4  ]: 12 of 18 PASS not_null_stg_kaggle__btcusdt_open_time ........................... [[32mPASS[0m in 0.20s]
[0m18:10:14.057810 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:10:14.063900 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:10:14.065525 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:10:14.066985 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:10:14.069471 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:10:14.071140 [info ] [Thread-1  ]: 15 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume .. [RUN]
[0m18:10:14.072549 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:10:14.073714 [info ] [Thread-4  ]: 16 of 18 START test not_null_stg_kaggle__btcusdt_volume ........................ [RUN]
[0m18:10:14.075255 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m18:10:14.076454 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: BEGIN
[0m18:10:14.077672 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m18:10:14.078986 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:10:14.080701 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:10:14.082099 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:10:14.089179 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:10:14.097722 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:10:14.098743 [debug] [Thread-2  ]: SQL status: BEGIN in 0.018 seconds
[0m18:10:14.100929 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:10:14.102105 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:10:14.103517 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_base_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_base_asset_volume is null



      
    ) dbt_internal_test
[0m18:10:14.104563 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:10:14.105493 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.046 seconds
[0m18:10:14.110732 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:10:14.116718 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:10:14.119551 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: ROLLBACK
[0m18:10:14.122279 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:10:14.123145 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: Close
[0m18:10:14.124130 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: BEGIN
[0m18:10:14.124921 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:10:14.126468 [info ] [Thread-3  ]: 13 of 18 PASS not_null_stg_kaggle__btcusdt_quote_asset_volume .................. [[32mPASS[0m in 0.14s]
[0m18:10:14.127718 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:10:14.129021 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: BEGIN
[0m18:10:14.130427 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:10:14.132431 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:10:14.134428 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:10:14.136766 [info ] [Thread-3  ]: 17 of 18 START test unique_stg_kaggle__btcusdt_close_time ...................... [RUN]
[0m18:10:14.138079 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m18:10:14.139187 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m18:10:14.140477 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:10:14.141501 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m18:10:14.142522 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:10:14.143916 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_quote_asset_volume is null



      
    ) dbt_internal_test
[0m18:10:14.145074 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:10:14.154937 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:10:14.156661 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where volume is null



      
    ) dbt_internal_test
[0m18:10:14.159757 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.048 seconds
[0m18:10:14.161110 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:10:14.163494 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: ROLLBACK
[0m18:10:14.168291 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:10:14.170640 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: Close
[0m18:10:14.173721 [info ] [Thread-2  ]: 14 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ......... [[32mPASS[0m in 0.14s]
[0m18:10:14.176115 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:10:14.177509 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:10:14.179418 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:10:14.181244 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: BEGIN
[0m18:10:14.182694 [info ] [Thread-2  ]: 18 of 18 START test unique_stg_kaggle__btcusdt_open_time ....................... [RUN]
[0m18:10:14.185122 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:10:14.187594 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m18:10:14.190326 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:10:14.199825 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:10:14.201346 [debug] [Thread-3  ]: SQL status: BEGIN in 0.017 seconds
[0m18:10:14.203908 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:10:14.205660 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    close_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is not null
group by close_time
having count(*) > 1



      
    ) dbt_internal_test
[0m18:10:14.206597 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:10:14.214953 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:10:14.219457 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:10:14.221642 [debug] [Thread-2  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: BEGIN
[0m18:10:14.223818 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:10:14.225454 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.066 seconds
[0m18:10:14.231696 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: ROLLBACK
[0m18:10:14.233384 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.077 seconds
[0m18:10:14.235588 [debug] [Thread-2  ]: SQL status: BEGIN in 0.012 seconds
[0m18:10:14.236606 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: Close
[0m18:10:14.239333 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: ROLLBACK
[0m18:10:14.240625 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:10:14.242391 [info ] [Thread-4  ]: 16 of 18 PASS not_null_stg_kaggle__btcusdt_volume .............................. [[32mPASS[0m in 0.16s]
[0m18:10:14.244197 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: Close
[0m18:10:14.245082 [debug] [Thread-2  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    open_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is not null
group by open_time
having count(*) > 1



      
    ) dbt_internal_test
[0m18:10:14.246661 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:10:14.248907 [info ] [Thread-1  ]: 15 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume ........ [[32mPASS[0m in 0.17s]
[0m18:10:14.252405 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:10:15.126119 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.918 seconds
[0m18:10:15.128870 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: ROLLBACK
[0m18:10:15.130391 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: Close
[0m18:10:15.132369 [error] [Thread-3  ]: 17 of 18 FAIL 8 unique_stg_kaggle__btcusdt_close_time .......................... [[31mFAIL 8[0m in 0.99s]
[0m18:10:15.134539 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:10:15.145558 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.895 seconds
[0m18:10:15.148725 [debug] [Thread-2  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: ROLLBACK
[0m18:10:15.150487 [debug] [Thread-2  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: Close
[0m18:10:15.152191 [error] [Thread-2  ]: 18 of 18 FAIL 8 unique_stg_kaggle__btcusdt_open_time ........................... [[31mFAIL 8[0m in 0.96s]
[0m18:10:15.153838 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:10:15.158024 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:15.159151 [debug] [MainThread]: On master: BEGIN
[0m18:10:15.160174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:15.165465 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:10:15.166987 [debug] [MainThread]: On master: COMMIT
[0m18:10:15.168562 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:15.170143 [debug] [MainThread]: On master: COMMIT
[0m18:10:15.171873 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:15.173556 [debug] [MainThread]: On master: Close
[0m18:10:15.175292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:15.176502 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42' was properly closed.
[0m18:10:15.177667 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa' was properly closed.
[0m18:10:15.178888 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb' was properly closed.
[0m18:10:15.180023 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae' was properly closed.
[0m18:10:15.181308 [info ] [MainThread]: 
[0m18:10:15.182466 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m18:10:15.187882 [debug] [MainThread]: Command end result
[0m18:10:15.188935 [info ] [MainThread]: 
[0m18:10:15.189940 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:10:15.190959 [info ] [MainThread]: 
[0m18:10:15.192113 [error] [MainThread]: [31mFailure in test unique_stg_kaggle__btcusdt_close_time (models/staging/kaggle/docs/stg_kaggle__btcusdt.yml)[0m
[0m18:10:15.193187 [error] [MainThread]:   Got 8 results, configured to fail if != 0
[0m18:10:15.194085 [info ] [MainThread]: 
[0m18:10:15.195148 [info ] [MainThread]:   compiled code at target/compiled/dbt_btc_transform/models/staging/kaggle/docs/stg_kaggle__btcusdt.yml/unique_stg_kaggle__btcusdt_close_time.sql
[0m18:10:15.196167 [info ] [MainThread]: 
[0m18:10:15.197231 [error] [MainThread]: [31mFailure in test unique_stg_kaggle__btcusdt_open_time (models/staging/kaggle/docs/stg_kaggle__btcusdt.yml)[0m
[0m18:10:15.198320 [error] [MainThread]:   Got 8 results, configured to fail if != 0
[0m18:10:15.199272 [info ] [MainThread]: 
[0m18:10:15.200294 [info ] [MainThread]:   compiled code at target/compiled/dbt_btc_transform/models/staging/kaggle/docs/stg_kaggle__btcusdt.yml/unique_stg_kaggle__btcusdt_open_time.sql
[0m18:10:15.201242 [info ] [MainThread]: 
[0m18:10:15.202188 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=2 SKIP=0 TOTAL=18
[0m18:10:15.203707 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.8352396, "process_user_time": 3.406981, "process_kernel_time": 0.242905, "process_mem_max_rss": "114712", "process_out_blocks": "143", "command_success": false, "process_in_blocks": "0"}
[0m18:10:15.204922 [debug] [MainThread]: Command `dbt test` failed at 18:10:15.204743 after 2.84 seconds
[0m18:10:15.205948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3920c48070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391e5d76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391dd8d3d0>]}
[0m18:10:15.206950 [debug] [MainThread]: Flushing usage events
[0m18:10:20.251942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758f561040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758d1d9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758d1d9520>]}


============================== 18:10:20.260029 | a386383c-9d98-45e9-bb7b-aa294e6e0200 ==============================
[0m18:10:20.260029 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:10:20.261266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models int_hourly_trades', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:10:20.483998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a386383c-9d98-45e9-bb7b-aa294e6e0200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758d1ff580>]}
[0m18:10:20.555491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a386383c-9d98-45e9-bb7b-aa294e6e0200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758deccc40>]}
[0m18:10:20.556970 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:10:20.586170 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:10:20.832603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:20.833473 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:20.904564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a386383c-9d98-45e9-bb7b-aa294e6e0200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c256130>]}
[0m18:10:20.918246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a386383c-9d98-45e9-bb7b-aa294e6e0200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c27c040>]}
[0m18:10:20.919263 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:10:20.920159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a386383c-9d98-45e9-bb7b-aa294e6e0200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c391040>]}
[0m18:10:20.922352 [info ] [MainThread]: 
[0m18:10:20.923493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:10:20.925112 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m18:10:21.029065 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m18:10:21.030232 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m18:10:21.031245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:21.037649 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m18:10:21.040070 [debug] [ThreadPool]: On list_company_dw: Close
[0m18:10:21.047474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m18:10:21.057457 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:10:21.058367 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:10:21.059187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:21.063976 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:10:21.064882 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:10:21.065774 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:10:21.069177 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:10:21.071127 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:10:21.072170 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:10:21.079714 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:21.080950 [debug] [MainThread]: On master: BEGIN
[0m18:10:21.081897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:21.088109 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:10:21.089670 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:21.090782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:10:21.098494 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:10:21.100689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a386383c-9d98-45e9-bb7b-aa294e6e0200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c27ca30>]}
[0m18:10:21.101894 [debug] [MainThread]: On master: ROLLBACK
[0m18:10:21.103347 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:21.104290 [debug] [MainThread]: On master: BEGIN
[0m18:10:21.105922 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:10:21.106982 [debug] [MainThread]: On master: COMMIT
[0m18:10:21.107888 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:21.108755 [debug] [MainThread]: On master: COMMIT
[0m18:10:21.110067 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:21.111114 [debug] [MainThread]: On master: Close
[0m18:10:21.112375 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:10:21.113473 [info ] [MainThread]: 
[0m18:10:21.123538 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.int_hourly_trades
[0m18:10:21.125249 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.int_hourly_trades ....................... [RUN]
[0m18:10:21.126523 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.int_hourly_trades)
[0m18:10:21.127707 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.int_hourly_trades
[0m18:10:21.142319 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:10:21.145211 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.int_hourly_trades
[0m18:10:21.205208 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:10:21.207768 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:10:21.208737 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: BEGIN
[0m18:10:21.209673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:10:21.214458 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m18:10:21.215580 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:10:21.216950 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */

  
    

  create  table "company_dw"."analytics"."int_hourly_trades__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."analytics"."stg_kaggle__btcusdt"

),


hourly as (

    select distinct
        open_date,

        case
            when hour_start is true
                then extract(minutes from open_time)
        end as open_hour,

        case
            when hour_start is true
                then open
        end as open_price,

        case
            when hour_end is true
                then close
        end as close_price

    from source
    where
        hour_start is true or hour_end is true

)


final as (

    select
        open_date,
        open_hour,
        open_price,
        close_price,       
        (close_price - open_price) * 1.0 / open_price as percent_gain

    from hourly

)

select * from final
  );
  
[0m18:10:21.219296 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "final"
LINE 48: final as (
         ^

[0m18:10:21.220269 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: ROLLBACK
[0m18:10:21.221564 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: Close
[0m18:10:21.224798 [debug] [Thread-1  ]: Database Error in model int_hourly_trades (models/marts/intermediate/int_hourly_trades.sql)
  syntax error at or near "final"
  LINE 48: final as (
           ^
  compiled code at target/run/dbt_btc_transform/models/marts/intermediate/int_hourly_trades.sql
[0m18:10:21.227316 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a386383c-9d98-45e9-bb7b-aa294e6e0200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c241130>]}
[0m18:10:21.228561 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model analytics.int_hourly_trades .............. [[31mERROR[0m in 0.10s]
[0m18:10:21.229943 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.int_hourly_trades
[0m18:10:21.232967 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:21.233889 [debug] [MainThread]: On master: BEGIN
[0m18:10:21.234723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:21.239983 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:10:21.241093 [debug] [MainThread]: On master: COMMIT
[0m18:10:21.241905 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:21.242717 [debug] [MainThread]: On master: COMMIT
[0m18:10:21.243768 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:21.244621 [debug] [MainThread]: On master: Close
[0m18:10:21.245694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:21.246551 [debug] [MainThread]: Connection 'model.dbt_btc_transform.int_hourly_trades' was properly closed.
[0m18:10:21.247435 [info ] [MainThread]: 
[0m18:10:21.248506 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m18:10:21.250055 [debug] [MainThread]: Command end result
[0m18:10:21.250864 [info ] [MainThread]: 
[0m18:10:21.251815 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:10:21.252736 [info ] [MainThread]: 
[0m18:10:21.253775 [error] [MainThread]:   Database Error in model int_hourly_trades (models/marts/intermediate/int_hourly_trades.sql)
  syntax error at or near "final"
  LINE 48: final as (
           ^
  compiled code at target/run/dbt_btc_transform/models/marts/intermediate/int_hourly_trades.sql
[0m18:10:21.254681 [info ] [MainThread]: 
[0m18:10:21.255591 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:10:21.257130 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0973876, "process_user_time": 2.913526, "process_kernel_time": 0.159659, "process_mem_max_rss": "109564", "process_out_blocks": "35", "command_success": false, "process_in_blocks": "0"}
[0m18:10:21.258124 [debug] [MainThread]: Command `dbt run` failed at 18:10:21.258004 after 1.10 seconds
[0m18:10:21.258965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758f561040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c3913d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758c391400>]}
[0m18:10:21.259737 [debug] [MainThread]: Flushing usage events
[0m18:11:54.558609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe582c59100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5808eb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5808eb640>]}


============================== 18:11:54.565877 | f421a563-f783-422d-9b5d-1e6ba1b79a05 ==============================
[0m18:11:54.565877 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:11:54.567004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models stg_kaggle__btcusdt', 'send_anonymous_usage_stats': 'True'}
[0m18:11:54.784970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f421a563-f783-422d-9b5d-1e6ba1b79a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5809113d0>]}
[0m18:11:54.852738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f421a563-f783-422d-9b5d-1e6ba1b79a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5831eadf0>]}
[0m18:11:54.854032 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:11:54.887411 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:11:55.052956 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:11:55.054113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f421a563-f783-422d-9b5d-1e6ba1b79a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe581bf82b0>]}
[0m18:11:57.059890 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:11:57.061193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f421a563-f783-422d-9b5d-1e6ba1b79a05', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57f7d0580>]}
[0m18:11:57.461947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f421a563-f783-422d-9b5d-1e6ba1b79a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57f7de4c0>]}
[0m18:11:57.487193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f421a563-f783-422d-9b5d-1e6ba1b79a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57ffcef70>]}
[0m18:11:57.488229 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:11:57.489155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f421a563-f783-422d-9b5d-1e6ba1b79a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57f7de100>]}
[0m18:11:57.492233 [info ] [MainThread]: 
[0m18:11:57.493348 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:11:57.500300 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analytics'
[0m18:11:57.543579 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:11:57.544532 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:11:57.545369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:57.550915 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:11:57.551836 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:11:57.552867 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:11:57.556134 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:11:57.558021 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:11:57.559181 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:11:57.566644 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:57.567616 [debug] [MainThread]: On master: BEGIN
[0m18:11:57.568485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:11:57.573955 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:11:57.574880 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:57.575960 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:11:57.582948 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m18:11:57.584754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f421a563-f783-422d-9b5d-1e6ba1b79a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe580afbb80>]}
[0m18:11:57.585730 [debug] [MainThread]: On master: ROLLBACK
[0m18:11:57.586885 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:57.587769 [debug] [MainThread]: On master: BEGIN
[0m18:11:57.589156 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:11:57.590026 [debug] [MainThread]: On master: COMMIT
[0m18:11:57.590789 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:57.591598 [debug] [MainThread]: On master: COMMIT
[0m18:11:57.592723 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:11:57.593494 [debug] [MainThread]: On master: Close
[0m18:11:57.594598 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:11:57.595595 [info ] [MainThread]: 
[0m18:11:57.604655 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:11:57.605557 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:11:57.606366 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:11:57.607357 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:11:57.608124 [info ] [Thread-1  ]: 1 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_end__True__False ... [RUN]
[0m18:11:57.609219 [info ] [Thread-2  ]: 2 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_start__True__False . [RUN]
[0m18:11:57.610359 [info ] [Thread-3  ]: 3 of 18 START test not_null_stg_kaggle__btcusdt_close .......................... [RUN]
[0m18:11:57.611562 [info ] [Thread-4  ]: 4 of 18 START test not_null_stg_kaggle__btcusdt_close_time ..................... [RUN]
[0m18:11:57.612840 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872)
[0m18:11:57.614139 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m18:11:57.615222 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb'
[0m18:11:57.616634 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a'
[0m18:11:57.617752 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:11:57.618793 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:11:57.619842 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:11:57.620895 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:11:57.635923 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:11:57.643271 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:11:57.671550 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:11:57.673556 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:11:57.676991 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:11:57.677710 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:11:57.691253 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:11:57.708614 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:11:57.721089 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:11:57.720364 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:11:57.725001 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:11:57.729867 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:11:57.731241 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:11:57.733125 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:11:57.734285 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: BEGIN
[0m18:11:57.735006 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:11:57.736084 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:11:57.736862 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: BEGIN
[0m18:11:57.737864 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:57.738842 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: BEGIN
[0m18:11:57.739852 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: BEGIN
[0m18:11:57.740785 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:11:57.742164 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:11:57.743240 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:11:57.746243 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m18:11:57.747434 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:11:57.748786 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m18:11:57.749480 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m18:11:57.750239 [debug] [Thread-3  ]: SQL status: BEGIN in 0.007 seconds
[0m18:11:57.750981 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_end as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_end

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m18:11:57.752067 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:11:57.753090 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:11:57.753997 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:11:57.755596 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is null



      
    ) dbt_internal_test
[0m18:11:57.756863 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_start as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_start

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m18:11:57.758031 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close is null



      
    ) dbt_internal_test
[0m18:11:57.809743 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.050 seconds
[0m18:11:57.822108 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: ROLLBACK
[0m18:11:57.824050 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: Close
[0m18:11:57.826190 [info ] [Thread-4  ]: 4 of 18 PASS not_null_stg_kaggle__btcusdt_close_time ........................... [[32mPASS[0m in 0.21s]
[0m18:11:57.828391 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:11:57.830147 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:11:57.831768 [info ] [Thread-4  ]: 5 of 18 START test not_null_stg_kaggle__btcusdt_high ........................... [RUN]
[0m18:11:57.833410 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m18:11:57.834955 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:11:57.842500 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:11:57.843425 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.088 seconds
[0m18:11:57.844160 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.084 seconds
[0m18:11:57.844821 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.085 seconds
[0m18:11:57.847762 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: ROLLBACK
[0m18:11:57.850094 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: ROLLBACK
[0m18:11:57.851064 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:11:57.853173 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: ROLLBACK
[0m18:11:57.854668 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: Close
[0m18:11:57.855442 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: Close
[0m18:11:57.861133 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:11:57.862902 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: Close
[0m18:11:57.864204 [info ] [Thread-1  ]: 1 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_end__True__False ......... [[32mPASS[0m in 0.25s]
[0m18:11:57.865618 [info ] [Thread-3  ]: 3 of 18 PASS not_null_stg_kaggle__btcusdt_close ................................ [[32mPASS[0m in 0.25s]
[0m18:11:57.867885 [info ] [Thread-2  ]: 2 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_start__True__False ....... [[32mPASS[0m in 0.25s]
[0m18:11:57.869320 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:11:57.870160 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:11:57.871211 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:11:57.872415 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:11:57.873610 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:11:57.874768 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: BEGIN
[0m18:11:57.875783 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:11:57.877120 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:11:57.878223 [info ] [Thread-1  ]: 6 of 18 START test not_null_stg_kaggle__btcusdt_hour_end ....................... [RUN]
[0m18:11:57.879422 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:11:57.880438 [info ] [Thread-3  ]: 7 of 18 START test not_null_stg_kaggle__btcusdt_hour_start ..................... [RUN]
[0m18:11:57.881629 [info ] [Thread-2  ]: 8 of 18 START test not_null_stg_kaggle__btcusdt_low ............................ [RUN]
[0m18:11:57.882884 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m18:11:57.884363 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m18:11:57.885580 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m18:11:57.886762 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:11:57.887764 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:11:57.888511 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m18:11:57.889437 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:11:57.895533 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:11:57.901236 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:11:57.902261 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:11:57.907952 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:11:57.910052 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where high is null



      
    ) dbt_internal_test
[0m18:11:57.911288 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:11:57.911992 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:11:57.917057 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:11:57.921626 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:11:57.922741 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:11:57.930007 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:11:57.930967 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:11:57.932005 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:11:57.933312 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: BEGIN
[0m18:11:57.934347 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: BEGIN
[0m18:11:57.935455 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:11:57.936791 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:57.937875 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:11:57.938972 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: BEGIN
[0m18:11:57.941814 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:11:57.945226 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m18:11:57.946140 [debug] [Thread-3  ]: SQL status: BEGIN in 0.008 seconds
[0m18:11:57.947415 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:11:57.948456 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.035 seconds
[0m18:11:57.949304 [debug] [Thread-2  ]: SQL status: BEGIN in 0.008 seconds
[0m18:11:57.950015 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:11:57.951109 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_end
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_end is null



      
    ) dbt_internal_test
[0m18:11:57.953566 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: ROLLBACK
[0m18:11:57.954653 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:11:57.955847 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_start
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_start is null



      
    ) dbt_internal_test
[0m18:11:57.957697 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: Close
[0m18:11:57.958469 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where low is null



      
    ) dbt_internal_test
[0m18:11:57.961157 [info ] [Thread-4  ]: 5 of 18 PASS not_null_stg_kaggle__btcusdt_high ................................. [[32mPASS[0m in 0.13s]
[0m18:11:57.967299 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:11:57.969011 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:11:57.970836 [info ] [Thread-4  ]: 9 of 18 START test not_null_stg_kaggle__btcusdt_number_of_trades ............... [RUN]
[0m18:11:57.972535 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m18:11:57.974087 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:11:57.985523 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:11:57.988498 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:11:57.995128 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:11:57.999334 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:11:58.000949 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: BEGIN
[0m18:11:58.002297 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:11:58.009523 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m18:11:58.011355 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:11:58.013055 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select number_of_trades
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where number_of_trades is null



      
    ) dbt_internal_test
[0m18:11:58.025414 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.059 seconds
[0m18:11:58.031414 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: ROLLBACK
[0m18:11:58.033437 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.076 seconds
[0m18:11:58.034821 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: Close
[0m18:11:58.038436 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: ROLLBACK
[0m18:11:58.040901 [info ] [Thread-2  ]: 8 of 18 PASS not_null_stg_kaggle__btcusdt_low .................................. [[32mPASS[0m in 0.16s]
[0m18:11:58.041879 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.082 seconds
[0m18:11:58.043046 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: Close
[0m18:11:58.044134 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:11:58.046638 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: ROLLBACK
[0m18:11:58.048169 [info ] [Thread-1  ]: 6 of 18 PASS not_null_stg_kaggle__btcusdt_hour_end ............................. [[32mPASS[0m in 0.17s]
[0m18:11:58.049473 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:11:58.051073 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: Close
[0m18:11:58.052101 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:11:58.053193 [info ] [Thread-2  ]: 10 of 18 START test not_null_stg_kaggle__btcusdt_open .......................... [RUN]
[0m18:11:58.054677 [info ] [Thread-3  ]: 7 of 18 PASS not_null_stg_kaggle__btcusdt_hour_start ........................... [[32mPASS[0m in 0.17s]
[0m18:11:58.055993 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:11:58.057389 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m18:11:58.058878 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:11:58.059953 [info ] [Thread-1  ]: 11 of 18 START test not_null_stg_kaggle__btcusdt_open_date ..................... [RUN]
[0m18:11:58.061117 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:11:58.062325 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:11:58.063552 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m18:11:58.070604 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:11:58.071911 [info ] [Thread-3  ]: 12 of 18 START test not_null_stg_kaggle__btcusdt_open_time ..................... [RUN]
[0m18:11:58.073306 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:11:58.075514 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m18:11:58.083114 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:11:58.083989 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:11:58.084848 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.070 seconds
[0m18:11:58.085895 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:11:58.092191 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:11:58.095914 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: ROLLBACK
[0m18:11:58.105509 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:11:58.107103 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:11:58.109184 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: Close
[0m18:11:58.111008 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:11:58.116619 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:11:58.119332 [info ] [Thread-4  ]: 9 of 18 PASS not_null_stg_kaggle__btcusdt_number_of_trades ..................... [[32mPASS[0m in 0.15s]
[0m18:11:58.120640 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:11:58.121998 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: BEGIN
[0m18:11:58.124798 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:11:58.130558 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:11:58.131512 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:11:58.132784 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:11:58.134203 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:11:58.136602 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: BEGIN
[0m18:11:58.138464 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:11:58.140241 [info ] [Thread-4  ]: 13 of 18 START test not_null_stg_kaggle__btcusdt_quote_asset_volume ............ [RUN]
[0m18:11:58.141442 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:58.142859 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: BEGIN
[0m18:11:58.143770 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m18:11:58.144927 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m18:11:58.146963 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:11:58.148494 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:11:58.149880 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:11:58.151428 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m18:11:58.152812 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open is null



      
    ) dbt_internal_test
[0m18:11:58.159640 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:11:58.161013 [debug] [Thread-3  ]: SQL status: BEGIN in 0.014 seconds
[0m18:11:58.161808 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:11:58.164061 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:11:58.168329 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_date
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_date is null



      
    ) dbt_internal_test
[0m18:11:58.169570 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:11:58.170771 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is null



      
    ) dbt_internal_test
[0m18:11:58.177088 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:11:58.181519 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:11:58.183421 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: BEGIN
[0m18:11:58.185349 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:11:58.193188 [debug] [Thread-4  ]: SQL status: BEGIN in 0.008 seconds
[0m18:11:58.194924 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:11:58.196737 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where quote_asset_volume is null



      
    ) dbt_internal_test
[0m18:11:58.211445 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.048 seconds
[0m18:11:58.216123 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: ROLLBACK
[0m18:11:58.218191 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: Close
[0m18:11:58.220444 [info ] [Thread-2  ]: 10 of 18 PASS not_null_stg_kaggle__btcusdt_open ................................ [[32mPASS[0m in 0.16s]
[0m18:11:58.222925 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:11:58.225230 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:11:58.227033 [info ] [Thread-2  ]: 14 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ... [RUN]
[0m18:11:58.228654 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m18:11:58.229671 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.051 seconds
[0m18:11:58.230912 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:11:58.234124 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: ROLLBACK
[0m18:11:58.241171 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.069 seconds
[0m18:11:58.242867 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:11:58.244279 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: Close
[0m18:11:58.246516 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: ROLLBACK
[0m18:11:58.248476 [info ] [Thread-3  ]: 12 of 18 PASS not_null_stg_kaggle__btcusdt_open_time ........................... [[32mPASS[0m in 0.17s]
[0m18:11:58.250459 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:11:58.251395 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: Close
[0m18:11:58.252321 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:11:58.253020 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:11:58.254529 [info ] [Thread-1  ]: 11 of 18 PASS not_null_stg_kaggle__btcusdt_open_date ........................... [[32mPASS[0m in 0.19s]
[0m18:11:58.255754 [info ] [Thread-3  ]: 15 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume .. [RUN]
[0m18:11:58.263174 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:11:58.265510 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:11:58.267119 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m18:11:58.268517 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.070 seconds
[0m18:11:58.269978 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:11:58.271194 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:11:58.271971 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:11:58.274518 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: ROLLBACK
[0m18:11:58.275746 [info ] [Thread-1  ]: 16 of 18 START test not_null_stg_kaggle__btcusdt_volume ........................ [RUN]
[0m18:11:58.283241 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:11:58.284395 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: BEGIN
[0m18:11:58.285855 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: Close
[0m18:11:58.286639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m18:11:58.288163 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:11:58.289553 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:11:58.291358 [info ] [Thread-4  ]: 13 of 18 PASS not_null_stg_kaggle__btcusdt_quote_asset_volume .................. [[32mPASS[0m in 0.15s]
[0m18:11:58.293341 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:11:58.299147 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:11:58.300999 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:11:58.301887 [debug] [Thread-2  ]: SQL status: BEGIN in 0.014 seconds
[0m18:11:58.308461 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:11:58.310547 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:11:58.312260 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:11:58.313191 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:11:58.315328 [info ] [Thread-4  ]: 17 of 18 START test unique_stg_kaggle__btcusdt_close_time ...................... [RUN]
[0m18:11:58.316870 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:11:58.317697 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: BEGIN
[0m18:11:58.318961 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_base_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_base_asset_volume is null



      
    ) dbt_internal_test
[0m18:11:58.320421 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m18:11:58.325569 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:11:58.326947 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:11:58.328532 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:11:58.337213 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:11:58.343031 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:11:58.344270 [debug] [Thread-3  ]: SQL status: BEGIN in 0.017 seconds
[0m18:11:58.345072 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: BEGIN
[0m18:11:58.346913 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:11:58.348182 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:58.349240 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:11:58.350031 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_quote_asset_volume is null



      
    ) dbt_internal_test
[0m18:11:58.357355 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:11:58.359291 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m18:11:58.361785 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:11:58.363108 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where volume is null



      
    ) dbt_internal_test
[0m18:11:58.364361 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:11:58.369525 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: BEGIN
[0m18:11:58.371224 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:11:58.377640 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.049 seconds
[0m18:11:58.381418 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: ROLLBACK
[0m18:11:58.382339 [debug] [Thread-4  ]: SQL status: BEGIN in 0.011 seconds
[0m18:11:58.384132 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: Close
[0m18:11:58.384966 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:11:58.386680 [info ] [Thread-2  ]: 14 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ......... [[32mPASS[0m in 0.16s]
[0m18:11:58.388891 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    close_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is not null
group by close_time
having count(*) > 1



      
    ) dbt_internal_test
[0m18:11:58.392207 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:11:58.394216 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:11:58.396190 [info ] [Thread-2  ]: 18 of 18 START test unique_stg_kaggle__btcusdt_open_time ....................... [RUN]
[0m18:11:58.397657 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m18:11:58.398951 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:11:58.407396 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:11:58.410222 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:11:58.416305 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:11:58.418963 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:11:58.421024 [debug] [Thread-2  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: BEGIN
[0m18:11:58.423066 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:11:58.424221 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.059 seconds
[0m18:11:58.426220 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.066 seconds
[0m18:11:58.429756 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: ROLLBACK
[0m18:11:58.432950 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: ROLLBACK
[0m18:11:58.433881 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m18:11:58.435483 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: Close
[0m18:11:58.436860 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: Close
[0m18:11:58.437762 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:11:58.439537 [info ] [Thread-1  ]: 16 of 18 PASS not_null_stg_kaggle__btcusdt_volume .............................. [[32mPASS[0m in 0.15s]
[0m18:11:58.443101 [info ] [Thread-3  ]: 15 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume ........ [[32mPASS[0m in 0.18s]
[0m18:11:58.444702 [debug] [Thread-2  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    open_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is not null
group by open_time
having count(*) > 1



      
    ) dbt_internal_test
[0m18:11:58.446616 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:11:58.448183 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:11:59.406031 [debug] [Thread-4  ]: SQL status: SELECT 1 in 1.013 seconds
[0m18:11:59.406909 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.958 seconds
[0m18:11:59.410636 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: ROLLBACK
[0m18:11:59.412871 [debug] [Thread-2  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: ROLLBACK
[0m18:11:59.414428 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: Close
[0m18:11:59.415207 [debug] [Thread-2  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: Close
[0m18:11:59.416508 [error] [Thread-4  ]: 17 of 18 FAIL 8 unique_stg_kaggle__btcusdt_close_time .......................... [[31mFAIL 8[0m in 1.10s]
[0m18:11:59.418157 [error] [Thread-2  ]: 18 of 18 FAIL 8 unique_stg_kaggle__btcusdt_open_time ........................... [[31mFAIL 8[0m in 1.02s]
[0m18:11:59.419419 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:11:59.420592 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:11:59.424723 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:59.425616 [debug] [MainThread]: On master: BEGIN
[0m18:11:59.426463 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:11:59.431260 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:11:59.432363 [debug] [MainThread]: On master: COMMIT
[0m18:11:59.433234 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:59.434029 [debug] [MainThread]: On master: COMMIT
[0m18:11:59.435055 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:11:59.436075 [debug] [MainThread]: On master: Close
[0m18:11:59.437154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:59.437983 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae' was properly closed.
[0m18:11:59.438761 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa' was properly closed.
[0m18:11:59.439507 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42' was properly closed.
[0m18:11:59.440373 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb' was properly closed.
[0m18:11:59.441270 [info ] [MainThread]: 
[0m18:11:59.442050 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m18:11:59.446600 [debug] [MainThread]: Command end result
[0m18:11:59.447416 [info ] [MainThread]: 
[0m18:11:59.448571 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:11:59.449537 [info ] [MainThread]: 
[0m18:11:59.450584 [error] [MainThread]: [31mFailure in test unique_stg_kaggle__btcusdt_close_time (models/staging/kaggle/docs/stg_kaggle__btcusdt.yml)[0m
[0m18:11:59.451609 [error] [MainThread]:   Got 8 results, configured to fail if != 0
[0m18:11:59.452569 [info ] [MainThread]: 
[0m18:11:59.453567 [info ] [MainThread]:   compiled code at target/compiled/dbt_btc_transform/models/staging/kaggle/docs/stg_kaggle__btcusdt.yml/unique_stg_kaggle__btcusdt_close_time.sql
[0m18:11:59.454438 [info ] [MainThread]: 
[0m18:11:59.455487 [error] [MainThread]: [31mFailure in test unique_stg_kaggle__btcusdt_open_time (models/staging/kaggle/docs/stg_kaggle__btcusdt.yml)[0m
[0m18:11:59.456487 [error] [MainThread]:   Got 8 results, configured to fail if != 0
[0m18:11:59.457323 [info ] [MainThread]: 
[0m18:11:59.458226 [info ] [MainThread]:   compiled code at target/compiled/dbt_btc_transform/models/staging/kaggle/docs/stg_kaggle__btcusdt.yml/unique_stg_kaggle__btcusdt_open_time.sql
[0m18:11:59.459012 [info ] [MainThread]: 
[0m18:11:59.459909 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=2 SKIP=0 TOTAL=18
[0m18:11:59.461306 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.9737387, "process_user_time": 5.580452, "process_kernel_time": 0.208959, "process_mem_max_rss": "119728", "process_out_blocks": "1291", "command_success": false, "process_in_blocks": "0"}
[0m18:11:59.462293 [debug] [MainThread]: Command `dbt test` failed at 18:11:59.462168 after 4.97 seconds
[0m18:11:59.463159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe582c59100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57ff57be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57fbd8730>]}
[0m18:11:59.464084 [debug] [MainThread]: Flushing usage events
[0m18:12:57.219471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94f8a20a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94d519640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94d5195e0>]}


============================== 18:12:57.230448 | 9d04ca11-7cd3-40fc-aaeb-e9f839308477 ==============================
[0m18:12:57.230448 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:12:57.233439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models int_hourly_trades', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:12:57.470923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d04ca11-7cd3-40fc-aaeb-e9f839308477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94d588160>]}
[0m18:12:57.549354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d04ca11-7cd3-40fc-aaeb-e9f839308477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94ced09a0>]}
[0m18:12:57.550786 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:12:57.582183 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:12:57.856328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:57.857125 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:57.927916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d04ca11-7cd3-40fc-aaeb-e9f839308477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94c316130>]}
[0m18:12:57.943076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d04ca11-7cd3-40fc-aaeb-e9f839308477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94c33c730>]}
[0m18:12:57.944315 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:12:57.945318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d04ca11-7cd3-40fc-aaeb-e9f839308477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94c691160>]}
[0m18:12:57.947569 [info ] [MainThread]: 
[0m18:12:57.948757 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:12:57.950366 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m18:12:58.058800 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m18:12:58.059927 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m18:12:58.060953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:58.067421 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m18:12:58.069682 [debug] [ThreadPool]: On list_company_dw: Close
[0m18:12:58.076980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m18:12:58.087222 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:12:58.088303 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:12:58.089186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:58.093954 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:12:58.094962 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:12:58.095939 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:12:58.099381 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:12:58.101281 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:12:58.102532 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:12:58.110098 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:58.111142 [debug] [MainThread]: On master: BEGIN
[0m18:12:58.111998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:58.116885 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:12:58.117879 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:58.119093 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:12:58.126389 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m18:12:58.128420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d04ca11-7cd3-40fc-aaeb-e9f839308477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94f926fd0>]}
[0m18:12:58.129353 [debug] [MainThread]: On master: ROLLBACK
[0m18:12:58.130388 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:58.131289 [debug] [MainThread]: On master: BEGIN
[0m18:12:58.132723 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:12:58.133540 [debug] [MainThread]: On master: COMMIT
[0m18:12:58.134308 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:58.135259 [debug] [MainThread]: On master: COMMIT
[0m18:12:58.136324 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:12:58.137168 [debug] [MainThread]: On master: Close
[0m18:12:58.138267 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:12:58.139133 [info ] [MainThread]: 
[0m18:12:58.148491 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.int_hourly_trades
[0m18:12:58.149673 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.int_hourly_trades ....................... [RUN]
[0m18:12:58.150763 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.int_hourly_trades)
[0m18:12:58.151751 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.int_hourly_trades
[0m18:12:58.164097 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:12:58.167498 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.int_hourly_trades
[0m18:12:58.222678 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:12:58.225150 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:12:58.226104 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: BEGIN
[0m18:12:58.227056 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:12:58.232583 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m18:12:58.233657 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:12:58.234930 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */

  
    

  create  table "company_dw"."analytics"."int_hourly_trades__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."analytics"."stg_kaggle__btcusdt"

),


hourly as (

    select distinct
        open_date,

        case
            when hour_start is true
                then extract(minutes from open_time)
        end as open_hour,

        case
            when hour_start is true
                then open
        end as open_price,

        case
            when hour_end is true
                then close
        end as close_price

    from source
    where
        hour_start is true or hour_end is true

),


final as (

    select
        open_date,
        open_hour,
        open_price,
        close_price,       
        (close_price - open_price) * 1.0 / open_price as percent_gain

    from hourly

)

select * from final
  );
  
[0m18:12:58.295777 [debug] [Thread-1  ]: SQL status: SELECT 555 in 0.059 seconds
[0m18:12:58.306340 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:12:58.307526 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */
alter table "company_dw"."analytics"."int_hourly_trades__dbt_tmp" rename to "int_hourly_trades"
[0m18:12:58.309182 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:12:58.335536 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: COMMIT
[0m18:12:58.336619 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:12:58.337580 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: COMMIT
[0m18:12:58.339956 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m18:12:58.349317 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."int_hourly_trades__dbt_backup"
[0m18:12:58.355520 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:12:58.356471 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */
drop table if exists "company_dw"."analytics"."int_hourly_trades__dbt_backup" cascade
[0m18:12:58.357812 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m18:12:58.361364 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: Close
[0m18:12:58.363939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d04ca11-7cd3-40fc-aaeb-e9f839308477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94bac1340>]}
[0m18:12:58.365424 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.int_hourly_trades .................. [[32mSELECT 555[0m in 0.21s]
[0m18:12:58.366747 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.int_hourly_trades
[0m18:12:58.369539 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:58.370404 [debug] [MainThread]: On master: BEGIN
[0m18:12:58.371229 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:12:58.375995 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:12:58.376992 [debug] [MainThread]: On master: COMMIT
[0m18:12:58.377993 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:58.378862 [debug] [MainThread]: On master: COMMIT
[0m18:12:58.379983 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:12:58.380835 [debug] [MainThread]: On master: Close
[0m18:12:58.381934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:58.382814 [debug] [MainThread]: Connection 'model.dbt_btc_transform.int_hourly_trades' was properly closed.
[0m18:12:58.383692 [info ] [MainThread]: 
[0m18:12:58.384578 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m18:12:58.385874 [debug] [MainThread]: Command end result
[0m18:12:58.386721 [info ] [MainThread]: 
[0m18:12:58.387673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:12:58.388567 [info ] [MainThread]: 
[0m18:12:58.389492 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:12:58.391120 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.246071, "process_user_time": 3.435419, "process_kernel_time": 0.178305, "process_mem_max_rss": "109524", "process_out_blocks": "37", "process_in_blocks": "0"}
[0m18:12:58.392475 [debug] [MainThread]: Command `dbt run` succeeded at 18:12:58.392248 after 1.25 seconds
[0m18:12:58.393516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94f8a20a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94cbcfa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94d588160>]}
[0m18:12:58.394538 [debug] [MainThread]: Flushing usage events
[0m18:13:03.045336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9efbcb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ed82b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ed82b5b0>]}


============================== 18:13:03.052646 | adfc5324-063d-4335-9357-b56be1128d11 ==============================
[0m18:13:03.052646 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:13:03.053879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models int_hourly_trades', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:13:03.286173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adfc5324-063d-4335-9357-b56be1128d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ef798430>]}
[0m18:13:03.356975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adfc5324-063d-4335-9357-b56be1128d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ed9e9100>]}
[0m18:13:03.358545 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:13:03.391948 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:13:03.647341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:03.648198 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:03.718389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adfc5324-063d-4335-9357-b56be1128d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ec896130>]}
[0m18:13:03.744748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adfc5324-063d-4335-9357-b56be1128d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ec9dc430>]}
[0m18:13:03.745812 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:13:03.746734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adfc5324-063d-4335-9357-b56be1128d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ec9d1160>]}
[0m18:13:03.748810 [info ] [MainThread]: 
[0m18:13:03.749733 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:13:03.752528 [debug] [MainThread]: Command end result
[0m18:13:03.753967 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.78143317, "process_user_time": 2.726113, "process_kernel_time": 0.141338, "process_mem_max_rss": "103832", "process_out_blocks": "11", "process_in_blocks": "0"}
[0m18:13:03.755961 [debug] [MainThread]: Command `dbt test` succeeded at 18:13:03.755775 after 0.78 seconds
[0m18:13:03.757411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9efbcb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ec4a1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ed9e9100>]}
[0m18:13:03.758384 [debug] [MainThread]: Flushing usage events
[0m18:15:19.725031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb488c15100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4868ab6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4868ab640>]}


============================== 18:15:19.734628 | b4f03907-bf5e-47e8-9434-de86d61d8335 ==============================
[0m18:15:19.734628 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:15:19.736640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models stg_kaggle__btcusdt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:15:19.994440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4f03907-bf5e-47e8-9434-de86d61d8335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4868d13d0>]}
[0m18:15:20.067408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4f03907-bf5e-47e8-9434-de86d61d8335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48919ddf0>]}
[0m18:15:20.069095 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:15:20.107954 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:15:20.312590 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:15:20.313938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4f03907-bf5e-47e8-9434-de86d61d8335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb487bb82b0>]}
[0m18:15:22.611499 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:15:22.613229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b4f03907-bf5e-47e8-9434-de86d61d8335', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4860f5250>]}
[0m18:15:23.035495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4f03907-bf5e-47e8-9434-de86d61d8335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb485d964c0>]}
[0m18:15:23.061950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4f03907-bf5e-47e8-9434-de86d61d8335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4855b0280>]}
[0m18:15:23.063025 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:15:23.063934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4f03907-bf5e-47e8-9434-de86d61d8335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48611a730>]}
[0m18:15:23.067253 [info ] [MainThread]: 
[0m18:15:23.068446 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:15:23.075845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analytics'
[0m18:15:23.121617 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:15:23.122715 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:15:23.123596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:23.131146 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:15:23.132925 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:15:23.135079 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:15:23.140109 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m18:15:23.142747 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:15:23.144284 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:15:23.154058 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:23.155129 [debug] [MainThread]: On master: BEGIN
[0m18:15:23.156047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:15:23.161078 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:15:23.162106 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:23.163368 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:15:23.174816 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m18:15:23.177367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4f03907-bf5e-47e8-9434-de86d61d8335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb486565d60>]}
[0m18:15:23.178631 [debug] [MainThread]: On master: ROLLBACK
[0m18:15:23.180389 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:23.181470 [debug] [MainThread]: On master: BEGIN
[0m18:15:23.182915 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:15:23.183736 [debug] [MainThread]: On master: COMMIT
[0m18:15:23.184806 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:23.185882 [debug] [MainThread]: On master: COMMIT
[0m18:15:23.187863 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:15:23.188875 [debug] [MainThread]: On master: Close
[0m18:15:23.190582 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:15:23.191925 [info ] [MainThread]: 
[0m18:15:23.202656 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:15:23.203683 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:15:23.204653 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:15:23.205746 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:15:23.206874 [info ] [Thread-1  ]: 1 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_end__True__False ... [RUN]
[0m18:15:23.208236 [info ] [Thread-2  ]: 2 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_start__True__False . [RUN]
[0m18:15:23.209553 [info ] [Thread-3  ]: 3 of 18 START test not_null_stg_kaggle__btcusdt_close .......................... [RUN]
[0m18:15:23.210890 [info ] [Thread-4  ]: 4 of 18 START test not_null_stg_kaggle__btcusdt_close_time ..................... [RUN]
[0m18:15:23.212213 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872)
[0m18:15:23.213743 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m18:15:23.215115 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb'
[0m18:15:23.216340 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a'
[0m18:15:23.217502 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:15:23.218663 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:15:23.219821 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:15:23.221492 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:15:23.236219 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:15:23.243057 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:15:23.255845 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:15:23.263414 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:15:23.267905 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:15:23.268869 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:15:23.270205 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:15:23.293371 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:15:23.297654 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:15:23.298528 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:15:23.302506 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:15:23.309233 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:15:23.310450 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:15:23.311568 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:15:23.315029 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: BEGIN
[0m18:15:23.315963 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:15:23.317195 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: BEGIN
[0m18:15:23.317988 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:15:23.318983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:15:23.320013 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: BEGIN
[0m18:15:23.321191 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:15:23.322171 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: BEGIN
[0m18:15:23.323776 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:15:23.326062 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:15:23.328177 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m18:15:23.330031 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m18:15:23.331472 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:15:23.332885 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:15:23.333801 [debug] [Thread-3  ]: SQL status: BEGIN in 0.010 seconds
[0m18:15:23.335124 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_end as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_end

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m18:15:23.336020 [debug] [Thread-4  ]: SQL status: BEGIN in 0.010 seconds
[0m18:15:23.337100 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_start as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_start

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m18:15:23.338297 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:15:23.340027 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:15:23.341948 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close is null



      
    ) dbt_internal_test
[0m18:15:23.343739 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is null



      
    ) dbt_internal_test
[0m18:15:23.423007 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.077 seconds
[0m18:15:23.434902 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: ROLLBACK
[0m18:15:23.437498 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: Close
[0m18:15:23.440463 [info ] [Thread-3  ]: 3 of 18 PASS not_null_stg_kaggle__btcusdt_close ................................ [[32mPASS[0m in 0.22s]
[0m18:15:23.442147 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.096 seconds
[0m18:15:23.444687 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:15:23.449526 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: ROLLBACK
[0m18:15:23.451341 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.110 seconds
[0m18:15:23.452509 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:15:23.453663 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.114 seconds
[0m18:15:23.455339 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: Close
[0m18:15:23.458510 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: ROLLBACK
[0m18:15:23.460104 [info ] [Thread-3  ]: 5 of 18 START test not_null_stg_kaggle__btcusdt_high ........................... [RUN]
[0m18:15:23.463020 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: ROLLBACK
[0m18:15:23.464619 [info ] [Thread-4  ]: 4 of 18 PASS not_null_stg_kaggle__btcusdt_close_time ........................... [[32mPASS[0m in 0.25s]
[0m18:15:23.468593 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: Close
[0m18:15:23.469693 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m18:15:23.471458 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: Close
[0m18:15:23.472900 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:15:23.474707 [info ] [Thread-2  ]: 2 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_start__True__False ....... [[32mPASS[0m in 0.26s]
[0m18:15:23.476162 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:15:23.478748 [info ] [Thread-1  ]: 1 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_end__True__False ......... [[32mPASS[0m in 0.27s]
[0m18:15:23.480586 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:15:23.482388 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:15:23.490156 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:15:23.491568 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:15:23.492931 [info ] [Thread-4  ]: 6 of 18 START test not_null_stg_kaggle__btcusdt_hour_end ....................... [RUN]
[0m18:15:23.494907 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:15:23.497133 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:15:23.498576 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m18:15:23.499599 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:15:23.500757 [info ] [Thread-2  ]: 7 of 18 START test not_null_stg_kaggle__btcusdt_hour_start ..................... [RUN]
[0m18:15:23.502500 [info ] [Thread-1  ]: 8 of 18 START test not_null_stg_kaggle__btcusdt_low ............................ [RUN]
[0m18:15:23.503977 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:15:23.511979 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:15:23.513267 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m18:15:23.514735 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m18:15:23.522601 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:15:23.524908 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:15:23.526261 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:15:23.527631 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:15:23.536096 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:15:23.543421 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:15:23.545661 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:15:23.547112 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: BEGIN
[0m18:15:23.553786 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:15:23.555653 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:15:23.557025 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:15:23.558915 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:15:23.564754 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:15:23.566532 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:15:23.574214 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:15:23.575066 [debug] [Thread-3  ]: SQL status: BEGIN in 0.018 seconds
[0m18:15:23.578619 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: BEGIN
[0m18:15:23.580681 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:15:23.582028 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:15:23.583417 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:15:23.585186 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:15:23.586438 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: BEGIN
[0m18:15:23.588272 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where high is null



      
    ) dbt_internal_test
[0m18:15:23.591048 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: BEGIN
[0m18:15:23.592647 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:15:23.595000 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:15:23.597321 [debug] [Thread-4  ]: SQL status: BEGIN in 0.014 seconds
[0m18:15:23.600269 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:15:23.602292 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_end
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_end is null



      
    ) dbt_internal_test
[0m18:15:23.604436 [debug] [Thread-2  ]: SQL status: BEGIN in 0.012 seconds
[0m18:15:23.606753 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:15:23.608682 [debug] [Thread-1  ]: SQL status: BEGIN in 0.014 seconds
[0m18:15:23.610644 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_start
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_start is null



      
    ) dbt_internal_test
[0m18:15:23.612730 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:15:23.615365 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where low is null



      
    ) dbt_internal_test
[0m18:15:23.666599 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.072 seconds
[0m18:15:23.672263 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: ROLLBACK
[0m18:15:23.674583 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: Close
[0m18:15:23.677240 [info ] [Thread-3  ]: 5 of 18 PASS not_null_stg_kaggle__btcusdt_high ................................. [[32mPASS[0m in 0.21s]
[0m18:15:23.680228 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:15:23.682230 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:15:23.684170 [info ] [Thread-3  ]: 9 of 18 START test not_null_stg_kaggle__btcusdt_number_of_trades ............... [RUN]
[0m18:15:23.686974 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m18:15:23.688637 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:15:23.700651 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:15:23.704197 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.100 seconds
[0m18:15:23.708087 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: ROLLBACK
[0m18:15:23.709407 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:15:23.710412 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.096 seconds
[0m18:15:23.711632 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: Close
[0m18:15:23.718297 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.101 seconds
[0m18:15:23.716964 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:15:23.723124 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: ROLLBACK
[0m18:15:23.725579 [info ] [Thread-4  ]: 6 of 18 PASS not_null_stg_kaggle__btcusdt_hour_end ............................. [[32mPASS[0m in 0.23s]
[0m18:15:23.729486 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: ROLLBACK
[0m18:15:23.732599 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: Close
[0m18:15:23.734576 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:15:23.737002 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:15:23.739409 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: Close
[0m18:15:23.742106 [info ] [Thread-2  ]: 7 of 18 PASS not_null_stg_kaggle__btcusdt_hour_start ........................... [[32mPASS[0m in 0.23s]
[0m18:15:23.745326 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:15:23.748168 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: BEGIN
[0m18:15:23.751127 [info ] [Thread-1  ]: 8 of 18 PASS not_null_stg_kaggle__btcusdt_low .................................. [[32mPASS[0m in 0.24s]
[0m18:15:23.754215 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:15:23.756373 [info ] [Thread-4  ]: 10 of 18 START test not_null_stg_kaggle__btcusdt_open .......................... [RUN]
[0m18:15:23.759158 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:15:23.765932 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:15:23.768366 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:15:23.774253 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m18:15:23.778181 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:15:23.781089 [info ] [Thread-2  ]: 11 of 18 START test not_null_stg_kaggle__btcusdt_open_date ..................... [RUN]
[0m18:15:23.783937 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:15:23.785899 [debug] [Thread-3  ]: SQL status: BEGIN in 0.027 seconds
[0m18:15:23.788962 [info ] [Thread-1  ]: 12 of 18 START test not_null_stg_kaggle__btcusdt_open_time ..................... [RUN]
[0m18:15:23.791654 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m18:15:23.804468 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:15:23.806080 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:15:23.808019 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m18:15:23.810473 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:15:23.813859 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select number_of_trades
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where number_of_trades is null



      
    ) dbt_internal_test
[0m18:15:23.816057 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:15:23.817308 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:15:23.828990 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:15:23.844647 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:15:23.854151 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:15:23.858505 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:15:23.859659 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:15:23.866794 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:15:23.870038 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:15:23.879217 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:15:23.881319 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: BEGIN
[0m18:15:23.885391 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:15:23.887441 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:15:23.890430 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:15:23.892652 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: BEGIN
[0m18:15:23.895268 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: BEGIN
[0m18:15:23.897881 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:15:23.899665 [debug] [Thread-4  ]: SQL status: BEGIN in 0.014 seconds
[0m18:15:23.904188 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:15:23.907459 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:15:23.910916 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open is null



      
    ) dbt_internal_test
[0m18:15:23.912673 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.082 seconds
[0m18:15:23.918415 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: ROLLBACK
[0m18:15:23.920232 [debug] [Thread-2  ]: SQL status: BEGIN in 0.022 seconds
[0m18:15:23.923351 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m18:15:23.925161 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: Close
[0m18:15:23.926745 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:15:23.929322 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:15:23.932530 [info ] [Thread-3  ]: 9 of 18 PASS not_null_stg_kaggle__btcusdt_number_of_trades ..................... [[32mPASS[0m in 0.25s]
[0m18:15:23.935150 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_date
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_date is null



      
    ) dbt_internal_test
[0m18:15:23.938522 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is null



      
    ) dbt_internal_test
[0m18:15:23.941789 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:15:23.945764 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:15:23.949183 [info ] [Thread-3  ]: 13 of 18 START test not_null_stg_kaggle__btcusdt_quote_asset_volume ............ [RUN]
[0m18:15:23.957390 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m18:15:23.962580 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:15:23.976611 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:15:23.986975 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:15:23.988648 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.074 seconds
[0m18:15:24.000772 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:15:24.005641 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: ROLLBACK
[0m18:15:24.010122 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: Close
[0m18:15:24.012491 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:15:24.014677 [info ] [Thread-4  ]: 10 of 18 PASS not_null_stg_kaggle__btcusdt_open ................................ [[32mPASS[0m in 0.24s]
[0m18:15:24.016947 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: BEGIN
[0m18:15:24.019748 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.075 seconds
[0m18:15:24.023470 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:15:24.025426 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:15:24.031209 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: ROLLBACK
[0m18:15:24.034425 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:15:24.039995 [info ] [Thread-4  ]: 14 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ... [RUN]
[0m18:15:24.042285 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: Close
[0m18:15:24.044900 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m18:15:24.046542 [debug] [Thread-3  ]: SQL status: BEGIN in 0.021 seconds
[0m18:15:24.049789 [info ] [Thread-1  ]: 12 of 18 PASS not_null_stg_kaggle__btcusdt_open_time ........................... [[32mPASS[0m in 0.24s]
[0m18:15:24.052198 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.108 seconds
[0m18:15:24.054111 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:15:24.056291 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:15:24.058817 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:15:24.063467 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: ROLLBACK
[0m18:15:24.079234 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:15:24.081099 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where quote_asset_volume is null



      
    ) dbt_internal_test
[0m18:15:24.082759 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:15:24.085053 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: Close
[0m18:15:24.088049 [info ] [Thread-1  ]: 15 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume .. [RUN]
[0m18:15:24.089638 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:15:24.092394 [info ] [Thread-2  ]: 11 of 18 PASS not_null_stg_kaggle__btcusdt_open_date ........................... [[32mPASS[0m in 0.30s]
[0m18:15:24.095196 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m18:15:24.103413 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:15:24.106289 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:15:24.108212 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:15:24.113527 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:15:24.116144 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:15:24.126477 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:15:24.128068 [info ] [Thread-2  ]: 16 of 18 START test not_null_stg_kaggle__btcusdt_volume ........................ [RUN]
[0m18:15:24.129685 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: BEGIN
[0m18:15:24.132474 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m18:15:24.134094 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:15:24.135259 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:15:24.136781 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:15:24.144442 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:15:24.152374 [debug] [Thread-4  ]: SQL status: BEGIN in 0.018 seconds
[0m18:15:24.153597 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.067 seconds
[0m18:15:24.155076 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:15:24.157040 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:15:24.158546 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:15:24.161023 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: ROLLBACK
[0m18:15:24.163101 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_base_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_base_asset_volume is null



      
    ) dbt_internal_test
[0m18:15:24.164453 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: BEGIN
[0m18:15:24.165665 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:15:24.167003 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: Close
[0m18:15:24.169053 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:15:24.176624 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:15:24.179037 [info ] [Thread-3  ]: 13 of 18 PASS not_null_stg_kaggle__btcusdt_quote_asset_volume .................. [[32mPASS[0m in 0.22s]
[0m18:15:24.184192 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:15:24.186248 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:15:24.187665 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:15:24.189878 [info ] [Thread-3  ]: 17 of 18 START test unique_stg_kaggle__btcusdt_close_time ...................... [RUN]
[0m18:15:24.191236 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m18:15:24.193333 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: BEGIN
[0m18:15:24.195647 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m18:15:24.197772 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:15:24.199528 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:15:24.201161 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:15:24.202764 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_quote_asset_volume is null



      
    ) dbt_internal_test
[0m18:15:24.220943 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:15:24.223133 [debug] [Thread-2  ]: SQL status: BEGIN in 0.023 seconds
[0m18:15:24.225704 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:15:24.229677 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where volume is null



      
    ) dbt_internal_test
[0m18:15:24.231257 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:15:24.242474 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.074 seconds
[0m18:15:24.243977 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:15:24.248546 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: ROLLBACK
[0m18:15:24.252075 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: Close
[0m18:15:24.254319 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:15:24.256568 [info ] [Thread-4  ]: 14 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ......... [[32mPASS[0m in 0.21s]
[0m18:15:24.258429 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: BEGIN
[0m18:15:24.260637 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:15:24.262288 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:15:24.264464 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:15:24.267541 [info ] [Thread-4  ]: 18 of 18 START test unique_stg_kaggle__btcusdt_open_time ....................... [RUN]
[0m18:15:24.270566 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m18:15:24.272905 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:15:24.281446 [debug] [Thread-3  ]: SQL status: BEGIN in 0.019 seconds
[0m18:15:24.288578 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:15:24.290493 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:15:24.293690 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    close_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is not null
group by close_time
having count(*) > 1



      
    ) dbt_internal_test
[0m18:15:24.296057 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:15:24.305426 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:15:24.310155 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:15:24.311113 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.079 seconds
[0m18:15:24.312142 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.089 seconds
[0m18:15:24.313298 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: BEGIN
[0m18:15:24.318075 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: ROLLBACK
[0m18:15:24.322461 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: ROLLBACK
[0m18:15:24.324208 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:15:24.326389 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: Close
[0m18:15:24.328682 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: Close
[0m18:15:24.332451 [info ] [Thread-2  ]: 16 of 18 PASS not_null_stg_kaggle__btcusdt_volume .............................. [[32mPASS[0m in 0.20s]
[0m18:15:24.335431 [info ] [Thread-1  ]: 15 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume ........ [[32mPASS[0m in 0.24s]
[0m18:15:24.338794 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:15:24.340569 [debug] [Thread-4  ]: SQL status: BEGIN in 0.016 seconds
[0m18:15:24.342458 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:15:24.344923 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:15:24.347115 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    open_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is not null
group by open_time
having count(*) > 1



      
    ) dbt_internal_test
[0m18:15:25.404123 [debug] [Thread-4  ]: SQL status: SELECT 1 in 1.055 seconds
[0m18:15:25.407233 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: ROLLBACK
[0m18:15:25.408959 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: Close
[0m18:15:25.410648 [error] [Thread-4  ]: 18 of 18 FAIL 8 unique_stg_kaggle__btcusdt_open_time ........................... [[31mFAIL 8[0m in 1.14s]
[0m18:15:25.412184 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:15:25.417485 [debug] [Thread-3  ]: SQL status: SELECT 1 in 1.121 seconds
[0m18:15:25.420357 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: ROLLBACK
[0m18:15:25.421925 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: Close
[0m18:15:25.423549 [error] [Thread-3  ]: 17 of 18 FAIL 8 unique_stg_kaggle__btcusdt_close_time .......................... [[31mFAIL 8[0m in 1.23s]
[0m18:15:25.425000 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:15:25.428522 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:25.429545 [debug] [MainThread]: On master: BEGIN
[0m18:15:25.430462 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:15:25.435505 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:15:25.436586 [debug] [MainThread]: On master: COMMIT
[0m18:15:25.437543 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:25.438474 [debug] [MainThread]: On master: COMMIT
[0m18:15:25.439686 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:15:25.440797 [debug] [MainThread]: On master: Close
[0m18:15:25.442091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:25.443132 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42' was properly closed.
[0m18:15:25.444121 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae' was properly closed.
[0m18:15:25.445067 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb' was properly closed.
[0m18:15:25.446020 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa' was properly closed.
[0m18:15:25.447039 [info ] [MainThread]: 
[0m18:15:25.448131 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m18:15:25.453426 [debug] [MainThread]: Command end result
[0m18:15:25.454385 [info ] [MainThread]: 
[0m18:15:25.455413 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:15:25.456545 [info ] [MainThread]: 
[0m18:15:25.457576 [error] [MainThread]: [31mFailure in test unique_stg_kaggle__btcusdt_open_time (models/staging/kaggle/docs/stg_kaggle__btcusdt.yml)[0m
[0m18:15:25.458574 [error] [MainThread]:   Got 8 results, configured to fail if != 0
[0m18:15:25.459435 [info ] [MainThread]: 
[0m18:15:25.460433 [info ] [MainThread]:   compiled code at target/compiled/dbt_btc_transform/models/staging/kaggle/docs/stg_kaggle__btcusdt.yml/unique_stg_kaggle__btcusdt_open_time.sql
[0m18:15:25.461347 [info ] [MainThread]: 
[0m18:15:25.462407 [error] [MainThread]: [31mFailure in test unique_stg_kaggle__btcusdt_close_time (models/staging/kaggle/docs/stg_kaggle__btcusdt.yml)[0m
[0m18:15:25.463417 [error] [MainThread]:   Got 8 results, configured to fail if != 0
[0m18:15:25.464314 [info ] [MainThread]: 
[0m18:15:25.465828 [info ] [MainThread]:   compiled code at target/compiled/dbt_btc_transform/models/staging/kaggle/docs/stg_kaggle__btcusdt.yml/unique_stg_kaggle__btcusdt_close_time.sql
[0m18:15:25.467699 [info ] [MainThread]: 
[0m18:15:25.469187 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=2 SKIP=0 TOTAL=18
[0m18:15:25.471033 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.829093, "process_user_time": 6.437992, "process_kernel_time": 0.228897, "process_mem_max_rss": "119032", "process_out_blocks": "1292", "command_success": false, "process_in_blocks": "0"}
[0m18:15:25.472261 [debug] [MainThread]: Command `dbt test` failed at 18:15:25.472112 after 5.83 seconds
[0m18:15:25.473627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb488c15100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb486157be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4855b0d30>]}
[0m18:15:25.475780 [debug] [MainThread]: Flushing usage events
[0m18:15:33.076527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cd161100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cadd96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cadd9640>]}


============================== 18:15:33.083924 | 4176d5b5-b70e-4d36-8bd9-05242e6791cf ==============================
[0m18:15:33.083924 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:15:33.085071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models int_hourly_trades', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:15:33.323165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4176d5b5-b70e-4d36-8bd9-05242e6791cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cae003d0>]}
[0m18:15:33.407854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4176d5b5-b70e-4d36-8bd9-05242e6791cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cd6f9df0>]}
[0m18:15:33.409527 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:15:33.446582 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:15:33.716942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:15:33.717786 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:15:33.796253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4176d5b5-b70e-4d36-8bd9-05242e6791cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c9e56130>]}
[0m18:15:33.811854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4176d5b5-b70e-4d36-8bd9-05242e6791cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c9e7c790>]}
[0m18:15:33.812996 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:15:33.813950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4176d5b5-b70e-4d36-8bd9-05242e6791cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c9f90100>]}
[0m18:15:33.816193 [info ] [MainThread]: 
[0m18:15:33.817426 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:15:33.819050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m18:15:33.929881 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m18:15:33.931135 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m18:15:33.932294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:33.939805 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m18:15:33.942257 [debug] [ThreadPool]: On list_company_dw: Close
[0m18:15:33.950070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m18:15:33.961525 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:15:33.962555 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:15:33.963480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:33.968600 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:15:33.969649 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:15:33.970648 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:15:33.974371 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m18:15:33.976532 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:15:33.977693 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:15:33.985917 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:33.986947 [debug] [MainThread]: On master: BEGIN
[0m18:15:33.987879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:15:33.993478 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:15:33.994415 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:33.995542 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:15:34.003791 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:15:34.005748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4176d5b5-b70e-4d36-8bd9-05242e6791cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c9e7cbe0>]}
[0m18:15:34.006810 [debug] [MainThread]: On master: ROLLBACK
[0m18:15:34.007926 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:34.008784 [debug] [MainThread]: On master: BEGIN
[0m18:15:34.010099 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:15:34.010977 [debug] [MainThread]: On master: COMMIT
[0m18:15:34.011829 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:34.012720 [debug] [MainThread]: On master: COMMIT
[0m18:15:34.013849 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:15:34.014735 [debug] [MainThread]: On master: Close
[0m18:15:34.015789 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:15:34.016805 [info ] [MainThread]: 
[0m18:15:34.026122 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.int_hourly_trades
[0m18:15:34.027360 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.int_hourly_trades ....................... [RUN]
[0m18:15:34.028489 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.int_hourly_trades)
[0m18:15:34.029467 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.int_hourly_trades
[0m18:15:34.042791 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:15:34.046411 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.int_hourly_trades
[0m18:15:34.102576 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:15:34.106192 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:15:34.107271 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: BEGIN
[0m18:15:34.108149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:15:34.113479 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m18:15:34.114571 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:15:34.115553 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */

  
    

  create  table "company_dw"."analytics"."int_hourly_trades__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."analytics"."stg_kaggle__btcusdt"

),


hourly as (

    select distinct
        open_date,

        case
            when hour_start is true
                then extract(minutes from open_time)
        end as open_hour,

        case
            when hour_start is true
                then open
        end as open_price,

        case
            when hour_end is true
                then close
        end as close_price

    from source
    where
        hour_start is true or hour_end is true

),


final as (

    select
        open_date,
        open_hour,
        open_price,
        close_price,       
        (close_price - open_price) * 1.0 / open_price as percent_gain

    from hourly

)

select * from final
  );
  
[0m18:15:34.183588 [debug] [Thread-1  ]: SQL status: SELECT 555 in 0.066 seconds
[0m18:15:34.195590 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:15:34.196754 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */
alter table "company_dw"."analytics"."int_hourly_trades" rename to "int_hourly_trades__dbt_backup"
[0m18:15:34.198441 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:15:34.203940 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:15:34.205572 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */
alter table "company_dw"."analytics"."int_hourly_trades__dbt_tmp" rename to "int_hourly_trades"
[0m18:15:34.207274 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:15:34.252847 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: COMMIT
[0m18:15:34.258376 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:15:34.260059 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: COMMIT
[0m18:15:34.263112 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m18:15:34.280824 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."int_hourly_trades__dbt_backup"
[0m18:15:34.291794 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:15:34.293509 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */
drop table if exists "company_dw"."analytics"."int_hourly_trades__dbt_backup" cascade
[0m18:15:34.299079 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m18:15:34.306514 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: Close
[0m18:15:34.310781 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4176d5b5-b70e-4d36-8bd9-05242e6791cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c93c2310>]}
[0m18:15:34.313417 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.int_hourly_trades .................. [[32mSELECT 555[0m in 0.28s]
[0m18:15:34.315488 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.int_hourly_trades
[0m18:15:34.320875 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:34.323121 [debug] [MainThread]: On master: BEGIN
[0m18:15:34.324916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:15:34.333533 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m18:15:34.334908 [debug] [MainThread]: On master: COMMIT
[0m18:15:34.336376 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:34.338828 [debug] [MainThread]: On master: COMMIT
[0m18:15:34.343799 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:15:34.345297 [debug] [MainThread]: On master: Close
[0m18:15:34.347705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:34.349785 [debug] [MainThread]: Connection 'model.dbt_btc_transform.int_hourly_trades' was properly closed.
[0m18:15:34.351986 [info ] [MainThread]: 
[0m18:15:34.353643 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m18:15:34.356241 [debug] [MainThread]: Command end result
[0m18:15:34.358229 [info ] [MainThread]: 
[0m18:15:34.360991 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:15:34.362855 [info ] [MainThread]: 
[0m18:15:34.364516 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:15:34.366796 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3639854, "process_user_time": 3.31523, "process_kernel_time": 0.180849, "process_mem_max_rss": "109444", "process_out_blocks": "38", "process_in_blocks": "0"}
[0m18:15:34.368561 [debug] [MainThread]: Command `dbt run` succeeded at 18:15:34.368341 after 1.37 seconds
[0m18:15:34.369996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cd161100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ca3d7ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c9f90490>]}
[0m18:15:34.372819 [debug] [MainThread]: Flushing usage events
[0m18:15:38.874702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02e8730d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02c4eb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02c4eb5b0>]}


============================== 18:15:38.883024 | d28069ef-d032-48f4-bf97-9d1189c54936 ==============================
[0m18:15:38.883024 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:15:38.884438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models int_hourly_trades', 'send_anonymous_usage_stats': 'True'}
[0m18:15:39.141680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd28069ef-d032-48f4-bf97-9d1189c54936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02e6a4430>]}
[0m18:15:39.234820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd28069ef-d032-48f4-bf97-9d1189c54936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02c6a8100>]}
[0m18:15:39.236178 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:15:39.267133 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:15:39.531498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:15:39.532324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:15:39.615105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd28069ef-d032-48f4-bf97-9d1189c54936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02b316130>]}
[0m18:15:39.648801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd28069ef-d032-48f4-bf97-9d1189c54936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02b6993a0>]}
[0m18:15:39.650474 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:15:39.652424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd28069ef-d032-48f4-bf97-9d1189c54936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02b68d220>]}
[0m18:15:39.657705 [info ] [MainThread]: 
[0m18:15:39.659750 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:15:39.666197 [debug] [MainThread]: Command end result
[0m18:15:39.669095 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.8732124, "process_user_time": 3.21534, "process_kernel_time": 0.195055, "process_mem_max_rss": "103828", "process_out_blocks": "11", "process_in_blocks": "0"}
[0m18:15:39.673659 [debug] [MainThread]: Command `dbt test` succeeded at 18:15:39.673394 after 0.88 seconds
[0m18:15:39.675298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02e8730d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02b68d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02b68d490>]}
[0m18:15:39.677057 [debug] [MainThread]: Flushing usage events
[0m18:16:18.912437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6300bcb100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62fe86b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62fe86b640>]}


============================== 18:16:18.920404 | e7c0eabe-b8e9-416e-8edc-42e2326a31c7 ==============================
[0m18:16:18.920404 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:16:18.921572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:16:19.147097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7c0eabe-b8e9-416e-8edc-42e2326a31c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62fe8923d0>]}
[0m18:16:19.219159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7c0eabe-b8e9-416e-8edc-42e2326a31c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f630115ddf0>]}
[0m18:16:19.220535 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:16:19.251786 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:16:19.510162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:16:19.510961 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:16:19.584113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7c0eabe-b8e9-416e-8edc-42e2326a31c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62fd896130>]}
[0m18:16:19.599793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7c0eabe-b8e9-416e-8edc-42e2326a31c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62fd8bc790>]}
[0m18:16:19.600982 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:16:19.601922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7c0eabe-b8e9-416e-8edc-42e2326a31c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62fd9d4100>]}
[0m18:16:19.604220 [info ] [MainThread]: 
[0m18:16:19.605331 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:16:19.607400 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m18:16:19.715646 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m18:16:19.716927 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m18:16:19.717932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:19.724339 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m18:16:19.726568 [debug] [ThreadPool]: On list_company_dw: Close
[0m18:16:19.734124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m18:16:19.751176 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:16:19.752825 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:16:19.753990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:19.759473 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:16:19.760497 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:16:19.761449 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:16:19.764979 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m18:16:19.767034 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:16:19.768146 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:16:19.775891 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:19.776817 [debug] [MainThread]: On master: BEGIN
[0m18:16:19.777637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:19.782630 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:16:19.783682 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:19.784820 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:16:19.792364 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m18:16:19.794198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7c0eabe-b8e9-416e-8edc-42e2326a31c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62fd8bcbe0>]}
[0m18:16:19.795166 [debug] [MainThread]: On master: ROLLBACK
[0m18:16:19.796220 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:19.797114 [debug] [MainThread]: On master: BEGIN
[0m18:16:19.798450 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:16:19.799205 [debug] [MainThread]: On master: COMMIT
[0m18:16:19.800035 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:19.800907 [debug] [MainThread]: On master: COMMIT
[0m18:16:19.801959 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:16:19.802838 [debug] [MainThread]: On master: Close
[0m18:16:19.804044 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:16:19.804940 [info ] [MainThread]: 
[0m18:16:19.814456 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:16:19.815683 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m18:16:19.816947 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m18:16:19.818017 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:16:19.830777 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:16:19.836110 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:16:19.891488 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:16:19.895655 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:16:19.896764 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m18:16:19.897768 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:16:19.903198 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m18:16:19.904232 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:16:19.905687 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    -- I hate just putting a distinct to deal with duplicates but doing this because there are dupes in the source data.
    -- I would rather investigate why this is happening at the source and fix there but need to work
    -- with what was given
    select distinct 
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote_asset_volume,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        open_time::date as open_date,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minutes from open_time) = 0
            and extract(second from open_time) = 0
                then true
            else false
        end as hour_start,

        case    
            when extract(minute from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as hour_end
            

    from source

)

select * from final
  );
  
[0m18:16:21.654707 [debug] [Thread-1  ]: SQL status: SELECT 999963 in 1.747 seconds
[0m18:16:21.664129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:16:21.665143 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt" rename to "stg_kaggle__btcusdt__dbt_backup"
[0m18:16:21.666756 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:16:21.671824 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:16:21.672996 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp" rename to "stg_kaggle__btcusdt"
[0m18:16:21.674490 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:16:21.702385 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m18:16:21.705178 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:16:21.706578 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m18:16:21.717486 [debug] [Thread-1  ]: SQL status: COMMIT in 0.010 seconds
[0m18:16:21.727400 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup"
[0m18:16:21.733433 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:16:21.734386 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
drop table if exists "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup" cascade
[0m18:16:21.750199 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.015 seconds
[0m18:16:21.753669 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m18:16:21.756030 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7c0eabe-b8e9-416e-8edc-42e2326a31c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62fd042310>]}
[0m18:16:21.757291 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.stg_kaggle__btcusdt ................ [[32mSELECT 999963[0m in 1.94s]
[0m18:16:21.758530 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:16:21.761628 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:21.762468 [debug] [MainThread]: On master: BEGIN
[0m18:16:21.763290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:16:21.768439 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:16:21.769363 [debug] [MainThread]: On master: COMMIT
[0m18:16:21.770235 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:21.771068 [debug] [MainThread]: On master: COMMIT
[0m18:16:21.772176 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:16:21.773025 [debug] [MainThread]: On master: Close
[0m18:16:21.774038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:21.774834 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m18:16:21.775804 [info ] [MainThread]: 
[0m18:16:21.776730 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m18:16:21.778145 [debug] [MainThread]: Command end result
[0m18:16:21.778897 [info ] [MainThread]: 
[0m18:16:21.780002 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:16:21.780883 [info ] [MainThread]: 
[0m18:16:21.781797 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:16:21.783379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9456878, "process_user_time": 3.028979, "process_kernel_time": 0.170746, "process_mem_max_rss": "109588", "process_out_blocks": "41", "process_in_blocks": "0"}
[0m18:16:21.784416 [debug] [MainThread]: Command `dbt run` succeeded at 18:16:21.784299 after 2.95 seconds
[0m18:16:21.785298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6300bcb100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62fe097ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62fd9d4490>]}
[0m18:16:21.786171 [debug] [MainThread]: Flushing usage events
[0m18:16:26.913603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21fa73130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21d6eb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21d6eb640>]}


============================== 18:16:26.920903 | 176db705-34a2-451f-95bd-9735d330e992 ==============================
[0m18:16:26.920903 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:16:26.922256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models int_hourly_trades', 'send_anonymous_usage_stats': 'True'}
[0m18:16:27.149401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '176db705-34a2-451f-95bd-9735d330e992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21d0ebdf0>]}
[0m18:16:27.222194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '176db705-34a2-451f-95bd-9735d330e992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21fffb040>]}
[0m18:16:27.223642 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:16:27.258826 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:16:27.519219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:16:27.520077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:16:27.592831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '176db705-34a2-451f-95bd-9735d330e992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21c516130>]}
[0m18:16:27.607269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '176db705-34a2-451f-95bd-9735d330e992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21c53c7c0>]}
[0m18:16:27.608379 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:16:27.609333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '176db705-34a2-451f-95bd-9735d330e992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21c8901f0>]}
[0m18:16:27.611587 [info ] [MainThread]: 
[0m18:16:27.612752 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:16:27.614327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m18:16:27.725473 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m18:16:27.727708 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m18:16:27.731214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:27.739679 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m18:16:27.742126 [debug] [ThreadPool]: On list_company_dw: Close
[0m18:16:27.750437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m18:16:27.761071 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:16:27.762041 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:16:27.762916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:27.767775 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:16:27.768789 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:16:27.769699 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:16:27.773312 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m18:16:27.775389 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:16:27.776573 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:16:27.784422 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:27.785386 [debug] [MainThread]: On master: BEGIN
[0m18:16:27.786260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:27.791024 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:16:27.791938 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:27.792976 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:16:27.800899 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:16:27.802791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '176db705-34a2-451f-95bd-9735d330e992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21c53cc10>]}
[0m18:16:27.803752 [debug] [MainThread]: On master: ROLLBACK
[0m18:16:27.804997 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:27.805767 [debug] [MainThread]: On master: BEGIN
[0m18:16:27.807131 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:16:27.807956 [debug] [MainThread]: On master: COMMIT
[0m18:16:27.808769 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:27.809565 [debug] [MainThread]: On master: COMMIT
[0m18:16:27.810664 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:16:27.811546 [debug] [MainThread]: On master: Close
[0m18:16:27.812677 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:16:27.813545 [info ] [MainThread]: 
[0m18:16:27.822760 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.int_hourly_trades
[0m18:16:27.823912 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.int_hourly_trades ....................... [RUN]
[0m18:16:27.824970 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.int_hourly_trades)
[0m18:16:27.825855 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.int_hourly_trades
[0m18:16:27.838157 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:16:27.842107 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.int_hourly_trades
[0m18:16:27.897826 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:16:27.900130 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:16:27.901000 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: BEGIN
[0m18:16:27.901874 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:16:27.907183 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m18:16:27.908340 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:16:27.909411 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */

  
    

  create  table "company_dw"."analytics"."int_hourly_trades__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."analytics"."stg_kaggle__btcusdt"

),


hourly as (

    select distinct
        open_date,

        case
            when hour_start is true
                then extract(minutes from open_time)
        end as open_hour,

        case
            when hour_start is true
                then open
        end as open_price,

        case
            when hour_end is true
                then close
        end as close_price

    from source
    where
        hour_start is true or hour_end is true

),


final as (

    select
        open_date,
        open_hour,
        open_price,
        close_price,       
        (close_price - open_price) * 1.0 / open_price as percent_gain

    from hourly

)

select * from final
  );
  
[0m18:16:28.090714 [debug] [Thread-1  ]: SQL status: SELECT 555 in 0.179 seconds
[0m18:16:28.099964 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:16:28.100912 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */
alter table "company_dw"."analytics"."int_hourly_trades" rename to "int_hourly_trades__dbt_backup"
[0m18:16:28.102392 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:16:28.107349 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:16:28.108349 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */
alter table "company_dw"."analytics"."int_hourly_trades__dbt_tmp" rename to "int_hourly_trades"
[0m18:16:28.109868 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:16:28.136960 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: COMMIT
[0m18:16:28.137963 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:16:28.138886 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: COMMIT
[0m18:16:28.141738 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m18:16:28.151582 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."int_hourly_trades__dbt_backup"
[0m18:16:28.158018 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:16:28.158983 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */
drop table if exists "company_dw"."analytics"."int_hourly_trades__dbt_backup" cascade
[0m18:16:28.161668 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m18:16:28.165023 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: Close
[0m18:16:28.168153 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '176db705-34a2-451f-95bd-9735d330e992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21bcc2340>]}
[0m18:16:28.169897 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.int_hourly_trades .................. [[32mSELECT 555[0m in 0.34s]
[0m18:16:28.171091 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.int_hourly_trades
[0m18:16:28.174339 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:28.175229 [debug] [MainThread]: On master: BEGIN
[0m18:16:28.176049 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:16:28.181139 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:16:28.182047 [debug] [MainThread]: On master: COMMIT
[0m18:16:28.182949 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:28.183945 [debug] [MainThread]: On master: COMMIT
[0m18:16:28.185003 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:16:28.185807 [debug] [MainThread]: On master: Close
[0m18:16:28.186774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:28.187561 [debug] [MainThread]: Connection 'model.dbt_btc_transform.int_hourly_trades' was properly closed.
[0m18:16:28.188378 [info ] [MainThread]: 
[0m18:16:28.189327 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m18:16:28.190700 [debug] [MainThread]: Command end result
[0m18:16:28.191509 [info ] [MainThread]: 
[0m18:16:28.192434 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:16:28.193382 [info ] [MainThread]: 
[0m18:16:28.194339 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:16:28.195808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3566209, "process_user_time": 3.141036, "process_kernel_time": 0.169429, "process_mem_max_rss": "109532", "process_out_blocks": "38", "process_in_blocks": "0"}
[0m18:16:28.196912 [debug] [MainThread]: Command `dbt run` succeeded at 18:16:28.196789 after 1.36 seconds
[0m18:16:28.197850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21fa73130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21d08ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21d0ebdf0>]}
[0m18:16:28.198649 [debug] [MainThread]: Flushing usage events
[0m18:16:32.912757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51319cb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f512f62b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f512f62b5b0>]}


============================== 18:16:32.921092 | 8c13a5b7-031c-4c77-b7a0-d496d0874238 ==============================
[0m18:16:32.921092 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:16:32.922632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models stg_kaggle__btcusdt', 'send_anonymous_usage_stats': 'True'}
[0m18:16:33.162123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c13a5b7-031c-4c77-b7a0-d496d0874238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5131597430>]}
[0m18:16:33.239333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c13a5b7-031c-4c77-b7a0-d496d0874238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f512f7e9100>]}
[0m18:16:33.240920 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:16:33.273989 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:16:33.542016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:16:33.542989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:16:33.657928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c13a5b7-031c-4c77-b7a0-d496d0874238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f512e696130>]}
[0m18:16:33.697844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c13a5b7-031c-4c77-b7a0-d496d0874238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f512e7d9430>]}
[0m18:16:33.699095 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:16:33.700190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c13a5b7-031c-4c77-b7a0-d496d0874238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f512e7cd160>]}
[0m18:16:33.704325 [info ] [MainThread]: 
[0m18:16:33.706060 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:16:33.714488 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analytics'
[0m18:16:33.851504 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:16:33.853281 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:16:33.854646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:33.860643 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m18:16:33.861576 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:16:33.862453 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:16:33.866423 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m18:16:33.868780 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:16:33.870409 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:16:33.880337 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:33.881581 [debug] [MainThread]: On master: BEGIN
[0m18:16:33.882567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:33.889332 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:16:33.892184 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:33.893575 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:16:33.903107 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m18:16:33.906055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c13a5b7-031c-4c77-b7a0-d496d0874238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f512e2b40a0>]}
[0m18:16:33.907637 [debug] [MainThread]: On master: ROLLBACK
[0m18:16:33.909565 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:33.910611 [debug] [MainThread]: On master: BEGIN
[0m18:16:33.912227 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:16:33.913380 [debug] [MainThread]: On master: COMMIT
[0m18:16:33.914615 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:33.915620 [debug] [MainThread]: On master: COMMIT
[0m18:16:33.917093 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:16:33.918355 [debug] [MainThread]: On master: Close
[0m18:16:33.920840 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:16:33.922709 [info ] [MainThread]: 
[0m18:16:33.936692 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:16:33.938326 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:16:33.939413 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:16:33.940753 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:16:33.942065 [info ] [Thread-1  ]: 1 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_end__True__False ... [RUN]
[0m18:16:33.943903 [info ] [Thread-2  ]: 2 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_start__True__False . [RUN]
[0m18:16:33.945843 [info ] [Thread-3  ]: 3 of 18 START test not_null_stg_kaggle__btcusdt_close .......................... [RUN]
[0m18:16:33.947915 [info ] [Thread-4  ]: 4 of 18 START test not_null_stg_kaggle__btcusdt_close_time ..................... [RUN]
[0m18:16:33.949805 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872)
[0m18:16:33.952044 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m18:16:33.954123 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb'
[0m18:16:33.956074 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a'
[0m18:16:33.957610 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:16:33.958937 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:16:33.960154 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:16:33.961392 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:16:33.996482 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:16:34.001791 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:16:34.015821 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:16:34.023447 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:16:34.026909 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:16:34.028207 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:16:34.041111 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:16:34.054100 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:16:34.056779 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:16:34.061154 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:16:34.066524 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:16:34.071418 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:16:34.074958 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:16:34.076193 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:16:34.077744 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:16:34.078673 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: BEGIN
[0m18:16:34.079722 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:16:34.080431 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: BEGIN
[0m18:16:34.081540 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: BEGIN
[0m18:16:34.082622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:16:34.083699 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: BEGIN
[0m18:16:34.084718 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:16:34.086729 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:16:34.089040 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:16:34.092660 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m18:16:34.093686 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:16:34.094952 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_end as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_end

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m18:16:34.096050 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m18:16:34.096769 [debug] [Thread-3  ]: SQL status: BEGIN in 0.010 seconds
[0m18:16:34.097576 [debug] [Thread-2  ]: SQL status: BEGIN in 0.013 seconds
[0m18:16:34.098813 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:16:34.100189 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:16:34.101821 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:16:34.103345 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is null



      
    ) dbt_internal_test
[0m18:16:34.104701 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close is null



      
    ) dbt_internal_test
[0m18:16:34.106019 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_start as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_start

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m18:16:34.172131 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.065 seconds
[0m18:16:34.184731 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: ROLLBACK
[0m18:16:34.186718 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.078 seconds
[0m18:16:34.189066 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: Close
[0m18:16:34.192598 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: ROLLBACK
[0m18:16:34.194864 [info ] [Thread-4  ]: 4 of 18 PASS not_null_stg_kaggle__btcusdt_close_time ........................... [[32mPASS[0m in 0.24s]
[0m18:16:34.196749 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.099 seconds
[0m18:16:34.197724 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: Close
[0m18:16:34.198835 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:16:34.202087 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: ROLLBACK
[0m18:16:34.204200 [info ] [Thread-3  ]: 3 of 18 PASS not_null_stg_kaggle__btcusdt_close ................................ [[32mPASS[0m in 0.25s]
[0m18:16:34.205383 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:16:34.206966 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: Close
[0m18:16:34.207982 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:16:34.209207 [info ] [Thread-4  ]: 5 of 18 START test not_null_stg_kaggle__btcusdt_high ........................... [RUN]
[0m18:16:34.210988 [info ] [Thread-1  ]: 1 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_end__True__False ......... [[32mPASS[0m in 0.26s]
[0m18:16:34.212894 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:16:34.214566 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m18:16:34.215963 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:16:34.217178 [info ] [Thread-3  ]: 6 of 18 START test not_null_stg_kaggle__btcusdt_hour_end ....................... [RUN]
[0m18:16:34.219456 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:16:34.220800 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:16:34.222406 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m18:16:34.229357 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:16:34.230526 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.122 seconds
[0m18:16:34.231375 [info ] [Thread-1  ]: 7 of 18 START test not_null_stg_kaggle__btcusdt_hour_start ..................... [RUN]
[0m18:16:34.232683 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:16:34.236453 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: ROLLBACK
[0m18:16:34.237876 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m18:16:34.238717 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:16:34.245632 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:16:34.247219 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:16:34.248069 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: Close
[0m18:16:34.253272 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:16:34.261350 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:16:34.263178 [info ] [Thread-2  ]: 2 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_start__True__False ....... [[32mPASS[0m in 0.31s]
[0m18:16:34.264491 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:16:34.267905 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:16:34.269214 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:16:34.275280 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:16:34.276520 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:16:34.277539 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:16:34.278821 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: BEGIN
[0m18:16:34.284048 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:16:34.285619 [info ] [Thread-2  ]: 8 of 18 START test not_null_stg_kaggle__btcusdt_low ............................ [RUN]
[0m18:16:34.286893 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:16:34.287964 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:16:34.289896 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m18:16:34.291264 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: BEGIN
[0m18:16:34.292246 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:16:34.294470 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:16:34.295743 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:16:34.296835 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: BEGIN
[0m18:16:34.303955 [debug] [Thread-4  ]: SQL status: BEGIN in 0.016 seconds
[0m18:16:34.305729 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:16:34.307215 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:16:34.308495 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:16:34.311123 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where high is null



      
    ) dbt_internal_test
[0m18:16:34.312242 [debug] [Thread-3  ]: SQL status: BEGIN in 0.016 seconds
[0m18:16:34.314228 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:16:34.316232 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:16:34.317335 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m18:16:34.324381 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:16:34.325986 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_end
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_end is null



      
    ) dbt_internal_test
[0m18:16:34.327240 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:16:34.330177 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_start
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_start is null



      
    ) dbt_internal_test
[0m18:16:34.331814 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:16:34.333762 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: BEGIN
[0m18:16:34.335789 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:16:34.347181 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m18:16:34.349251 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:16:34.351438 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where low is null



      
    ) dbt_internal_test
[0m18:16:34.377901 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.064 seconds
[0m18:16:34.383260 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: ROLLBACK
[0m18:16:34.386789 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: Close
[0m18:16:34.390989 [info ] [Thread-4  ]: 5 of 18 PASS not_null_stg_kaggle__btcusdt_high ................................. [[32mPASS[0m in 0.18s]
[0m18:16:34.394670 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:16:34.397582 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:16:34.400264 [info ] [Thread-4  ]: 9 of 18 START test not_null_stg_kaggle__btcusdt_number_of_trades ............... [RUN]
[0m18:16:34.403244 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m18:16:34.405360 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:16:34.418495 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:16:34.423375 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:16:34.434789 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:16:34.436498 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.107 seconds
[0m18:16:34.438118 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.105 seconds
[0m18:16:34.443581 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: ROLLBACK
[0m18:16:34.447077 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: ROLLBACK
[0m18:16:34.448570 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:16:34.450366 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: Close
[0m18:16:34.452407 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: Close
[0m18:16:34.453357 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: BEGIN
[0m18:16:34.455265 [info ] [Thread-3  ]: 6 of 18 PASS not_null_stg_kaggle__btcusdt_hour_end ............................. [[32mPASS[0m in 0.23s]
[0m18:16:34.457230 [info ] [Thread-1  ]: 7 of 18 PASS not_null_stg_kaggle__btcusdt_hour_start ........................... [[32mPASS[0m in 0.22s]
[0m18:16:34.458718 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:16:34.460312 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:16:34.461894 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:16:34.462763 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.109 seconds
[0m18:16:34.464722 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:16:34.466092 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:16:34.469578 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: ROLLBACK
[0m18:16:34.471120 [debug] [Thread-4  ]: SQL status: BEGIN in 0.013 seconds
[0m18:16:34.472055 [info ] [Thread-3  ]: 10 of 18 START test not_null_stg_kaggle__btcusdt_open .......................... [RUN]
[0m18:16:34.473387 [info ] [Thread-1  ]: 11 of 18 START test not_null_stg_kaggle__btcusdt_open_date ..................... [RUN]
[0m18:16:34.475717 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: Close
[0m18:16:34.476768 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:16:34.478379 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m18:16:34.479887 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m18:16:34.481820 [info ] [Thread-2  ]: 8 of 18 PASS not_null_stg_kaggle__btcusdt_low .................................. [[32mPASS[0m in 0.19s]
[0m18:16:34.483185 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select number_of_trades
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where number_of_trades is null



      
    ) dbt_internal_test
[0m18:16:34.484763 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:16:34.486611 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:16:34.488245 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:16:34.498980 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:16:34.507454 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:16:34.509085 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:16:34.512460 [info ] [Thread-2  ]: 12 of 18 START test not_null_stg_kaggle__btcusdt_open_time ..................... [RUN]
[0m18:16:34.513736 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:16:34.514885 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m18:16:34.515945 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:16:34.521373 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:16:34.522747 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:16:34.528076 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:16:34.537320 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:16:34.538621 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.049 seconds
[0m18:16:34.539883 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:16:34.542017 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:16:34.544517 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: ROLLBACK
[0m18:16:34.545980 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:16:34.546763 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: BEGIN
[0m18:16:34.548258 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: BEGIN
[0m18:16:34.550161 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: Close
[0m18:16:34.555043 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:16:34.556310 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:16:34.557480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:16:34.559062 [info ] [Thread-4  ]: 9 of 18 PASS not_null_stg_kaggle__btcusdt_number_of_trades ..................... [[32mPASS[0m in 0.16s]
[0m18:16:34.562075 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:16:34.563736 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:16:34.565010 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: BEGIN
[0m18:16:34.565977 [debug] [Thread-3  ]: SQL status: BEGIN in 0.010 seconds
[0m18:16:34.566748 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m18:16:34.567677 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:16:34.569000 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:16:34.570236 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:16:34.571404 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:16:34.572643 [info ] [Thread-4  ]: 13 of 18 START test not_null_stg_kaggle__btcusdt_quote_asset_volume ............ [RUN]
[0m18:16:34.574996 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open is null



      
    ) dbt_internal_test
[0m18:16:34.576776 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_date
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_date is null



      
    ) dbt_internal_test
[0m18:16:34.578338 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m18:16:34.579350 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m18:16:34.581692 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:16:34.583427 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:16:34.595386 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:16:34.596810 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is null



      
    ) dbt_internal_test
[0m18:16:34.599978 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:16:34.608280 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:16:34.613174 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:16:34.615213 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: BEGIN
[0m18:16:34.617000 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:16:34.625511 [debug] [Thread-4  ]: SQL status: BEGIN in 0.008 seconds
[0m18:16:34.627745 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:16:34.630007 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where quote_asset_volume is null



      
    ) dbt_internal_test
[0m18:16:34.642095 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.061 seconds
[0m18:16:34.647427 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: ROLLBACK
[0m18:16:34.649953 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: Close
[0m18:16:34.652736 [info ] [Thread-3  ]: 10 of 18 PASS not_null_stg_kaggle__btcusdt_open ................................ [[32mPASS[0m in 0.17s]
[0m18:16:34.658232 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:16:34.659990 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:16:34.661934 [info ] [Thread-3  ]: 14 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ... [RUN]
[0m18:16:34.663223 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.064 seconds
[0m18:16:34.664729 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m18:16:34.666357 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.085 seconds
[0m18:16:34.669669 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: ROLLBACK
[0m18:16:34.670969 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:16:34.673655 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: ROLLBACK
[0m18:16:34.675538 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: Close
[0m18:16:34.683730 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:16:34.685847 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: Close
[0m18:16:34.687138 [info ] [Thread-2  ]: 12 of 18 PASS not_null_stg_kaggle__btcusdt_open_time ........................... [[32mPASS[0m in 0.17s]
[0m18:16:34.689572 [info ] [Thread-1  ]: 11 of 18 PASS not_null_stg_kaggle__btcusdt_open_date ........................... [[32mPASS[0m in 0.21s]
[0m18:16:34.691203 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:16:34.692359 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:16:34.694277 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:16:34.699670 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:16:34.701229 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:16:34.702740 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:16:34.705283 [info ] [Thread-2  ]: 15 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume .. [RUN]
[0m18:16:34.706846 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:16:34.707749 [info ] [Thread-1  ]: 16 of 18 START test not_null_stg_kaggle__btcusdt_volume ........................ [RUN]
[0m18:16:34.709192 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m18:16:34.710376 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: BEGIN
[0m18:16:34.711741 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m18:16:34.712944 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:16:34.713721 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.082 seconds
[0m18:16:34.714700 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:16:34.715863 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:16:34.722572 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:16:34.725134 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: ROLLBACK
[0m18:16:34.733207 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:16:34.734837 [debug] [Thread-3  ]: SQL status: BEGIN in 0.020 seconds
[0m18:16:34.736125 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: Close
[0m18:16:34.737352 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:16:34.738688 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:16:34.739896 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:16:34.741050 [info ] [Thread-4  ]: 13 of 18 PASS not_null_stg_kaggle__btcusdt_quote_asset_volume .................. [[32mPASS[0m in 0.16s]
[0m18:16:34.747453 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:16:34.748867 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_base_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_base_asset_volume is null



      
    ) dbt_internal_test
[0m18:16:34.753343 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:16:34.755077 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:16:34.757854 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:16:34.759217 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:16:34.760847 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:16:34.761671 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: BEGIN
[0m18:16:34.762941 [info ] [Thread-4  ]: 17 of 18 START test unique_stg_kaggle__btcusdt_close_time ...................... [RUN]
[0m18:16:34.764124 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: BEGIN
[0m18:16:34.765271 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:16:34.766472 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m18:16:34.767904 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:16:34.770136 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:16:34.782776 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:16:34.783794 [debug] [Thread-2  ]: SQL status: BEGIN in 0.018 seconds
[0m18:16:34.784714 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m18:16:34.786626 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:16:34.787877 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:16:34.788940 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:16:34.789836 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_quote_asset_volume is null



      
    ) dbt_internal_test
[0m18:16:34.791133 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where volume is null



      
    ) dbt_internal_test
[0m18:16:34.796368 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:16:34.801954 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:16:34.805776 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.049 seconds
[0m18:16:34.806879 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: BEGIN
[0m18:16:34.810819 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: ROLLBACK
[0m18:16:34.812453 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:16:34.814949 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: Close
[0m18:16:34.817983 [info ] [Thread-3  ]: 14 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ......... [[32mPASS[0m in 0.15s]
[0m18:16:34.820335 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:16:34.822265 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:16:34.823667 [debug] [Thread-4  ]: SQL status: BEGIN in 0.011 seconds
[0m18:16:34.825166 [info ] [Thread-3  ]: 18 of 18 START test unique_stg_kaggle__btcusdt_open_time ....................... [RUN]
[0m18:16:34.827028 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:16:34.828776 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m18:16:34.830803 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    close_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is not null
group by close_time
having count(*) > 1



      
    ) dbt_internal_test
[0m18:16:34.832385 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:16:34.845421 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:16:34.849240 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:16:34.858075 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:16:34.862224 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:16:34.864337 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: BEGIN
[0m18:16:34.866059 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:16:34.867476 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.068 seconds
[0m18:16:34.872759 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: ROLLBACK
[0m18:16:34.874132 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.076 seconds
[0m18:16:34.876119 [debug] [Thread-3  ]: SQL status: BEGIN in 0.010 seconds
[0m18:16:34.877326 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: Close
[0m18:16:34.882107 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: ROLLBACK
[0m18:16:34.884023 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:16:34.886905 [info ] [Thread-1  ]: 16 of 18 PASS not_null_stg_kaggle__btcusdt_volume .............................. [[32mPASS[0m in 0.17s]
[0m18:16:34.889339 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: Close
[0m18:16:34.891000 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    open_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is not null
group by open_time
having count(*) > 1



      
    ) dbt_internal_test
[0m18:16:34.893151 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:16:34.895569 [info ] [Thread-2  ]: 15 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume ........ [[32mPASS[0m in 0.19s]
[0m18:16:34.898996 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:16:35.926455 [debug] [Thread-4  ]: SQL status: SELECT 1 in 1.092 seconds
[0m18:16:35.929192 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: ROLLBACK
[0m18:16:35.930667 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: Close
[0m18:16:35.932077 [info ] [Thread-4  ]: 17 of 18 PASS unique_stg_kaggle__btcusdt_close_time ............................ [[32mPASS[0m in 1.17s]
[0m18:16:35.933568 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:16:35.951304 [debug] [Thread-3  ]: SQL status: SELECT 1 in 1.054 seconds
[0m18:16:35.953916 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: ROLLBACK
[0m18:16:35.955178 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: Close
[0m18:16:35.956488 [info ] [Thread-3  ]: 18 of 18 PASS unique_stg_kaggle__btcusdt_open_time ............................. [[32mPASS[0m in 1.13s]
[0m18:16:35.957885 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:16:35.960661 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:35.961480 [debug] [MainThread]: On master: BEGIN
[0m18:16:35.962353 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:16:35.967151 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:16:35.968101 [debug] [MainThread]: On master: COMMIT
[0m18:16:35.968898 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:35.969886 [debug] [MainThread]: On master: COMMIT
[0m18:16:35.970925 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:16:35.971763 [debug] [MainThread]: On master: Close
[0m18:16:35.972769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:35.973558 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae' was properly closed.
[0m18:16:35.974431 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42' was properly closed.
[0m18:16:35.975295 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa' was properly closed.
[0m18:16:35.976173 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb' was properly closed.
[0m18:16:35.977203 [info ] [MainThread]: 
[0m18:16:35.978286 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m18:16:35.983155 [debug] [MainThread]: Command end result
[0m18:16:35.984000 [info ] [MainThread]: 
[0m18:16:35.984935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:16:35.985808 [info ] [MainThread]: 
[0m18:16:35.986696 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m18:16:35.988099 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.148955, "process_user_time": 3.655433, "process_kernel_time": 0.244866, "process_mem_max_rss": "114360", "process_out_blocks": "141", "process_in_blocks": "0"}
[0m18:16:35.989167 [debug] [MainThread]: Command `dbt test` succeeded at 18:16:35.989042 after 3.15 seconds
[0m18:16:35.990174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51319cb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f512e7d9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f512f7e9100>]}
[0m18:16:35.991150 [debug] [MainThread]: Flushing usage events
[0m18:16:41.159711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb237eb80d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb235b19610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb235b195b0>]}


============================== 18:16:41.167182 | 0ae007e7-cd7c-40a7-bcef-47e131b9fad1 ==============================
[0m18:16:41.167182 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:16:41.168374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models int_hourly_trades', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:16:41.397417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ae007e7-cd7c-40a7-bcef-47e131b9fad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb237a92430>]}
[0m18:16:41.471402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ae007e7-cd7c-40a7-bcef-47e131b9fad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb235cd7100>]}
[0m18:16:41.472989 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:16:41.505349 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:16:41.767470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:16:41.768365 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:16:41.841505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ae007e7-cd7c-40a7-bcef-47e131b9fad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb234916130>]}
[0m18:16:41.867375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ae007e7-cd7c-40a7-bcef-47e131b9fad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb234c99430>]}
[0m18:16:41.868799 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:16:41.869881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ae007e7-cd7c-40a7-bcef-47e131b9fad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb234c8d160>]}
[0m18:16:41.874050 [info ] [MainThread]: 
[0m18:16:41.875203 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:16:41.878834 [debug] [MainThread]: Command end result
[0m18:16:41.880361 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7935524, "process_user_time": 2.76264, "process_kernel_time": 0.140353, "process_mem_max_rss": "103844", "process_out_blocks": "11", "process_in_blocks": "0"}
[0m18:16:41.881613 [debug] [MainThread]: Command `dbt test` succeeded at 18:16:41.881423 after 0.79 seconds
[0m18:16:41.882619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb237eb80d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb234522fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb235cd7100>]}
[0m18:16:41.883548 [debug] [MainThread]: Flushing usage events
[0m18:16:47.180176 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:16:51.228970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c4990040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c2619820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c26197c0>]}


============================== 18:16:51.237317 | 76479799-b57f-46b2-8534-a1a83d523e20 ==============================
[0m18:16:51.237317 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:16:51.238537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:16:51.465236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76479799-b57f-46b2-8534-a1a83d523e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c264ff40>]}
[0m18:16:51.539525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76479799-b57f-46b2-8534-a1a83d523e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c1fb9400>]}
[0m18:16:51.540950 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:16:51.573031 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:16:51.749470 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:16:51.750717 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25
[0m18:16:51.751613 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:16:51.752541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '76479799-b57f-46b2-8534-a1a83d523e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c39c4a90>]}
[0m18:16:53.980379 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:16:53.981536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '76479799-b57f-46b2-8534-a1a83d523e20', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c12d0640>]}
[0m18:16:54.396598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76479799-b57f-46b2-8534-a1a83d523e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c1b82e20>]}
[0m18:16:54.413608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76479799-b57f-46b2-8534-a1a83d523e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c17d18e0>]}
[0m18:16:54.414694 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:16:54.415633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76479799-b57f-46b2-8534-a1a83d523e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c17d1460>]}
[0m18:16:54.418484 [info ] [MainThread]: 
[0m18:16:54.419670 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:16:54.427472 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m18:16:54.472104 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:16:54.473509 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m18:16:54.474367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:54.479798 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:16:54.480744 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:16:54.481631 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:16:54.485070 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m18:16:54.486932 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m18:16:54.488071 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m18:16:54.496005 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:54.496886 [debug] [MainThread]: On master: BEGIN
[0m18:16:54.497674 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:54.502664 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:16:54.503521 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:54.504683 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:16:54.512865 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:16:54.514765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76479799-b57f-46b2-8534-a1a83d523e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c17d13a0>]}
[0m18:16:54.515734 [debug] [MainThread]: On master: ROLLBACK
[0m18:16:54.516805 [debug] [MainThread]: On master: Close
[0m18:16:54.517991 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:16:54.518908 [info ] [MainThread]: 
[0m18:16:54.528097 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:16:54.529449 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m18:16:54.530409 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:16:54.543289 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:16:54.548286 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:16:54.550040 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:16:54.553404 [debug] [Thread-3  ]: Began running node model.dbt_btc_transform.int_hourly_trades
[0m18:16:54.554284 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:16:54.555068 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:16:54.555848 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:16:54.556910 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_btc_transform.int_hourly_trades'
[0m18:16:54.558523 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872'
[0m18:16:54.559905 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m18:16:54.561034 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_btc_transform.stg_kaggle__btcusdt, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb)
[0m18:16:54.562121 [debug] [Thread-3  ]: Began compiling node model.dbt_btc_transform.int_hourly_trades
[0m18:16:54.563372 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:16:54.564533 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:16:54.565661 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:16:54.571118 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:16:54.578342 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:16:54.585148 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:16:54.598995 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:16:54.601567 [debug] [Thread-3  ]: Began executing node model.dbt_btc_transform.int_hourly_trades
[0m18:16:54.603162 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:16:54.604396 [debug] [Thread-3  ]: Finished running node model.dbt_btc_transform.int_hourly_trades
[0m18:16:54.605138 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:16:54.606636 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:16:54.607324 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:16:54.608336 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:16:54.609810 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:16:54.610825 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:16:54.612424 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:16:54.613566 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_btc_transform.int_hourly_trades, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a)
[0m18:16:54.614666 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:16:54.615710 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m18:16:54.616777 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:16:54.617857 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:16:54.619001 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m18:16:54.619992 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:16:54.620972 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m18:16:54.627196 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:16:54.628326 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:16:54.635547 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:16:54.636456 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:16:54.644051 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:16:54.645659 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:16:54.651578 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:16:54.652865 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:16:54.654210 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:16:54.655542 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:16:54.657105 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:16:54.658196 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:16:54.658949 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:16:54.660323 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:16:54.661415 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:16:54.662574 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m18:16:54.664213 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:16:54.665542 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:16:54.666694 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m18:16:54.667711 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:16:54.668768 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:16:54.669809 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m18:16:54.671001 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:16:54.677140 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:16:54.678331 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m18:16:54.679401 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:16:54.685216 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:16:54.686870 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:16:54.693264 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:16:54.694200 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:16:54.702800 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:16:54.704019 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:16:54.705376 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:16:54.706846 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:16:54.708151 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:16:54.709344 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:16:54.710221 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:16:54.711313 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:16:54.712442 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:16:54.713616 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m18:16:54.715090 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:16:54.716262 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:16:54.717448 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m18:16:54.718579 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:16:54.719727 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:16:54.720771 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m18:16:54.721773 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:16:54.727968 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:16:54.729328 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m18:16:54.730405 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:16:54.736550 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:16:54.738116 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:16:54.744330 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:16:54.745217 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:16:54.751713 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:16:54.753119 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:16:54.754756 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:16:54.755830 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:16:54.757499 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:16:54.758771 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:16:54.759732 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:16:54.761015 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:16:54.762090 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:16:54.763174 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m18:16:54.764785 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:16:54.765833 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:16:54.766929 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m18:16:54.767951 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:16:54.769419 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m18:16:54.770549 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:16:54.776793 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:16:54.777795 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:16:54.788483 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:16:54.795314 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:16:54.796869 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:16:54.798499 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:16:54.799448 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:16:54.800593 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:16:54.802177 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:16:54.803472 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:16:54.806756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:54.807571 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42' was properly closed.
[0m18:16:54.808308 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae' was properly closed.
[0m18:16:54.809055 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb' was properly closed.
[0m18:16:54.809741 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa' was properly closed.
[0m18:16:54.814576 [debug] [MainThread]: Command end result
[0m18:16:55.019194 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:16:55.020183 [info ] [MainThread]: Building catalog
[0m18:16:55.040670 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m18:16:55.054204 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m18:16:55.055347 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m18:16:55.056655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:55.062114 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:16:55.063269 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m18:16:55.064595 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('btcusdt')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_kaggle__btcusdt')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('int_hourly_trades')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:16:55.069305 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m18:16:55.077436 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m18:16:55.078912 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m18:16:55.191782 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m18:16:55.193780 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.042914, "process_user_time": 5.79427, "process_kernel_time": 0.179309, "process_mem_max_rss": "191612", "process_out_blocks": "6559", "process_in_blocks": "0"}
[0m18:16:55.195150 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:16:55.195001 after 4.04 seconds
[0m18:16:55.196289 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:16:55.198038 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m18:16:55.199760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c4990040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c1f1a340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c4f249d0>]}
[0m18:16:55.200834 [debug] [MainThread]: Flushing usage events
[0m18:19:41.388479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842e6a20a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842c319640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842c3195e0>]}


============================== 18:19:41.397748 | 12d81db5-a605-4ac6-8a24-a6bffadac998 ==============================
[0m18:19:41.397748 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:19:41.399407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:19:41.622226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12d81db5-a605-4ac6-8a24-a6bffadac998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842c388160>]}
[0m18:19:41.692679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12d81db5-a605-4ac6-8a24-a6bffadac998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842c348a60>]}
[0m18:19:41.694166 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:19:41.725405 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:19:41.891924 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:19:41.893056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '12d81db5-a605-4ac6-8a24-a6bffadac998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842d651c70>]}
[0m18:19:43.942340 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:19:43.943529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '12d81db5-a605-4ac6-8a24-a6bffadac998', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842ad12400>]}
[0m18:19:44.346828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12d81db5-a605-4ac6-8a24-a6bffadac998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842b4f75b0>]}
[0m18:19:44.361593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12d81db5-a605-4ac6-8a24-a6bffadac998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842b0bd790>]}
[0m18:19:44.362813 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:19:44.363839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12d81db5-a605-4ac6-8a24-a6bffadac998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842b4f75e0>]}
[0m18:19:44.366085 [info ] [MainThread]: 
[0m18:19:44.367220 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:19:44.368853 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m18:19:44.416075 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m18:19:44.417053 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m18:19:44.417846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:44.423873 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m18:19:44.425907 [debug] [ThreadPool]: On list_company_dw: Close
[0m18:19:44.432445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m18:19:44.441145 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:19:44.442024 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:19:44.442859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:44.448062 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:19:44.448948 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:19:44.449885 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:19:44.453481 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m18:19:44.455408 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:19:44.456486 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:19:44.463896 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:44.464860 [debug] [MainThread]: On master: BEGIN
[0m18:19:44.465737 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:44.470855 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:19:44.471791 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:44.472895 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:19:44.480661 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:19:44.482563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12d81db5-a605-4ac6-8a24-a6bffadac998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842b1ace20>]}
[0m18:19:44.483508 [debug] [MainThread]: On master: ROLLBACK
[0m18:19:44.484678 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:44.485616 [debug] [MainThread]: On master: BEGIN
[0m18:19:44.487004 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:19:44.487825 [debug] [MainThread]: On master: COMMIT
[0m18:19:44.488714 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:44.489538 [debug] [MainThread]: On master: COMMIT
[0m18:19:44.490688 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:19:44.491538 [debug] [MainThread]: On master: Close
[0m18:19:44.492545 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:19:44.493473 [info ] [MainThread]: 
[0m18:19:44.502357 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:19:44.503694 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m18:19:44.504811 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m18:19:44.505862 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:19:44.519871 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:19:44.524219 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:19:44.579472 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:19:44.583661 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:19:44.584713 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m18:19:44.585690 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:19:44.590849 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m18:19:44.591896 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:19:44.593282 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    -- I hate just putting a distinct to deal with duplicates but doing this because there are dupes in the source data.
    -- I would rather investigate why this is happening at the source and fix there but need to work
    -- with what was given
    select distinct 
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote_asset_volume,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        open_time::date as open_date,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minutes from open_time) = 0
            and extract(second from open_time) = 0
                then true
            else false
        end as hour_start,

        case    
            when extract(minute from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as hour_end
            

    from source

)

select * from final
  );
  
[0m18:19:46.223467 [debug] [Thread-1  ]: SQL status: SELECT 999963 in 1.629 seconds
[0m18:19:46.232695 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:19:46.233654 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt" rename to "stg_kaggle__btcusdt__dbt_backup"
[0m18:19:46.235234 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:19:46.239951 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:19:46.240923 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp" rename to "stg_kaggle__btcusdt"
[0m18:19:46.242394 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:19:46.270143 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m18:19:46.271168 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:19:46.272095 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m18:19:46.280080 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m18:19:46.290759 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup"
[0m18:19:46.296740 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:19:46.297692 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
drop table if exists "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup" cascade
[0m18:19:46.312374 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.014 seconds
[0m18:19:46.315901 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m18:19:46.318344 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12d81db5-a605-4ac6-8a24-a6bffadac998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842a86ceb0>]}
[0m18:19:46.319663 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.stg_kaggle__btcusdt ................ [[32mSELECT 999963[0m in 1.81s]
[0m18:19:46.320946 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:19:46.324257 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:46.325090 [debug] [MainThread]: On master: BEGIN
[0m18:19:46.325881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:46.330801 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:19:46.332015 [debug] [MainThread]: On master: COMMIT
[0m18:19:46.332823 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:46.333645 [debug] [MainThread]: On master: COMMIT
[0m18:19:46.334693 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:19:46.335558 [debug] [MainThread]: On master: Close
[0m18:19:46.336537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:46.337318 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m18:19:46.338145 [info ] [MainThread]: 
[0m18:19:46.339040 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m18:19:46.340476 [debug] [MainThread]: Command end result
[0m18:19:46.341260 [info ] [MainThread]: 
[0m18:19:46.342217 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:19:46.343035 [info ] [MainThread]: 
[0m18:19:46.343915 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:19:46.345465 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.026483, "process_user_time": 5.325069, "process_kernel_time": 0.160722, "process_mem_max_rss": "115056", "process_out_blocks": "1190", "process_in_blocks": "0"}
[0m18:19:46.346541 [debug] [MainThread]: Command `dbt run` succeeded at 18:19:46.346425 after 5.03 seconds
[0m18:19:46.347401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842e6a20a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842b0bd430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842b0bd640>]}
[0m18:19:46.348273 [debug] [MainThread]: Flushing usage events
[0m18:19:51.274915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd623cee0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd621959610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6219595b0>]}


============================== 18:19:51.282446 | 0019f996-79f3-4140-b2bc-4c32f09d82c8 ==============================
[0m18:19:51.282446 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:19:51.283628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models stg_kaggle__btcusdt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:19:51.513031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0019f996-79f3-4140-b2bc-4c32f09d82c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd623898430>]}
[0m18:19:51.589399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0019f996-79f3-4140-b2bc-4c32f09d82c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd621b17100>]}
[0m18:19:51.590862 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:19:51.622035 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:19:51.882317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:19:51.883255 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:19:51.957054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0019f996-79f3-4140-b2bc-4c32f09d82c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd620796130>]}
[0m18:19:51.984571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0019f996-79f3-4140-b2bc-4c32f09d82c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd620b193a0>]}
[0m18:19:51.985686 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:19:51.986617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0019f996-79f3-4140-b2bc-4c32f09d82c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd620b0d220>]}
[0m18:19:51.990013 [info ] [MainThread]: 
[0m18:19:51.991249 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:19:51.999166 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analytics'
[0m18:19:52.114740 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:19:52.115822 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:19:52.116765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:52.122235 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:19:52.123270 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:19:52.124272 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:19:52.128039 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m18:19:52.130172 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:19:52.131356 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:19:52.139070 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:52.140064 [debug] [MainThread]: On master: BEGIN
[0m18:19:52.140911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:52.145770 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:19:52.146775 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:52.148035 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:19:52.157074 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m18:19:52.159053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0019f996-79f3-4140-b2bc-4c32f09d82c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6203b40a0>]}
[0m18:19:52.160190 [debug] [MainThread]: On master: ROLLBACK
[0m18:19:52.161363 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:52.162222 [debug] [MainThread]: On master: BEGIN
[0m18:19:52.163693 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:19:52.164615 [debug] [MainThread]: On master: COMMIT
[0m18:19:52.165555 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:52.166428 [debug] [MainThread]: On master: COMMIT
[0m18:19:52.167875 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:19:52.169088 [debug] [MainThread]: On master: Close
[0m18:19:52.170377 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:19:52.171777 [info ] [MainThread]: 
[0m18:19:52.185298 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:19:52.186311 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:19:52.187192 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:19:52.188261 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:19:52.189259 [info ] [Thread-1  ]: 1 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_end__True__False ... [RUN]
[0m18:19:52.190749 [info ] [Thread-2  ]: 2 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_start__True__False . [RUN]
[0m18:19:52.192330 [info ] [Thread-3  ]: 3 of 18 START test not_null_stg_kaggle__btcusdt_close .......................... [RUN]
[0m18:19:52.194172 [info ] [Thread-4  ]: 4 of 18 START test not_null_stg_kaggle__btcusdt_close_time ..................... [RUN]
[0m18:19:52.196290 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872)
[0m18:19:52.198218 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m18:19:52.199881 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb'
[0m18:19:52.201368 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a'
[0m18:19:52.202568 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:19:52.203855 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:19:52.205173 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:19:52.206331 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:19:52.238698 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:19:52.242714 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:19:52.255918 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:19:52.262316 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:19:52.265715 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:19:52.267473 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:19:52.274366 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:19:52.292837 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:19:52.297352 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:19:52.298149 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:19:52.303819 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:19:52.310789 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:19:52.311659 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:19:52.313368 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:19:52.315182 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: BEGIN
[0m18:19:52.316133 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:19:52.317519 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: BEGIN
[0m18:19:52.318656 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:19:52.319813 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:19:52.321135 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: BEGIN
[0m18:19:52.322378 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:19:52.323590 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: BEGIN
[0m18:19:52.325534 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:19:52.327899 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:19:52.330061 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m18:19:52.332593 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m18:19:52.333622 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:19:52.335187 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:19:52.336138 [debug] [Thread-3  ]: SQL status: BEGIN in 0.011 seconds
[0m18:19:52.336947 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m18:19:52.338119 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_end as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_end

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m18:19:52.339343 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_start as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_start

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m18:19:52.340572 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:19:52.341735 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:19:52.344221 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close is null



      
    ) dbt_internal_test
[0m18:19:52.345808 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is null



      
    ) dbt_internal_test
[0m18:19:52.488755 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.139 seconds
[0m18:19:52.489755 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.141 seconds
[0m18:19:52.490718 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.148 seconds
[0m18:19:52.491726 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.148 seconds
[0m18:19:52.498269 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: ROLLBACK
[0m18:19:52.501044 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: ROLLBACK
[0m18:19:52.505132 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: ROLLBACK
[0m18:19:52.511214 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: ROLLBACK
[0m18:19:52.514245 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: Close
[0m18:19:52.519018 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: Close
[0m18:19:52.524799 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: Close
[0m18:19:52.546402 [info ] [Thread-1  ]: 1 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_end__True__False ......... [[32mPASS[0m in 0.35s]
[0m18:19:52.535600 [info ] [Thread-4  ]: 4 of 18 PASS not_null_stg_kaggle__btcusdt_close_time ........................... [[32mPASS[0m in 0.33s]
[0m18:19:52.557674 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:19:52.529238 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: Close
[0m18:19:52.566521 [info ] [Thread-2  ]: 2 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_start__True__False ....... [[32mPASS[0m in 0.37s]
[0m18:19:52.541790 [info ] [Thread-3  ]: 3 of 18 PASS not_null_stg_kaggle__btcusdt_close ................................ [[32mPASS[0m in 0.34s]
[0m18:19:52.562094 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:19:52.553204 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:19:52.578170 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:19:52.571986 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:19:52.575455 [info ] [Thread-4  ]: 5 of 18 START test not_null_stg_kaggle__btcusdt_high ........................... [RUN]
[0m18:19:52.569223 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:19:52.590575 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:19:52.583733 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:19:52.587937 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m18:19:52.581187 [info ] [Thread-1  ]: 6 of 18 START test not_null_stg_kaggle__btcusdt_hour_end ....................... [RUN]
[0m18:19:52.599886 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m18:19:52.595448 [info ] [Thread-3  ]: 7 of 18 START test not_null_stg_kaggle__btcusdt_hour_start ..................... [RUN]
[0m18:19:52.597744 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:19:52.592925 [info ] [Thread-2  ]: 8 of 18 START test not_null_stg_kaggle__btcusdt_low ............................ [RUN]
[0m18:19:52.601924 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:19:52.604235 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m18:19:52.613393 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:19:52.614636 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m18:19:52.622314 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:19:52.623559 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:19:52.625601 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:19:52.627688 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:19:52.638690 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:19:52.652528 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:19:52.651984 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:19:52.660308 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:19:52.667438 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:19:52.668947 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:19:52.671241 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:19:52.677478 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:19:52.679100 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:19:52.685698 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:19:52.687260 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:19:52.688494 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: BEGIN
[0m18:19:52.689974 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:19:52.691695 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: BEGIN
[0m18:19:52.693229 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:19:52.694862 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:19:52.696225 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: BEGIN
[0m18:19:52.697664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:19:52.699915 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: BEGIN
[0m18:19:52.701415 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:19:52.703926 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:19:52.705200 [debug] [Thread-4  ]: SQL status: BEGIN in 0.012 seconds
[0m18:19:52.709254 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:19:52.710247 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m18:19:52.711714 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where high is null



      
    ) dbt_internal_test
[0m18:19:52.712985 [debug] [Thread-3  ]: SQL status: BEGIN in 0.012 seconds
[0m18:19:52.714443 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:19:52.715402 [debug] [Thread-2  ]: SQL status: BEGIN in 0.012 seconds
[0m18:19:52.716943 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:19:52.718445 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_end
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_end is null



      
    ) dbt_internal_test
[0m18:19:52.719969 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:19:52.721368 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_start
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_start is null



      
    ) dbt_internal_test
[0m18:19:52.723934 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where low is null



      
    ) dbt_internal_test
[0m18:19:52.786860 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.070 seconds
[0m18:19:52.792538 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: ROLLBACK
[0m18:19:52.796825 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: Close
[0m18:19:52.799603 [info ] [Thread-4  ]: 5 of 18 PASS not_null_stg_kaggle__btcusdt_high ................................. [[32mPASS[0m in 0.21s]
[0m18:19:52.803427 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:19:52.805552 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:19:52.807510 [info ] [Thread-4  ]: 9 of 18 START test not_null_stg_kaggle__btcusdt_number_of_trades ............... [RUN]
[0m18:19:52.809748 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m18:19:52.811757 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:19:52.825267 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:19:52.829356 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:19:52.835834 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:19:52.836808 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.114 seconds
[0m18:19:52.837637 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.111 seconds
[0m18:19:52.838513 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.113 seconds
[0m18:19:52.842217 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: ROLLBACK
[0m18:19:52.845239 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: ROLLBACK
[0m18:19:52.846224 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:19:52.849067 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: ROLLBACK
[0m18:19:52.851405 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: Close
[0m18:19:52.852846 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: Close
[0m18:19:52.853808 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: BEGIN
[0m18:19:52.855392 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: Close
[0m18:19:52.856627 [info ] [Thread-1  ]: 6 of 18 PASS not_null_stg_kaggle__btcusdt_hour_end ............................. [[32mPASS[0m in 0.26s]
[0m18:19:52.858310 [info ] [Thread-2  ]: 8 of 18 PASS not_null_stg_kaggle__btcusdt_low .................................. [[32mPASS[0m in 0.24s]
[0m18:19:52.859571 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:19:52.861171 [info ] [Thread-3  ]: 7 of 18 PASS not_null_stg_kaggle__btcusdt_hour_start ........................... [[32mPASS[0m in 0.26s]
[0m18:19:52.863224 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:19:52.864763 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:19:52.867154 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:19:52.868551 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:19:52.870072 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:19:52.871227 [debug] [Thread-4  ]: SQL status: BEGIN in 0.012 seconds
[0m18:19:52.872320 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:19:52.873677 [info ] [Thread-1  ]: 10 of 18 START test not_null_stg_kaggle__btcusdt_open .......................... [RUN]
[0m18:19:52.875153 [info ] [Thread-2  ]: 11 of 18 START test not_null_stg_kaggle__btcusdt_open_date ..................... [RUN]
[0m18:19:52.876444 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:19:52.877533 [info ] [Thread-3  ]: 12 of 18 START test not_null_stg_kaggle__btcusdt_open_time ..................... [RUN]
[0m18:19:52.879091 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m18:19:52.880367 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m18:19:52.881611 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select number_of_trades
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where number_of_trades is null



      
    ) dbt_internal_test
[0m18:19:52.882808 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m18:19:52.884098 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:19:52.885265 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:19:52.887155 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:19:52.897202 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:19:52.907315 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:19:52.915239 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:19:52.918707 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:19:52.924604 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:19:52.925750 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:19:52.927633 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:19:52.935613 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:19:52.937417 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:19:52.944470 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.058 seconds
[0m18:19:52.945998 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:19:52.948252 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: BEGIN
[0m18:19:52.951061 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: ROLLBACK
[0m18:19:52.952182 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:19:52.953783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:19:52.955286 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:19:52.956680 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: Close
[0m18:19:52.957560 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: BEGIN
[0m18:19:52.959819 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: BEGIN
[0m18:19:52.961744 [info ] [Thread-4  ]: 9 of 18 PASS not_null_stg_kaggle__btcusdt_number_of_trades ..................... [[32mPASS[0m in 0.15s]
[0m18:19:52.963219 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:19:52.964188 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m18:19:52.965138 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:19:52.966557 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:19:52.968657 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:19:52.971122 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:19:52.973161 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open is null



      
    ) dbt_internal_test
[0m18:19:52.974906 [debug] [Thread-2  ]: SQL status: BEGIN in 0.012 seconds
[0m18:19:52.976175 [debug] [Thread-3  ]: SQL status: BEGIN in 0.011 seconds
[0m18:19:52.977149 [info ] [Thread-4  ]: 13 of 18 START test not_null_stg_kaggle__btcusdt_quote_asset_volume ............ [RUN]
[0m18:19:52.979148 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:19:52.981308 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:19:52.982915 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m18:19:52.984730 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_date
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_date is null



      
    ) dbt_internal_test
[0m18:19:52.986473 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is null



      
    ) dbt_internal_test
[0m18:19:52.988327 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:19:53.004684 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:19:53.011952 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:19:53.021502 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:19:53.026149 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:19:53.028341 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: BEGIN
[0m18:19:53.030332 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:19:53.038740 [debug] [Thread-4  ]: SQL status: BEGIN in 0.008 seconds
[0m18:19:53.043807 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:19:53.048633 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where quote_asset_volume is null



      
    ) dbt_internal_test
[0m18:19:53.053691 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.075 seconds
[0m18:19:53.058898 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: ROLLBACK
[0m18:19:53.061409 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: Close
[0m18:19:53.064986 [info ] [Thread-1  ]: 10 of 18 PASS not_null_stg_kaggle__btcusdt_open ................................ [[32mPASS[0m in 0.19s]
[0m18:19:53.066611 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.076 seconds
[0m18:19:53.068530 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:19:53.072221 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: ROLLBACK
[0m18:19:53.074622 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:19:53.077401 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: Close
[0m18:19:53.078894 [info ] [Thread-1  ]: 14 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ... [RUN]
[0m18:19:53.082038 [info ] [Thread-3  ]: 12 of 18 PASS not_null_stg_kaggle__btcusdt_open_time ........................... [[32mPASS[0m in 0.20s]
[0m18:19:53.085599 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m18:19:53.088923 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:19:53.090380 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.100 seconds
[0m18:19:53.091870 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:19:53.093451 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:19:53.096796 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: ROLLBACK
[0m18:19:53.104530 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:19:53.105722 [info ] [Thread-3  ]: 15 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume .. [RUN]
[0m18:19:53.107409 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: Close
[0m18:19:53.109261 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m18:19:53.112769 [info ] [Thread-2  ]: 11 of 18 PASS not_null_stg_kaggle__btcusdt_open_date ........................... [[32mPASS[0m in 0.23s]
[0m18:19:53.114240 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:19:53.115132 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:19:53.116636 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:19:53.122044 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:19:53.129584 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:19:53.130851 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:19:53.132125 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.081 seconds
[0m18:19:53.134567 [info ] [Thread-2  ]: 16 of 18 START test not_null_stg_kaggle__btcusdt_volume ........................ [RUN]
[0m18:19:53.135823 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:19:53.138498 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: ROLLBACK
[0m18:19:53.139587 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:19:53.140412 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m18:19:53.141574 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: BEGIN
[0m18:19:53.143094 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: Close
[0m18:19:53.148763 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:19:53.149901 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:19:53.151334 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:19:53.152938 [info ] [Thread-4  ]: 13 of 18 PASS not_null_stg_kaggle__btcusdt_quote_asset_volume .................. [[32mPASS[0m in 0.17s]
[0m18:19:53.162230 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:19:53.164710 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:19:53.165694 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:19:53.168171 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:19:53.169514 [debug] [Thread-1  ]: SQL status: BEGIN in 0.018 seconds
[0m18:19:53.170387 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: BEGIN
[0m18:19:53.171211 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:19:53.172266 [info ] [Thread-4  ]: 17 of 18 START test unique_stg_kaggle__btcusdt_close_time ...................... [RUN]
[0m18:19:53.173857 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:19:53.175240 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:19:53.180816 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:19:53.182349 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m18:19:53.183668 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_base_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_base_asset_volume is null



      
    ) dbt_internal_test
[0m18:19:53.186537 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:19:53.188141 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:19:53.195637 [debug] [Thread-3  ]: SQL status: BEGIN in 0.020 seconds
[0m18:19:53.202483 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:19:53.204343 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: BEGIN
[0m18:19:53.205744 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:19:53.207898 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:19:53.209481 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_quote_asset_volume is null



      
    ) dbt_internal_test
[0m18:19:53.210741 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:19:53.219308 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:19:53.221738 [debug] [Thread-2  ]: SQL status: BEGIN in 0.014 seconds
[0m18:19:53.223563 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:19:53.225415 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where volume is null



      
    ) dbt_internal_test
[0m18:19:53.226884 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:19:53.228961 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: BEGIN
[0m18:19:53.230541 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:19:53.242606 [debug] [Thread-4  ]: SQL status: BEGIN in 0.012 seconds
[0m18:19:53.244525 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:19:53.246640 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    close_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is not null
group by close_time
having count(*) > 1



      
    ) dbt_internal_test
[0m18:19:53.258669 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.071 seconds
[0m18:19:53.263791 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: ROLLBACK
[0m18:19:53.266274 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: Close
[0m18:19:53.272423 [info ] [Thread-1  ]: 14 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ......... [[32mPASS[0m in 0.19s]
[0m18:19:53.275602 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:19:53.278473 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:19:53.281178 [info ] [Thread-1  ]: 18 of 18 START test unique_stg_kaggle__btcusdt_open_time ....................... [RUN]
[0m18:19:53.283987 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m18:19:53.287230 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:19:53.301756 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:19:53.308100 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:19:53.314359 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:19:53.315653 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.103 seconds
[0m18:19:53.317102 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.089 seconds
[0m18:19:53.320970 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: ROLLBACK
[0m18:19:53.326217 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: ROLLBACK
[0m18:19:53.328407 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:19:53.331428 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: Close
[0m18:19:53.333442 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: Close
[0m18:19:53.335097 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: BEGIN
[0m18:19:53.338316 [info ] [Thread-3  ]: 15 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume ........ [[32mPASS[0m in 0.23s]
[0m18:19:53.341454 [info ] [Thread-2  ]: 16 of 18 PASS not_null_stg_kaggle__btcusdt_volume .............................. [[32mPASS[0m in 0.20s]
[0m18:19:53.343944 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:19:53.347274 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:19:53.350130 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:19:53.358393 [debug] [Thread-1  ]: SQL status: BEGIN in 0.014 seconds
[0m18:19:53.359869 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:19:53.361989 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    open_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is not null
group by open_time
having count(*) > 1



      
    ) dbt_internal_test
[0m18:19:54.318706 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.955 seconds
[0m18:19:54.321279 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: ROLLBACK
[0m18:19:54.322627 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: Close
[0m18:19:54.324098 [info ] [Thread-1  ]: 18 of 18 PASS unique_stg_kaggle__btcusdt_open_time ............................. [[32mPASS[0m in 1.04s]
[0m18:19:54.325466 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:19:54.474337 [debug] [Thread-4  ]: SQL status: SELECT 1 in 1.225 seconds
[0m18:19:54.478146 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: ROLLBACK
[0m18:19:54.480072 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: Close
[0m18:19:54.482076 [info ] [Thread-4  ]: 17 of 18 PASS unique_stg_kaggle__btcusdt_close_time ............................ [[32mPASS[0m in 1.30s]
[0m18:19:54.484247 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:19:54.488281 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:54.489386 [debug] [MainThread]: On master: BEGIN
[0m18:19:54.490391 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:54.495976 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:19:54.497717 [debug] [MainThread]: On master: COMMIT
[0m18:19:54.499073 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:54.500042 [debug] [MainThread]: On master: COMMIT
[0m18:19:54.501435 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:19:54.502615 [debug] [MainThread]: On master: Close
[0m18:19:54.503995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:54.505066 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa' was properly closed.
[0m18:19:54.506044 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae' was properly closed.
[0m18:19:54.506960 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42' was properly closed.
[0m18:19:54.508030 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb' was properly closed.
[0m18:19:54.509395 [info ] [MainThread]: 
[0m18:19:54.510450 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m18:19:54.516688 [debug] [MainThread]: Command end result
[0m18:19:54.517773 [info ] [MainThread]: 
[0m18:19:54.519038 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:19:54.520069 [info ] [MainThread]: 
[0m18:19:54.521054 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m18:19:54.522705 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.319312, "process_user_time": 3.651811, "process_kernel_time": 0.233138, "process_mem_max_rss": "114512", "process_out_blocks": "141", "process_in_blocks": "0"}
[0m18:19:54.523928 [debug] [MainThread]: Command `dbt test` succeeded at 18:19:54.523791 after 3.32 seconds
[0m18:19:54.525040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd623cee0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd620b193a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd621b17100>]}
[0m18:19:54.526115 [debug] [MainThread]: Flushing usage events
[0m18:19:58.620830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeabf0b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea9b99640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea9b995e0>]}


============================== 18:19:58.628312 | ba34a019-6c5b-4b9c-9caf-538161616adb ==============================
[0m18:19:58.628312 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:19:58.629481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models int_hourly_trades', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:19:58.867763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba34a019-6c5b-4b9c-9caf-538161616adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea9c08160>]}
[0m18:19:58.941066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba34a019-6c5b-4b9c-9caf-538161616adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea9bc8a60>]}
[0m18:19:58.943841 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:19:58.975959 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:19:59.237042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:19:59.237953 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:19:59.314244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba34a019-6c5b-4b9c-9caf-538161616adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea8996130>]}
[0m18:19:59.328637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba34a019-6c5b-4b9c-9caf-538161616adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea89bc730>]}
[0m18:19:59.329873 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:19:59.330927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba34a019-6c5b-4b9c-9caf-538161616adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea8d110a0>]}
[0m18:19:59.333380 [info ] [MainThread]: 
[0m18:19:59.335039 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:19:59.336955 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m18:19:59.447390 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m18:19:59.448679 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m18:19:59.449840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:59.457150 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m18:19:59.459711 [debug] [ThreadPool]: On list_company_dw: Close
[0m18:19:59.468191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m18:19:59.479621 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:19:59.480871 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:19:59.482079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:59.493473 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:19:59.495037 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:19:59.496193 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:19:59.500562 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m18:19:59.503221 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:19:59.504620 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:19:59.513704 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:59.514820 [debug] [MainThread]: On master: BEGIN
[0m18:19:59.515841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:59.521152 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:19:59.522326 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:59.523417 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:19:59.531977 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:19:59.534068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba34a019-6c5b-4b9c-9caf-538161616adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea89bcaf0>]}
[0m18:19:59.535172 [debug] [MainThread]: On master: ROLLBACK
[0m18:19:59.536487 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:59.537375 [debug] [MainThread]: On master: BEGIN
[0m18:19:59.538842 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:19:59.539788 [debug] [MainThread]: On master: COMMIT
[0m18:19:59.540694 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:59.541594 [debug] [MainThread]: On master: COMMIT
[0m18:19:59.542708 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:19:59.543670 [debug] [MainThread]: On master: Close
[0m18:19:59.544863 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:19:59.545877 [info ] [MainThread]: 
[0m18:19:59.555999 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.int_hourly_trades
[0m18:19:59.557416 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.int_hourly_trades ....................... [RUN]
[0m18:19:59.558584 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.int_hourly_trades)
[0m18:19:59.559619 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.int_hourly_trades
[0m18:19:59.572898 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:19:59.576909 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.int_hourly_trades
[0m18:19:59.636236 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:19:59.638774 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:19:59.639816 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: BEGIN
[0m18:19:59.640905 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:19:59.646640 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m18:19:59.647818 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:19:59.649550 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */

  
    

  create  table "company_dw"."analytics"."int_hourly_trades__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."analytics"."stg_kaggle__btcusdt"

),


hourly as (

    select
        open_date,
        max(
            case
                when hour_start is true
                    then extract(minutes from open_time)
            end 
        ) as open_hour,

        max(
            case
                when hour_start is true
                    then open
            end 
        ) as open_price,

        max(
            case
                when hour_end is true
                    then close
            end
        ) as close_price

    from source
    
    where
        hour_start is true or hour_end is true
    
    group by 1

),


final as (

    select
        open_date,
        open_hour,
        open_price,
        close_price,       
        (close_price - open_price) * 1.0 / open_price as percent_gain

    from hourly

)

select * from final
  );
  
[0m18:19:59.711436 [debug] [Thread-1  ]: SQL status: SELECT 13 in 0.060 seconds
[0m18:19:59.721935 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:19:59.723185 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */
alter table "company_dw"."analytics"."int_hourly_trades" rename to "int_hourly_trades__dbt_backup"
[0m18:19:59.724708 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:19:59.730065 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:19:59.731298 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */
alter table "company_dw"."analytics"."int_hourly_trades__dbt_tmp" rename to "int_hourly_trades"
[0m18:19:59.732767 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:19:59.762955 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: COMMIT
[0m18:19:59.764113 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:19:59.765093 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: COMMIT
[0m18:19:59.767291 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m18:19:59.776433 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."int_hourly_trades__dbt_backup"
[0m18:19:59.782576 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:19:59.784125 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */
drop table if exists "company_dw"."analytics"."int_hourly_trades__dbt_backup" cascade
[0m18:19:59.787939 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m18:19:59.791671 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: Close
[0m18:19:59.794765 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba34a019-6c5b-4b9c-9caf-538161616adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea8142340>]}
[0m18:19:59.796552 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.int_hourly_trades .................. [[32mSELECT 13[0m in 0.23s]
[0m18:19:59.798526 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.int_hourly_trades
[0m18:19:59.802610 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:59.804143 [debug] [MainThread]: On master: BEGIN
[0m18:19:59.805980 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:59.813429 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:19:59.814951 [debug] [MainThread]: On master: COMMIT
[0m18:19:59.816090 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:59.816913 [debug] [MainThread]: On master: COMMIT
[0m18:19:59.818352 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:19:59.819230 [debug] [MainThread]: On master: Close
[0m18:19:59.820288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:59.821090 [debug] [MainThread]: Connection 'model.dbt_btc_transform.int_hourly_trades' was properly closed.
[0m18:19:59.821970 [info ] [MainThread]: 
[0m18:19:59.822934 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m18:19:59.824384 [debug] [MainThread]: Command end result
[0m18:19:59.825231 [info ] [MainThread]: 
[0m18:19:59.826310 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:19:59.827198 [info ] [MainThread]: 
[0m18:19:59.828099 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:19:59.829605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2818687, "process_user_time": 3.168213, "process_kernel_time": 0.171145, "process_mem_max_rss": "109332", "process_out_blocks": "39", "process_in_blocks": "0"}
[0m18:19:59.830747 [debug] [MainThread]: Command `dbt run` succeeded at 18:19:59.830625 after 1.28 seconds
[0m18:19:59.831738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeabf0b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea9d5b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbea8d11430>]}
[0m18:19:59.832680 [debug] [MainThread]: Flushing usage events
[0m18:20:05.384909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc031e7f040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02faeb580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02faeb520>]}


============================== 18:20:05.393313 | f0aa707b-466f-4b00-a322-6afb15338e2e ==============================
[0m18:20:05.393313 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:20:05.394620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models int_hourly_trades', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:20:05.622563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0aa707b-466f-4b00-a322-6afb15338e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02fb0f580>]}
[0m18:20:05.699213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0aa707b-466f-4b00-a322-6afb15338e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0307eac40>]}
[0m18:20:05.700921 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:20:05.733268 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:20:05.995913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:20:05.996822 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:20:06.069895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0aa707b-466f-4b00-a322-6afb15338e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02e916130>]}
[0m18:20:06.094962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0aa707b-466f-4b00-a322-6afb15338e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02ec99250>]}
[0m18:20:06.096630 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:20:06.097917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0aa707b-466f-4b00-a322-6afb15338e2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02ec8d0d0>]}
[0m18:20:06.100381 [info ] [MainThread]: 
[0m18:20:06.101286 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:20:06.104126 [debug] [MainThread]: Command end result
[0m18:20:06.105538 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7998903, "process_user_time": 2.744741, "process_kernel_time": 0.139955, "process_mem_max_rss": "103736", "process_out_blocks": "11", "process_in_blocks": "0"}
[0m18:20:06.106711 [debug] [MainThread]: Command `dbt test` succeeded at 18:20:06.106590 after 0.80 seconds
[0m18:20:06.107644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc031e7f040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02e9583a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0307eac40>]}
[0m18:20:06.108507 [debug] [MainThread]: Flushing usage events
[0m18:20:11.269891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05c3acfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05a02b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05a02b7c0>]}


============================== 18:20:11.277411 | 4024ae44-e367-4e8e-bcc5-510a9427ddb1 ==============================
[0m18:20:11.277411 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:20:11.278629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:20:11.494134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4024ae44-e367-4e8e-bcc5-510a9427ddb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0599d6e80>]}
[0m18:20:11.566433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4024ae44-e367-4e8e-bcc5-510a9427ddb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05a274130>]}
[0m18:20:11.567926 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:20:11.600500 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:20:11.789005 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:20:11.790224 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25
[0m18:20:11.791127 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:20:11.792148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4024ae44-e367-4e8e-bcc5-510a9427ddb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05b3be970>]}
[0m18:20:13.946029 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:20:13.947181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4024ae44-e367-4e8e-bcc5-510a9427ddb1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05a23ad30>]}
[0m18:20:14.342806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4024ae44-e367-4e8e-bcc5-510a9427ddb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0595dd520>]}
[0m18:20:14.359304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4024ae44-e367-4e8e-bcc5-510a9427ddb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05915d340>]}
[0m18:20:14.360440 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:20:14.361401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4024ae44-e367-4e8e-bcc5-510a9427ddb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05915d910>]}
[0m18:20:14.364166 [info ] [MainThread]: 
[0m18:20:14.365433 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:20:14.374225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m18:20:14.418129 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:20:14.419672 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m18:20:14.420616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:14.426163 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:20:14.427094 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:20:14.427980 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:20:14.431269 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m18:20:14.433069 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m18:20:14.434202 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m18:20:14.441344 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:14.442239 [debug] [MainThread]: On master: BEGIN
[0m18:20:14.443072 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:20:14.448321 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:20:14.449265 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:14.450330 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:20:14.457907 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:20:14.459776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4024ae44-e367-4e8e-bcc5-510a9427ddb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05bf27eb0>]}
[0m18:20:14.460776 [debug] [MainThread]: On master: ROLLBACK
[0m18:20:14.461820 [debug] [MainThread]: On master: Close
[0m18:20:14.462888 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:20:14.463778 [info ] [MainThread]: 
[0m18:20:14.472756 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:20:14.473961 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m18:20:14.475073 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:20:14.487472 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:20:14.489589 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:20:14.490956 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:20:14.494184 [debug] [Thread-3  ]: Began running node model.dbt_btc_transform.int_hourly_trades
[0m18:20:14.494990 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:20:14.495846 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:20:14.496733 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:20:14.497601 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_btc_transform.int_hourly_trades'
[0m18:20:14.498739 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872'
[0m18:20:14.500527 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m18:20:14.501737 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_btc_transform.stg_kaggle__btcusdt, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb)
[0m18:20:14.503388 [debug] [Thread-3  ]: Began compiling node model.dbt_btc_transform.int_hourly_trades
[0m18:20:14.504594 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:20:14.505565 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:20:14.506542 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:20:14.511741 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:20:14.517392 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:20:14.522887 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:20:14.534197 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:20:14.536861 [debug] [Thread-3  ]: Began executing node model.dbt_btc_transform.int_hourly_trades
[0m18:20:14.538214 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:20:14.539823 [debug] [Thread-3  ]: Finished running node model.dbt_btc_transform.int_hourly_trades
[0m18:20:14.540801 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:20:14.542252 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:20:14.542851 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:20:14.544047 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:20:14.545486 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:20:14.546754 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:20:14.549300 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:20:14.550602 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_btc_transform.int_hourly_trades, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a)
[0m18:20:14.551721 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:20:14.552895 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m18:20:14.553971 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:20:14.555059 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:20:14.556085 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m18:20:14.556992 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:20:14.558066 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m18:20:14.563938 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:20:14.564966 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:20:14.572082 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:20:14.573086 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:20:14.579198 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:20:14.580423 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:20:14.585956 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:20:14.588113 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:20:14.589637 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:20:14.590738 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:20:14.592387 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:20:14.593628 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:20:14.595205 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:20:14.595892 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:20:14.596837 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:20:14.598409 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m18:20:14.600080 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:20:14.601700 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:20:14.602697 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m18:20:14.603900 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:20:14.604951 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m18:20:14.606106 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:20:14.607154 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:20:14.613067 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:20:14.614173 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:20:14.615203 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m18:20:14.620908 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:20:14.627710 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:20:14.628832 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:20:14.629953 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:20:14.638533 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:20:14.639661 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:20:14.640366 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:20:14.641474 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:20:14.643421 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:20:14.644898 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:20:14.645877 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:20:14.646689 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:20:14.647873 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:20:14.649111 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:20:14.650586 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:20:14.651908 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m18:20:14.653228 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m18:20:14.654272 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m18:20:14.655433 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:20:14.656451 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:20:14.657580 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:20:14.658559 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:20:14.659565 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m18:20:14.665648 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:20:14.671404 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:20:14.677047 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:20:14.678208 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:20:14.680856 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:20:14.686298 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:20:14.687339 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:20:14.688471 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:20:14.689769 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:20:14.691419 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:20:14.692555 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:20:14.693555 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:20:14.695217 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:20:14.696379 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:20:14.697907 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:20:14.699065 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m18:20:14.700275 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:20:14.701367 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m18:20:14.703155 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:20:14.704474 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m18:20:14.705648 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:20:14.711771 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:20:14.712832 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:20:14.722793 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:20:14.728858 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:20:14.730261 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:20:14.731863 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:20:14.732981 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:20:14.734131 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:20:14.735434 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:20:14.738187 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:20:14.742241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:14.743315 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42' was properly closed.
[0m18:20:14.744333 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae' was properly closed.
[0m18:20:14.745275 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb' was properly closed.
[0m18:20:14.746189 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa' was properly closed.
[0m18:20:14.751458 [debug] [MainThread]: Command end result
[0m18:20:14.946844 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:20:14.948043 [info ] [MainThread]: Building catalog
[0m18:20:14.963053 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m18:20:14.973772 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m18:20:14.974687 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m18:20:14.975524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:14.980254 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:20:14.981142 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m18:20:14.982218 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('btcusdt')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('int_hourly_trades')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_kaggle__btcusdt')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:20:14.986581 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m18:20:14.995585 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m18:20:14.997427 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m18:20:15.082114 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m18:20:15.083638 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.890284, "process_user_time": 5.669835, "process_kernel_time": 0.164049, "process_mem_max_rss": "191612", "process_out_blocks": "6562", "process_in_blocks": "0"}
[0m18:20:15.084829 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:20:15.084689 after 3.89 seconds
[0m18:20:15.085906 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:20:15.086910 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m18:20:15.087945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05c3acfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05be63280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05915dc10>]}
[0m18:20:15.089029 [debug] [MainThread]: Flushing usage events
[0m18:23:15.513486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8cc37100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8a8ab6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8a8ab640>]}


============================== 18:23:15.520952 | 4eb5ad39-920f-4a4e-8201-44945d968fe5 ==============================
[0m18:23:15.520952 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:23:15.522073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:23:15.742941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4eb5ad39-920f-4a4e-8201-44945d968fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8a8d23d0>]}
[0m18:23:15.812701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4eb5ad39-920f-4a4e-8201-44945d968fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8d1cfdf0>]}
[0m18:23:15.814303 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:23:15.849945 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:23:16.016798 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:23:16.017882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4eb5ad39-920f-4a4e-8201-44945d968fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8bbdd2b0>]}
[0m18:23:18.059267 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:23:18.060644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4eb5ad39-920f-4a4e-8201-44945d968fe5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8a552dc0>]}
[0m18:23:18.475060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4eb5ad39-920f-4a4e-8201-44945d968fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f89dca2e0>]}
[0m18:23:18.492941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4eb5ad39-920f-4a4e-8201-44945d968fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8a0a7040>]}
[0m18:23:18.494082 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:23:18.494995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eb5ad39-920f-4a4e-8201-44945d968fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f899f24c0>]}
[0m18:23:18.497115 [info ] [MainThread]: 
[0m18:23:18.498255 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:23:18.499877 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m18:23:18.544087 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m18:23:18.545075 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m18:23:18.545906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:18.551764 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m18:23:18.553759 [debug] [ThreadPool]: On list_company_dw: Close
[0m18:23:18.560690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m18:23:18.569654 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:23:18.570629 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:23:18.571465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:18.576156 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:23:18.577086 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:23:18.577994 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:23:18.581419 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m18:23:18.583518 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:23:18.584674 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:23:18.592264 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:18.593238 [debug] [MainThread]: On master: BEGIN
[0m18:23:18.594063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:23:18.598787 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:23:18.599762 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:18.600881 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:23:18.608674 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:23:18.610539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eb5ad39-920f-4a4e-8201-44945d968fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8a8c83d0>]}
[0m18:23:18.611711 [debug] [MainThread]: On master: ROLLBACK
[0m18:23:18.612982 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:18.613806 [debug] [MainThread]: On master: BEGIN
[0m18:23:18.615426 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:23:18.616309 [debug] [MainThread]: On master: COMMIT
[0m18:23:18.617106 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:18.617836 [debug] [MainThread]: On master: COMMIT
[0m18:23:18.618832 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:23:18.619671 [debug] [MainThread]: On master: Close
[0m18:23:18.620931 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:23:18.622059 [info ] [MainThread]: 
[0m18:23:18.631498 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:23:18.632808 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m18:23:18.634031 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m18:23:18.635123 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:23:18.648476 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:23:18.652648 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:23:18.706749 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:23:18.709184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:23:18.710156 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m18:23:18.711083 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:18.716316 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m18:23:18.718226 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:23:18.719931 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    -- I hate just putting a distinct to deal with duplicates but doing this because there are dupes in the source data.
    -- I would rather investigate why this is happening at the source and fix there but need to work
    -- with what was given
    select distinct 
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote_asset_volume,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        open_time::date as open_date,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minutes from open_time) = 0
            and extract(second from open_time) = 0
                then true
            else false
        end as hour_start,

        case    
            when extract(minute from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as hour_end
            

    from source

)

select * from final
  );
  
[0m18:23:20.532084 [debug] [Thread-1  ]: SQL status: SELECT 999963 in 1.811 seconds
[0m18:23:20.541513 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:23:20.542625 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt" rename to "stg_kaggle__btcusdt__dbt_backup"
[0m18:23:20.545314 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:20.550479 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:23:20.551459 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp" rename to "stg_kaggle__btcusdt"
[0m18:23:20.552950 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:23:20.579670 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m18:23:20.580712 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:23:20.581673 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m18:23:20.597676 [debug] [Thread-1  ]: SQL status: COMMIT in 0.015 seconds
[0m18:23:20.608260 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup"
[0m18:23:20.614972 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:23:20.615994 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
drop table if exists "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup" cascade
[0m18:23:20.631801 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.015 seconds
[0m18:23:20.635430 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m18:23:20.637944 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eb5ad39-920f-4a4e-8201-44945d968fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8906ff40>]}
[0m18:23:20.639237 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.stg_kaggle__btcusdt ................ [[32mSELECT 999963[0m in 2.00s]
[0m18:23:20.640527 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:23:20.643430 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:20.644337 [debug] [MainThread]: On master: BEGIN
[0m18:23:20.645145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:23:20.650265 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:23:20.651235 [debug] [MainThread]: On master: COMMIT
[0m18:23:20.652056 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:20.652812 [debug] [MainThread]: On master: COMMIT
[0m18:23:20.653824 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:23:20.654595 [debug] [MainThread]: On master: Close
[0m18:23:20.655650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:20.656431 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m18:23:20.657334 [info ] [MainThread]: 
[0m18:23:20.658220 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m18:23:20.659760 [debug] [MainThread]: Command end result
[0m18:23:20.660587 [info ] [MainThread]: 
[0m18:23:20.661475 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:23:20.662350 [info ] [MainThread]: 
[0m18:23:20.663268 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:23:20.664727 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.2240276, "process_user_time": 5.113778, "process_kernel_time": 0.180759, "process_mem_max_rss": "115140", "process_out_blocks": "1189", "process_in_blocks": "0"}
[0m18:23:20.665852 [debug] [MainThread]: Command `dbt run` succeeded at 18:23:20.665729 after 5.23 seconds
[0m18:23:20.666949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8cc37100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f89894f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8a0a7580>]}
[0m18:23:20.667810 [debug] [MainThread]: Flushing usage events
[0m18:23:25.601420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fae1880d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fabe11610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fabe115b0>]}


============================== 18:23:25.609071 | b96a6cc2-f12e-4d6f-8cfb-9496c239fdc4 ==============================
[0m18:23:25.609071 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:23:25.610360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models int_hourly_trades', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:23:25.847623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b96a6cc2-f12e-4d6f-8cfb-9496c239fdc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fadd59430>]}
[0m18:23:25.929093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b96a6cc2-f12e-4d6f-8cfb-9496c239fdc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fabfd6100>]}
[0m18:23:25.930647 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:23:25.961838 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:23:26.223901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:23:26.224772 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:23:26.299771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b96a6cc2-f12e-4d6f-8cfb-9496c239fdc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2faae56130>]}
[0m18:23:26.314593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b96a6cc2-f12e-4d6f-8cfb-9496c239fdc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2faae7c760>]}
[0m18:23:26.315674 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:23:26.316649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b96a6cc2-f12e-4d6f-8cfb-9496c239fdc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2faaf90190>]}
[0m18:23:26.318880 [info ] [MainThread]: 
[0m18:23:26.320128 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:23:26.321836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m18:23:26.428623 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m18:23:26.429947 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m18:23:26.431236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:26.437330 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m18:23:26.439543 [debug] [ThreadPool]: On list_company_dw: Close
[0m18:23:26.447386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m18:23:26.457722 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:23:26.458789 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:23:26.459702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:26.464946 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:23:26.465995 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:23:26.467009 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:23:26.470621 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m18:23:26.472761 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:23:26.474040 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:23:26.482088 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:26.483166 [debug] [MainThread]: On master: BEGIN
[0m18:23:26.484006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:23:26.488829 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:23:26.489825 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:26.490993 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:23:26.499471 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:23:26.501442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b96a6cc2-f12e-4d6f-8cfb-9496c239fdc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2faae42c70>]}
[0m18:23:26.502485 [debug] [MainThread]: On master: ROLLBACK
[0m18:23:26.503607 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:26.504466 [debug] [MainThread]: On master: BEGIN
[0m18:23:26.505838 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:23:26.506774 [debug] [MainThread]: On master: COMMIT
[0m18:23:26.507610 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:26.508401 [debug] [MainThread]: On master: COMMIT
[0m18:23:26.509464 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:23:26.510312 [debug] [MainThread]: On master: Close
[0m18:23:26.511491 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:23:26.512477 [info ] [MainThread]: 
[0m18:23:26.522064 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.int_hourly_trades
[0m18:23:26.523434 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.int_hourly_trades ....................... [RUN]
[0m18:23:26.524532 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.int_hourly_trades)
[0m18:23:26.525478 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.int_hourly_trades
[0m18:23:26.538426 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:23:26.541462 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.int_hourly_trades
[0m18:23:26.598796 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:23:26.601385 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:23:26.602338 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: BEGIN
[0m18:23:26.603257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:26.607973 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m18:23:26.609049 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:23:26.610215 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */

  
    

  create  table "company_dw"."analytics"."int_hourly_trades__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."analytics"."stg_kaggle__btcusdt"

),


hourly as (

    select
        open_date,
        extract(hours from open_time) as open_hour,

        max(
            case
                when hour_start is true
                    then open
            end 
        ) as open_price,

        max(
            case
                when hour_end is true
                    then close
            end
        ) as close_price

    from source

    where
        hour_start is true or hour_end is true
    
    group by 1, 2

),


final as (

    select
        open_date,
        open_hour,
        open_price,
        close_price,       
        (close_price - open_price) * 1.0 / open_price as percent_gain

    from hourly

)

select * from final
  );
  
[0m18:23:26.686047 [debug] [Thread-1  ]: SQL status: SELECT 279 in 0.075 seconds
[0m18:23:26.697203 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:23:26.698382 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */
alter table "company_dw"."analytics"."int_hourly_trades" rename to "int_hourly_trades__dbt_backup"
[0m18:23:26.700047 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:26.705460 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:23:26.706547 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */
alter table "company_dw"."analytics"."int_hourly_trades__dbt_tmp" rename to "int_hourly_trades"
[0m18:23:26.708118 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:23:26.737480 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: COMMIT
[0m18:23:26.738635 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:23:26.739623 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: COMMIT
[0m18:23:26.741843 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m18:23:26.751674 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."int_hourly_trades__dbt_backup"
[0m18:23:26.758500 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.int_hourly_trades"
[0m18:23:26.759670 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.int_hourly_trades"} */
drop table if exists "company_dw"."analytics"."int_hourly_trades__dbt_backup" cascade
[0m18:23:26.762666 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m18:23:26.766531 [debug] [Thread-1  ]: On model.dbt_btc_transform.int_hourly_trades: Close
[0m18:23:26.769179 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b96a6cc2-f12e-4d6f-8cfb-9496c239fdc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2faa3c22b0>]}
[0m18:23:26.770971 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.int_hourly_trades .................. [[32mSELECT 279[0m in 0.24s]
[0m18:23:26.772540 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.int_hourly_trades
[0m18:23:26.775838 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:26.776897 [debug] [MainThread]: On master: BEGIN
[0m18:23:26.777909 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:23:26.782735 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:23:26.783815 [debug] [MainThread]: On master: COMMIT
[0m18:23:26.784773 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:26.785587 [debug] [MainThread]: On master: COMMIT
[0m18:23:26.786695 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:23:26.787637 [debug] [MainThread]: On master: Close
[0m18:23:26.788923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:26.789961 [debug] [MainThread]: Connection 'model.dbt_btc_transform.int_hourly_trades' was properly closed.
[0m18:23:26.790830 [info ] [MainThread]: 
[0m18:23:26.791736 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m18:23:26.793116 [debug] [MainThread]: Command end result
[0m18:23:26.793958 [info ] [MainThread]: 
[0m18:23:26.795094 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:23:26.795973 [info ] [MainThread]: 
[0m18:23:26.796932 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:23:26.798566 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2727895, "process_user_time": 2.957195, "process_kernel_time": 0.172941, "process_mem_max_rss": "109504", "process_out_blocks": "38", "process_in_blocks": "0"}
[0m18:23:26.799657 [debug] [MainThread]: Command `dbt run` succeeded at 18:23:26.799511 after 1.27 seconds
[0m18:23:26.800586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fae1880d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2facb3ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fabfd6100>]}
[0m18:23:26.801469 [debug] [MainThread]: Flushing usage events
[0m18:23:31.738993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07edb50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07ca2b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07ca2b580>]}


============================== 18:23:31.747102 | e4dfe728-a6cd-4dd8-bfbe-8aa1907efd5d ==============================
[0m18:23:31.747102 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:23:31.748439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models stg_kaggle__btcusdt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:23:31.976796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4dfe728-a6cd-4dd8-bfbe-8aa1907efd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07ca51b50>]}
[0m18:23:32.048768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4dfe728-a6cd-4dd8-bfbe-8aa1907efd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07c3c66a0>]}
[0m18:23:32.050128 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:23:32.080254 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:23:32.357699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:23:32.358578 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:23:32.437955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4dfe728-a6cd-4dd8-bfbe-8aa1907efd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07ba96130>]}
[0m18:23:32.465699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4dfe728-a6cd-4dd8-bfbe-8aa1907efd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07bbdc400>]}
[0m18:23:32.467048 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:23:32.468052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4dfe728-a6cd-4dd8-bfbe-8aa1907efd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07bbd11f0>]}
[0m18:23:32.471421 [info ] [MainThread]: 
[0m18:23:32.472785 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:23:32.479897 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analytics'
[0m18:23:32.589747 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:23:32.590744 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m18:23:32.591565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:32.596653 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:23:32.597665 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m18:23:32.598583 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:23:32.602074 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m18:23:32.604196 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m18:23:32.605382 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m18:23:32.613077 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:32.614012 [debug] [MainThread]: On master: BEGIN
[0m18:23:32.614874 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:23:32.619753 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:23:32.620746 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:32.621877 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:23:32.630308 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:23:32.632352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4dfe728-a6cd-4dd8-bfbe-8aa1907efd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07b6b3ca0>]}
[0m18:23:32.633396 [debug] [MainThread]: On master: ROLLBACK
[0m18:23:32.634573 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:32.635469 [debug] [MainThread]: On master: BEGIN
[0m18:23:32.636793 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:23:32.637666 [debug] [MainThread]: On master: COMMIT
[0m18:23:32.638479 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:32.639274 [debug] [MainThread]: On master: COMMIT
[0m18:23:32.640326 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:23:32.641122 [debug] [MainThread]: On master: Close
[0m18:23:32.642320 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:23:32.643160 [info ] [MainThread]: 
[0m18:23:32.653563 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:23:32.654437 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:23:32.655186 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:23:32.656258 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:23:32.656956 [info ] [Thread-1  ]: 1 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_end__True__False ... [RUN]
[0m18:23:32.658326 [info ] [Thread-2  ]: 2 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_start__True__False . [RUN]
[0m18:23:32.659449 [info ] [Thread-3  ]: 3 of 18 START test not_null_stg_kaggle__btcusdt_close .......................... [RUN]
[0m18:23:32.660554 [info ] [Thread-4  ]: 4 of 18 START test not_null_stg_kaggle__btcusdt_close_time ..................... [RUN]
[0m18:23:32.661727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872)
[0m18:23:32.662892 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m18:23:32.664019 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb'
[0m18:23:32.665219 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a'
[0m18:23:32.666276 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:23:32.667315 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:23:32.668275 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:23:32.669336 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:23:32.697769 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:23:32.700248 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:23:32.712059 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:23:32.717717 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:23:32.720704 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:23:32.721649 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:23:32.728729 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:23:32.746997 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:23:32.747876 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:23:32.751520 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:23:32.757296 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:23:32.761869 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:23:32.763694 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:23:32.765437 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:23:32.766622 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: BEGIN
[0m18:23:32.767365 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:23:32.768297 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: BEGIN
[0m18:23:32.769206 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:23:32.770489 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:32.771970 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: BEGIN
[0m18:23:32.773230 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:23:32.774209 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: BEGIN
[0m18:23:32.775754 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:23:32.778072 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:23:32.780558 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m18:23:32.782658 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m18:23:32.784028 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:23:32.785830 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:23:32.786777 [debug] [Thread-3  ]: SQL status: BEGIN in 0.011 seconds
[0m18:23:32.787947 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_end as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_end

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m18:23:32.788794 [debug] [Thread-4  ]: SQL status: BEGIN in 0.011 seconds
[0m18:23:32.789762 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_start as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_start

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m18:23:32.790853 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:23:32.792659 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:23:32.797433 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close is null



      
    ) dbt_internal_test
[0m18:23:32.799055 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is null



      
    ) dbt_internal_test
[0m18:23:32.871734 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.071 seconds
[0m18:23:32.882012 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: ROLLBACK
[0m18:23:32.883769 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: Close
[0m18:23:32.886170 [info ] [Thread-3  ]: 3 of 18 PASS not_null_stg_kaggle__btcusdt_close ................................ [[32mPASS[0m in 0.22s]
[0m18:23:32.888566 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:23:32.889407 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.089 seconds
[0m18:23:32.890701 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:23:32.891816 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.100 seconds
[0m18:23:32.894270 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: ROLLBACK
[0m18:23:32.895058 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.101 seconds
[0m18:23:32.896060 [info ] [Thread-3  ]: 5 of 18 START test not_null_stg_kaggle__btcusdt_high ........................... [RUN]
[0m18:23:32.898572 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: ROLLBACK
[0m18:23:32.899795 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: Close
[0m18:23:32.902091 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: ROLLBACK
[0m18:23:32.903526 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m18:23:32.904905 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: Close
[0m18:23:32.905941 [info ] [Thread-4  ]: 4 of 18 PASS not_null_stg_kaggle__btcusdt_close_time ........................... [[32mPASS[0m in 0.24s]
[0m18:23:32.907567 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: Close
[0m18:23:32.908292 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:23:32.909665 [info ] [Thread-1  ]: 1 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_end__True__False ......... [[32mPASS[0m in 0.25s]
[0m18:23:32.911058 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:23:32.912614 [info ] [Thread-2  ]: 2 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_start__True__False ....... [[32mPASS[0m in 0.25s]
[0m18:23:32.918864 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:23:32.920069 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:23:32.921203 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:23:32.922542 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:23:32.924262 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:23:32.925496 [info ] [Thread-4  ]: 6 of 18 START test not_null_stg_kaggle__btcusdt_hour_end ....................... [RUN]
[0m18:23:32.926527 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:23:32.927292 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:23:32.928367 [info ] [Thread-1  ]: 7 of 18 START test not_null_stg_kaggle__btcusdt_hour_start ..................... [RUN]
[0m18:23:32.929420 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m18:23:32.933548 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:23:32.934550 [info ] [Thread-2  ]: 8 of 18 START test not_null_stg_kaggle__btcusdt_low ............................ [RUN]
[0m18:23:32.936695 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m18:23:32.938301 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:23:32.940814 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m18:23:32.941952 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:23:32.942764 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:23:32.966184 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:23:32.967362 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:23:32.974506 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:23:32.975570 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: BEGIN
[0m18:23:32.984372 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:23:32.985563 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:23:32.987573 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:23:32.989227 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:23:32.993916 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:23:32.995887 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:23:33.000113 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:23:33.001994 [debug] [Thread-3  ]: SQL status: BEGIN in 0.014 seconds
[0m18:23:33.006183 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:23:33.007904 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:23:33.008681 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:23:33.010244 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:23:33.011045 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: BEGIN
[0m18:23:33.012302 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where high is null



      
    ) dbt_internal_test
[0m18:23:33.013325 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:23:33.014374 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: BEGIN
[0m18:23:33.015362 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:23:33.016983 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: BEGIN
[0m18:23:33.018434 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:33.020542 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:23:33.024861 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m18:23:33.026459 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:23:33.027435 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m18:23:33.028903 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_end
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_end is null



      
    ) dbt_internal_test
[0m18:23:33.030173 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m18:23:33.031310 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:23:33.033605 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:23:33.035096 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_start
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_start is null



      
    ) dbt_internal_test
[0m18:23:33.037290 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where low is null



      
    ) dbt_internal_test
[0m18:23:33.075622 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.059 seconds
[0m18:23:33.081137 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: ROLLBACK
[0m18:23:33.083635 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: Close
[0m18:23:33.086039 [info ] [Thread-3  ]: 5 of 18 PASS not_null_stg_kaggle__btcusdt_high ................................. [[32mPASS[0m in 0.18s]
[0m18:23:33.088854 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:23:33.090958 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:23:33.093107 [info ] [Thread-3  ]: 9 of 18 START test not_null_stg_kaggle__btcusdt_number_of_trades ............... [RUN]
[0m18:23:33.095165 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m18:23:33.097676 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:23:33.108915 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:23:33.112709 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:23:33.120550 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:23:33.124886 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.092 seconds
[0m18:23:33.126326 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:23:33.129588 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: ROLLBACK
[0m18:23:33.130867 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.092 seconds
[0m18:23:33.132499 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: BEGIN
[0m18:23:33.134218 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.095 seconds
[0m18:23:33.136347 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: Close
[0m18:23:33.140379 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: ROLLBACK
[0m18:23:33.141954 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:23:33.145278 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: ROLLBACK
[0m18:23:33.147652 [info ] [Thread-4  ]: 6 of 18 PASS not_null_stg_kaggle__btcusdt_hour_end ............................. [[32mPASS[0m in 0.22s]
[0m18:23:33.149406 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: Close
[0m18:23:33.151732 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: Close
[0m18:23:33.152824 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:23:33.154517 [info ] [Thread-1  ]: 7 of 18 PASS not_null_stg_kaggle__btcusdt_hour_start ........................... [[32mPASS[0m in 0.22s]
[0m18:23:33.155414 [debug] [Thread-3  ]: SQL status: BEGIN in 0.014 seconds
[0m18:23:33.156789 [info ] [Thread-2  ]: 8 of 18 PASS not_null_stg_kaggle__btcusdt_low .................................. [[32mPASS[0m in 0.22s]
[0m18:23:33.158043 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:23:33.159534 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:23:33.160608 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:23:33.162034 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:23:33.163247 [info ] [Thread-4  ]: 10 of 18 START test not_null_stg_kaggle__btcusdt_open .......................... [RUN]
[0m18:23:33.164400 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:23:33.165545 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select number_of_trades
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where number_of_trades is null



      
    ) dbt_internal_test
[0m18:23:33.166680 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:23:33.167829 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m18:23:33.168865 [info ] [Thread-1  ]: 11 of 18 START test not_null_stg_kaggle__btcusdt_open_date ..................... [RUN]
[0m18:23:33.170523 [info ] [Thread-2  ]: 12 of 18 START test not_null_stg_kaggle__btcusdt_open_time ..................... [RUN]
[0m18:23:33.171730 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:23:33.172860 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m18:23:33.174087 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m18:23:33.182056 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:23:33.183066 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:23:33.184246 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:23:33.191196 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:23:33.198452 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:23:33.199904 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:23:33.205786 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:23:33.206616 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:23:33.207752 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:23:33.212801 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:23:33.217572 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:23:33.218478 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:23:33.219197 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.049 seconds
[0m18:23:33.221537 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: BEGIN
[0m18:23:33.222342 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:23:33.224790 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: ROLLBACK
[0m18:23:33.225694 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:23:33.226614 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:23:33.227642 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: BEGIN
[0m18:23:33.229005 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: Close
[0m18:23:33.229733 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: BEGIN
[0m18:23:33.231387 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:33.232919 [info ] [Thread-3  ]: 9 of 18 PASS not_null_stg_kaggle__btcusdt_number_of_trades ..................... [[32mPASS[0m in 0.14s]
[0m18:23:33.234067 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:23:33.234943 [debug] [Thread-4  ]: SQL status: BEGIN in 0.008 seconds
[0m18:23:33.236823 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:23:33.238617 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:23:33.240196 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:23:33.241072 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m18:23:33.242412 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open is null



      
    ) dbt_internal_test
[0m18:23:33.243324 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m18:23:33.244304 [info ] [Thread-3  ]: 13 of 18 START test not_null_stg_kaggle__btcusdt_quote_asset_volume ............ [RUN]
[0m18:23:33.245394 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:23:33.246806 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:23:33.248660 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m18:23:33.249845 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_date
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_date is null



      
    ) dbt_internal_test
[0m18:23:33.251086 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is null



      
    ) dbt_internal_test
[0m18:23:33.252324 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:23:33.266756 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:23:33.270015 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:23:33.276110 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:23:33.280250 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:23:33.282512 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: BEGIN
[0m18:23:33.284564 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:23:33.293180 [debug] [Thread-3  ]: SQL status: BEGIN in 0.008 seconds
[0m18:23:33.295444 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:23:33.297601 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where quote_asset_volume is null



      
    ) dbt_internal_test
[0m18:23:33.311672 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.065 seconds
[0m18:23:33.316155 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: ROLLBACK
[0m18:23:33.318077 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: Close
[0m18:23:33.321716 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.068 seconds
[0m18:23:33.320791 [info ] [Thread-4  ]: 10 of 18 PASS not_null_stg_kaggle__btcusdt_open ................................ [[32mPASS[0m in 0.15s]
[0m18:23:33.325496 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: ROLLBACK
[0m18:23:33.328085 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:23:33.330670 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: Close
[0m18:23:33.332359 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:23:33.334754 [info ] [Thread-2  ]: 12 of 18 PASS not_null_stg_kaggle__btcusdt_open_time ........................... [[32mPASS[0m in 0.16s]
[0m18:23:33.336940 [info ] [Thread-4  ]: 14 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ... [RUN]
[0m18:23:33.338546 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.085 seconds
[0m18:23:33.339694 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:23:33.340938 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m18:23:33.343580 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: ROLLBACK
[0m18:23:33.344879 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:23:33.346068 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:23:33.347668 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: Close
[0m18:23:33.348502 [info ] [Thread-2  ]: 15 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume .. [RUN]
[0m18:23:33.355951 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:23:33.357547 [info ] [Thread-1  ]: 11 of 18 PASS not_null_stg_kaggle__btcusdt_open_date ........................... [[32mPASS[0m in 0.18s]
[0m18:23:33.358787 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m18:23:33.360944 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:23:33.362288 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:23:33.363490 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:23:33.364258 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:23:33.371090 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:23:33.372198 [info ] [Thread-1  ]: 16 of 18 START test not_null_stg_kaggle__btcusdt_volume ........................ [RUN]
[0m18:23:33.377121 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:23:33.378003 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.079 seconds
[0m18:23:33.379793 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m18:23:33.381812 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:23:33.384588 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: ROLLBACK
[0m18:23:33.385878 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:23:33.387404 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:23:33.391656 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:23:33.399794 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: Close
[0m18:23:33.400858 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:23:33.402036 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: BEGIN
[0m18:23:33.404261 [info ] [Thread-3  ]: 13 of 18 PASS not_null_stg_kaggle__btcusdt_quote_asset_volume .................. [[32mPASS[0m in 0.16s]
[0m18:23:33.405618 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:23:33.406616 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:23:33.407953 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:23:33.408751 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:23:33.409637 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: BEGIN
[0m18:23:33.411420 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:23:33.416220 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:23:33.417862 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:23:33.418752 [debug] [Thread-4  ]: SQL status: BEGIN in 0.012 seconds
[0m18:23:33.419730 [info ] [Thread-3  ]: 17 of 18 START test unique_stg_kaggle__btcusdt_close_time ...................... [RUN]
[0m18:23:33.422323 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:23:33.423361 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:23:33.424433 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m18:23:33.425639 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_base_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_base_asset_volume is null



      
    ) dbt_internal_test
[0m18:23:33.426447 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m18:23:33.427320 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: BEGIN
[0m18:23:33.428351 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:23:33.429893 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:23:33.432024 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:33.442739 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:23:33.444059 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_quote_asset_volume is null



      
    ) dbt_internal_test
[0m18:23:33.448181 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:23:33.454898 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:23:33.455894 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m18:23:33.458231 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:23:33.459778 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where volume is null



      
    ) dbt_internal_test
[0m18:23:33.461613 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:23:33.463170 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: BEGIN
[0m18:23:33.465363 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:23:33.473786 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m18:23:33.475510 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:23:33.477408 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    close_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is not null
group by close_time
having count(*) > 1



      
    ) dbt_internal_test
[0m18:23:33.496869 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.067 seconds
[0m18:23:33.501574 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: ROLLBACK
[0m18:23:33.503806 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: Close
[0m18:23:33.506513 [info ] [Thread-4  ]: 14 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ......... [[32mPASS[0m in 0.17s]
[0m18:23:33.508883 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:23:33.510677 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:23:33.512519 [info ] [Thread-4  ]: 18 of 18 START test unique_stg_kaggle__btcusdt_open_time ....................... [RUN]
[0m18:23:33.514792 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m18:23:33.516653 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:23:33.528801 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:23:33.529910 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.083 seconds
[0m18:23:33.533855 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: ROLLBACK
[0m18:23:33.534858 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.074 seconds
[0m18:23:33.536049 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:23:33.537052 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: Close
[0m18:23:33.539822 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: ROLLBACK
[0m18:23:33.546201 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:23:33.549096 [info ] [Thread-2  ]: 15 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume ........ [[32mPASS[0m in 0.19s]
[0m18:23:33.551746 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: Close
[0m18:23:33.554120 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:23:33.556887 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:23:33.556003 [info ] [Thread-1  ]: 16 of 18 PASS not_null_stg_kaggle__btcusdt_volume .............................. [[32mPASS[0m in 0.18s]
[0m18:23:33.559217 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: BEGIN
[0m18:23:33.560739 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:23:33.561921 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:23:33.569022 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m18:23:33.570276 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:23:33.571377 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    open_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is not null
group by open_time
having count(*) > 1



      
    ) dbt_internal_test
[0m18:23:34.432729 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.860 seconds
[0m18:23:34.435941 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: ROLLBACK
[0m18:23:34.437661 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: Close
[0m18:23:34.439474 [info ] [Thread-4  ]: 18 of 18 PASS unique_stg_kaggle__btcusdt_open_time ............................. [[32mPASS[0m in 0.92s]
[0m18:23:34.441237 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:23:34.585029 [debug] [Thread-3  ]: SQL status: SELECT 1 in 1.106 seconds
[0m18:23:34.587707 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: ROLLBACK
[0m18:23:34.588987 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: Close
[0m18:23:34.590356 [info ] [Thread-3  ]: 17 of 18 PASS unique_stg_kaggle__btcusdt_close_time ............................ [[32mPASS[0m in 1.17s]
[0m18:23:34.591655 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:23:34.594600 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:34.595465 [debug] [MainThread]: On master: BEGIN
[0m18:23:34.596361 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:23:34.601296 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:23:34.602367 [debug] [MainThread]: On master: COMMIT
[0m18:23:34.603121 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:34.604129 [debug] [MainThread]: On master: COMMIT
[0m18:23:34.605184 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:23:34.606070 [debug] [MainThread]: On master: Close
[0m18:23:34.607075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:34.607952 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae' was properly closed.
[0m18:23:34.608813 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42' was properly closed.
[0m18:23:34.609949 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb' was properly closed.
[0m18:23:34.610767 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa' was properly closed.
[0m18:23:34.611720 [info ] [MainThread]: 
[0m18:23:34.612626 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m18:23:34.617529 [debug] [MainThread]: Command end result
[0m18:23:34.618445 [info ] [MainThread]: 
[0m18:23:34.619596 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:23:34.620488 [info ] [MainThread]: 
[0m18:23:34.621437 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m18:23:34.622853 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9596546, "process_user_time": 3.603981, "process_kernel_time": 0.257351, "process_mem_max_rss": "114480", "process_out_blocks": "141", "process_in_blocks": "0"}
[0m18:23:34.623985 [debug] [MainThread]: Command `dbt test` succeeded at 18:23:34.623867 after 2.96 seconds
[0m18:23:34.624950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07edb50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07bbdc400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07c3c66a0>]}
[0m18:23:34.626017 [debug] [MainThread]: Flushing usage events
[0m18:23:38.689373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a509a10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a4e62b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a4e62b5e0>]}


============================== 18:23:38.697960 | 650e0eab-1b29-40fb-8149-f9a548cc59e4 ==============================
[0m18:23:38.697960 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:23:38.699441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models int_hourly_trades', 'send_anonymous_usage_stats': 'True'}
[0m18:23:38.937012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '650e0eab-1b29-40fb-8149-f9a548cc59e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a4e69a1c0>]}
[0m18:23:39.009760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '650e0eab-1b29-40fb-8149-f9a548cc59e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a4e65aa60>]}
[0m18:23:39.011119 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:23:39.040864 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:23:39.299201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:23:39.300425 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:23:39.375660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '650e0eab-1b29-40fb-8149-f9a548cc59e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a4d656130>]}
[0m18:23:39.400852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '650e0eab-1b29-40fb-8149-f9a548cc59e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a4d79c310>]}
[0m18:23:39.401984 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:23:39.402955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '650e0eab-1b29-40fb-8149-f9a548cc59e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a4d791130>]}
[0m18:23:39.405378 [info ] [MainThread]: 
[0m18:23:39.406951 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:23:39.412145 [debug] [MainThread]: Command end result
[0m18:23:39.413658 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.80581367, "process_user_time": 2.794208, "process_kernel_time": 0.145846, "process_mem_max_rss": "103992", "process_out_blocks": "11", "process_in_blocks": "0"}
[0m18:23:39.414811 [debug] [MainThread]: Command `dbt test` succeeded at 18:23:39.414678 after 0.81 seconds
[0m18:23:39.415771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a509a10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a4d262f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a4e65aa60>]}
[0m18:23:39.416788 [debug] [MainThread]: Flushing usage events
[0m18:23:43.928114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21d761040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21b3d9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21b3d97f0>]}


============================== 18:23:43.939512 | 406968fc-20fe-4fa0-ae0a-5a906c41b310 ==============================
[0m18:23:43.939512 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:23:43.941123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:23:44.207653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '406968fc-20fe-4fa0-ae0a-5a906c41b310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21b404a90>]}
[0m18:23:44.312052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '406968fc-20fe-4fa0-ae0a-5a906c41b310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21addbca0>]}
[0m18:23:44.313687 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:23:44.352539 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:23:44.563466 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:23:44.564510 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25
[0m18:23:44.565354 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:23:44.566303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '406968fc-20fe-4fa0-ae0a-5a906c41b310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21c7a2a90>]}
[0m18:23:46.631692 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:23:46.632900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '406968fc-20fe-4fa0-ae0a-5a906c41b310', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21a518d00>]}
[0m18:23:47.067243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '406968fc-20fe-4fa0-ae0a-5a906c41b310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21a95af70>]}
[0m18:23:47.084374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '406968fc-20fe-4fa0-ae0a-5a906c41b310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21a1422b0>]}
[0m18:23:47.085623 [info ] [MainThread]: Found 2 models, 18 data tests, 1 source, 540 macros
[0m18:23:47.086558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '406968fc-20fe-4fa0-ae0a-5a906c41b310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21a142dc0>]}
[0m18:23:47.089830 [info ] [MainThread]: 
[0m18:23:47.091288 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:23:47.098745 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m18:23:47.145087 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:23:47.146261 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m18:23:47.147172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:47.152695 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:23:47.153885 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m18:23:47.155170 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:23:47.158784 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m18:23:47.160880 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m18:23:47.162044 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m18:23:47.169986 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:47.171059 [debug] [MainThread]: On master: BEGIN
[0m18:23:47.171994 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:23:47.176800 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:23:47.177827 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:47.178979 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:23:47.187974 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m18:23:47.190256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '406968fc-20fe-4fa0-ae0a-5a906c41b310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21d2e7f10>]}
[0m18:23:47.191376 [debug] [MainThread]: On master: ROLLBACK
[0m18:23:47.192739 [debug] [MainThread]: On master: Close
[0m18:23:47.193875 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:23:47.194835 [info ] [MainThread]: 
[0m18:23:47.204761 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:23:47.206097 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m18:23:47.207193 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:23:47.220616 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m18:23:47.223260 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:23:47.225332 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m18:23:47.228980 [debug] [Thread-3  ]: Began running node model.dbt_btc_transform.int_hourly_trades
[0m18:23:47.229917 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:23:47.230768 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:23:47.231679 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:23:47.232695 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_btc_transform.int_hourly_trades'
[0m18:23:47.234508 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872'
[0m18:23:47.236032 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m18:23:47.237455 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_btc_transform.stg_kaggle__btcusdt, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb)
[0m18:23:47.238670 [debug] [Thread-3  ]: Began compiling node model.dbt_btc_transform.int_hourly_trades
[0m18:23:47.239871 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:23:47.240892 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:23:47.242097 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:23:47.248183 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_btc_transform.int_hourly_trades"
[0m18:23:47.255941 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m18:23:47.264451 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m18:23:47.279136 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m18:23:47.281779 [debug] [Thread-3  ]: Began executing node model.dbt_btc_transform.int_hourly_trades
[0m18:23:47.283667 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:23:47.285323 [debug] [Thread-3  ]: Finished running node model.dbt_btc_transform.int_hourly_trades
[0m18:23:47.286556 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:23:47.289588 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m18:23:47.291301 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:23:47.293746 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:23:47.295994 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m18:23:47.297524 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:23:47.299701 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m18:23:47.301231 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_btc_transform.int_hourly_trades, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a)
[0m18:23:47.303411 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:23:47.304980 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m18:23:47.306499 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:23:47.307755 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:23:47.308984 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m18:23:47.310263 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:23:47.311443 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m18:23:47.319631 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m18:23:47.320900 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:23:47.329896 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m18:23:47.331035 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:23:47.339131 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m18:23:47.340584 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:23:47.347686 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m18:23:47.349325 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:23:47.350917 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m18:23:47.352369 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:23:47.354030 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m18:23:47.355531 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:23:47.356288 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:23:47.357837 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m18:23:47.359024 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:23:47.360696 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m18:23:47.362622 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m18:23:47.364035 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:23:47.365512 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m18:23:47.366604 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:23:47.369019 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:23:47.370717 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m18:23:47.371956 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:23:47.378790 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m18:23:47.379921 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m18:23:47.381166 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:23:47.388511 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m18:23:47.390388 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:23:47.397435 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:23:47.398377 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m18:23:47.408731 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m18:23:47.409856 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:23:47.411110 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m18:23:47.414364 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m18:23:47.415315 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:23:47.416633 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:23:47.417615 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:23:47.418995 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:23:47.420962 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m18:23:47.422477 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m18:23:47.424017 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m18:23:47.425213 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m18:23:47.426408 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:23:47.427490 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:23:47.428770 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:23:47.429935 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:23:47.431037 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m18:23:47.437976 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m18:23:47.439355 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m18:23:47.445729 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m18:23:47.446881 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:23:47.448643 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:23:47.450607 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:23:47.457168 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m18:23:47.464510 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:23:47.463994 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m18:23:47.466538 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m18:23:47.468935 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m18:23:47.470511 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:23:47.471474 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:23:47.472740 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:23:47.473697 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:23:47.475044 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m18:23:47.476243 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m18:23:47.477337 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m18:23:47.478788 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m18:23:47.480213 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:23:47.481303 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:23:47.482377 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:23:47.484503 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m18:23:47.491689 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m18:23:47.503572 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m18:23:47.504699 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:23:47.512669 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m18:23:47.513579 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:23:47.514748 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:23:47.516502 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m18:23:47.517894 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:23:47.519324 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m18:23:47.521834 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m18:23:47.526350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:47.527227 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42' was properly closed.
[0m18:23:47.528035 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae' was properly closed.
[0m18:23:47.528957 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb' was properly closed.
[0m18:23:47.529878 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa' was properly closed.
[0m18:23:47.535186 [debug] [MainThread]: Command end result
[0m18:23:47.736953 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:23:47.737933 [info ] [MainThread]: Building catalog
[0m18:23:47.752904 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m18:23:47.763925 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m18:23:47.765009 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m18:23:47.765951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:47.770679 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:23:47.771609 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m18:23:47.772628 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_kaggle__btcusdt')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('btcusdt')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('int_hourly_trades')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:23:47.776673 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m18:23:47.784103 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m18:23:47.785391 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m18:23:47.880579 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m18:23:47.882248 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.0538807, "process_user_time": 5.846253, "process_kernel_time": 0.199142, "process_mem_max_rss": "191620", "process_out_blocks": "6560", "process_in_blocks": "0"}
[0m18:23:47.883498 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:23:47.883363 after 4.06 seconds
[0m18:23:47.884263 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:23:47.884921 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m18:23:47.885760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21d761040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21a0ba520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe21a4ea640>]}
[0m18:23:47.886666 [debug] [MainThread]: Flushing usage events
[0m19:18:25.629541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcced5550d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcceb1d9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcceb1d95b0>]}


============================== 19:18:25.638710 | dfc2b603-022e-4507-ab5d-61581be76cdb ==============================
[0m19:18:25.638710 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:18:25.640135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:18:25.859420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfc2b603-022e-4507-ab5d-61581be76cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcced118430>]}
[0m19:18:25.939859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfc2b603-022e-4507-ab5d-61581be76cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcceb397100>]}
[0m19:18:25.941290 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:18:25.973480 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m19:18:26.140537 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:18:26.141601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dfc2b603-022e-4507-ab5d-61581be76cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccec502880>]}
[0m19:18:28.295536 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:18:28.296742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dfc2b603-022e-4507-ab5d-61581be76cdb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccea38e5b0>]}
[0m19:18:28.781435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfc2b603-022e-4507-ab5d-61581be76cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccea783610>]}
[0m19:18:28.802590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfc2b603-022e-4507-ab5d-61581be76cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccea2daac0>]}
[0m19:18:28.804045 [info ] [MainThread]: Found 2 models, 26 data tests, 1 source, 540 macros
[0m19:18:28.805248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfc2b603-022e-4507-ab5d-61581be76cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccea2da610>]}
[0m19:18:28.808601 [info ] [MainThread]: 
[0m19:18:28.810502 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:18:28.813263 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m19:18:28.871260 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m19:18:28.872272 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m19:18:28.873168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:28.879170 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m19:18:28.881237 [debug] [ThreadPool]: On list_company_dw: Close
[0m19:18:28.888457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m19:18:28.899607 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:18:28.900768 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m19:18:28.901947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:28.907144 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:18:28.908185 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:18:28.909171 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m19:18:28.912911 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m19:18:28.915046 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m19:18:28.916199 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m19:18:28.923995 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:28.924945 [debug] [MainThread]: On master: BEGIN
[0m19:18:28.925768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:18:28.930357 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:18:28.931381 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:28.932495 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:18:28.940575 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m19:18:28.943099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfc2b603-022e-4507-ab5d-61581be76cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccea36d760>]}
[0m19:18:28.944130 [debug] [MainThread]: On master: ROLLBACK
[0m19:18:28.945332 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:28.946188 [debug] [MainThread]: On master: BEGIN
[0m19:18:28.947526 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:18:28.948433 [debug] [MainThread]: On master: COMMIT
[0m19:18:28.949260 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:28.950087 [debug] [MainThread]: On master: COMMIT
[0m19:18:28.951162 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:18:28.952005 [debug] [MainThread]: On master: Close
[0m19:18:28.953158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:18:28.954099 [info ] [MainThread]: 
[0m19:18:28.963365 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m19:18:28.964600 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m19:18:28.965804 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m19:18:28.966882 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m19:18:28.979680 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:18:28.983194 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m19:18:29.037791 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:18:29.041996 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:18:29.042975 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m19:18:29.043955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:18:29.048765 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m19:18:29.049905 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:18:29.051064 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    -- I hate just putting a distinct to deal with duplicates but doing this because there are dupes in the source data.
    -- I would rather investigate why this is happening at the source and fix there but need to work
    -- with what was given
    select distinct 
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote_asset_volume,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        open_time::date as open_date,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minutes from open_time) = 0
            and extract(second from open_time) = 0
                then true
            else false
        end as hour_start,

        case    
            when extract(minutes from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as hour_end
            

    from source

)

select * from final
  );
  
[0m19:18:30.897483 [debug] [Thread-1  ]: SQL status: SELECT 999963 in 1.845 seconds
[0m19:18:30.908754 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:18:30.909990 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt" rename to "stg_kaggle__btcusdt__dbt_backup"
[0m19:18:30.911488 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:18:30.917077 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:18:30.918179 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp" rename to "stg_kaggle__btcusdt"
[0m19:18:30.919969 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:18:30.949227 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m19:18:30.950245 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:18:30.951197 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m19:18:30.960781 [debug] [Thread-1  ]: SQL status: COMMIT in 0.009 seconds
[0m19:18:30.970707 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup"
[0m19:18:30.976803 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:18:30.977791 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
drop table if exists "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup" cascade
[0m19:18:30.994873 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.016 seconds
[0m19:18:30.998468 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m19:18:31.001317 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfc2b603-022e-4507-ab5d-61581be76cdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce9329b50>]}
[0m19:18:31.003882 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.stg_kaggle__btcusdt ................ [[32mSELECT 999963[0m in 2.03s]
[0m19:18:31.005344 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m19:18:31.008348 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:31.009407 [debug] [MainThread]: On master: BEGIN
[0m19:18:31.010306 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:18:31.015007 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:18:31.016175 [debug] [MainThread]: On master: COMMIT
[0m19:18:31.017102 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:31.017953 [debug] [MainThread]: On master: COMMIT
[0m19:18:31.019075 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:18:31.019914 [debug] [MainThread]: On master: Close
[0m19:18:31.020949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:31.021748 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m19:18:31.022632 [info ] [MainThread]: 
[0m19:18:31.023559 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m19:18:31.025021 [debug] [MainThread]: Command end result
[0m19:18:31.025915 [info ] [MainThread]: 
[0m19:18:31.026949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:18:31.027831 [info ] [MainThread]: 
[0m19:18:31.028681 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:18:31.030224 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.471124, "process_user_time": 5.388569, "process_kernel_time": 0.16476, "process_mem_max_rss": "116200", "process_out_blocks": "1222", "process_in_blocks": "0"}
[0m19:18:31.031583 [debug] [MainThread]: Command `dbt run` succeeded at 19:18:31.031398 after 5.47 seconds
[0m19:18:31.032511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcced5550d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccea2daac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccea36d790>]}
[0m19:18:31.033475 [debug] [MainThread]: Flushing usage events
[0m19:18:34.913375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a13e8b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a11b19610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a11b195b0>]}


============================== 19:18:34.920914 | 6566309b-0229-4656-8d14-6be8db9f4ab7 ==============================
[0m19:18:34.920914 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:18:34.922106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models stg_kaggle__btcusdt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:18:35.141648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6566309b-0229-4656-8d14-6be8db9f4ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a13a58430>]}
[0m19:18:35.211380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6566309b-0229-4656-8d14-6be8db9f4ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a11cd7100>]}
[0m19:18:35.212804 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:18:35.244265 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m19:18:35.496633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:18:35.497495 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:18:35.573148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6566309b-0229-4656-8d14-6be8db9f4ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a10931df0>]}
[0m19:18:35.600228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6566309b-0229-4656-8d14-6be8db9f4ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a10ced370>]}
[0m19:18:35.601311 [info ] [MainThread]: Found 2 models, 26 data tests, 1 source, 540 macros
[0m19:18:35.602253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6566309b-0229-4656-8d14-6be8db9f4ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a10ced490>]}
[0m19:18:35.605522 [info ] [MainThread]: 
[0m19:18:35.606910 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:18:35.615784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analytics'
[0m19:18:35.726553 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:18:35.727555 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m19:18:35.728520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:35.733941 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:18:35.734923 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:18:35.735888 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m19:18:35.739448 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m19:18:35.741452 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m19:18:35.742575 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m19:18:35.750199 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:35.751077 [debug] [MainThread]: On master: BEGIN
[0m19:18:35.751879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:18:35.756665 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:18:35.757986 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:35.759093 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:18:35.766889 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m19:18:35.768742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6566309b-0229-4656-8d14-6be8db9f4ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1096ee20>]}
[0m19:18:35.769887 [debug] [MainThread]: On master: ROLLBACK
[0m19:18:35.770988 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:35.771749 [debug] [MainThread]: On master: BEGIN
[0m19:18:35.773199 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:18:35.774164 [debug] [MainThread]: On master: COMMIT
[0m19:18:35.774956 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:35.775763 [debug] [MainThread]: On master: COMMIT
[0m19:18:35.776949 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:18:35.777738 [debug] [MainThread]: On master: Close
[0m19:18:35.778923 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:18:35.779777 [info ] [MainThread]: 
[0m19:18:35.789375 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m19:18:35.790183 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m19:18:35.790933 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m19:18:35.791665 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m19:18:35.792622 [info ] [Thread-1  ]: 1 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_end__True__False ... [RUN]
[0m19:18:35.793868 [info ] [Thread-2  ]: 2 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_start__True__False . [RUN]
[0m19:18:35.795024 [info ] [Thread-3  ]: 3 of 18 START test not_null_stg_kaggle__btcusdt_close .......................... [RUN]
[0m19:18:35.796083 [info ] [Thread-4  ]: 4 of 18 START test not_null_stg_kaggle__btcusdt_close_time ..................... [RUN]
[0m19:18:35.797207 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872)
[0m19:18:35.798312 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m19:18:35.799671 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb'
[0m19:18:35.800931 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a'
[0m19:18:35.801982 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m19:18:35.803040 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m19:18:35.803979 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m19:18:35.805012 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m19:18:35.833719 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m19:18:35.836385 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m19:18:35.847744 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m19:18:35.853399 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m19:18:35.858145 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m19:18:35.859047 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m19:18:35.866358 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m19:18:35.885239 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m19:18:35.884523 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m19:18:35.889445 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m19:18:35.895643 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m19:18:35.899530 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m19:18:35.903205 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m19:18:35.904658 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: BEGIN
[0m19:18:35.905423 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m19:18:35.906130 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m19:18:35.907133 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:18:35.907925 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m19:18:35.908782 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: BEGIN
[0m19:18:35.909873 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: BEGIN
[0m19:18:35.911591 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: BEGIN
[0m19:18:35.913953 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:18:35.915167 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:18:35.916607 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:18:35.917922 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m19:18:35.921480 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m19:18:35.922708 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_end as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_end

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m19:18:35.924364 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m19:18:35.925602 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m19:18:35.926687 [debug] [Thread-3  ]: SQL status: BEGIN in 0.012 seconds
[0m19:18:35.928514 [debug] [Thread-4  ]: SQL status: BEGIN in 0.012 seconds
[0m19:18:35.930453 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_start as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_start

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m19:18:35.931776 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m19:18:35.933013 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m19:18:35.934693 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close is null



      
    ) dbt_internal_test
[0m19:18:35.936291 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is null



      
    ) dbt_internal_test
[0m19:18:36.040233 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.116 seconds
[0m19:18:36.049612 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: ROLLBACK
[0m19:18:36.050464 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.113 seconds
[0m19:18:36.051169 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.113 seconds
[0m19:18:36.051965 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.118 seconds
[0m19:18:36.053250 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: Close
[0m19:18:36.055302 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: ROLLBACK
[0m19:18:36.057582 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: ROLLBACK
[0m19:18:36.060002 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: ROLLBACK
[0m19:18:36.061459 [info ] [Thread-1  ]: 1 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_end__True__False ......... [[32mPASS[0m in 0.26s]
[0m19:18:36.062945 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: Close
[0m19:18:36.063989 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: Close
[0m19:18:36.065134 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: Close
[0m19:18:36.066125 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m19:18:36.067537 [info ] [Thread-3  ]: 3 of 18 PASS not_null_stg_kaggle__btcusdt_close ................................ [[32mPASS[0m in 0.27s]
[0m19:18:36.069076 [info ] [Thread-4  ]: 4 of 18 PASS not_null_stg_kaggle__btcusdt_close_time ........................... [[32mPASS[0m in 0.27s]
[0m19:18:36.070439 [info ] [Thread-2  ]: 2 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_start__True__False ....... [[32mPASS[0m in 0.27s]
[0m19:18:36.071607 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m19:18:36.073182 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m19:18:36.074385 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m19:18:36.075623 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m19:18:36.076770 [info ] [Thread-1  ]: 5 of 18 START test not_null_stg_kaggle__btcusdt_high ........................... [RUN]
[0m19:18:36.078101 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m19:18:36.079201 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m19:18:36.080363 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m19:18:36.081474 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m19:18:36.082572 [info ] [Thread-3  ]: 6 of 18 START test not_null_stg_kaggle__btcusdt_hour_end ....................... [RUN]
[0m19:18:36.083727 [info ] [Thread-4  ]: 7 of 18 START test not_null_stg_kaggle__btcusdt_hour_start ..................... [RUN]
[0m19:18:36.085025 [info ] [Thread-2  ]: 8 of 18 START test not_null_stg_kaggle__btcusdt_low ............................ [RUN]
[0m19:18:36.086193 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m19:18:36.087218 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m19:18:36.088313 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m19:18:36.089338 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m19:18:36.095624 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m19:18:36.096896 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m19:18:36.097967 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m19:18:36.099052 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m19:18:36.105760 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m19:18:36.112428 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m19:18:36.119172 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m19:18:36.118761 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m19:18:36.126482 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m19:18:36.127765 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m19:18:36.128454 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m19:18:36.134111 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m19:18:36.134904 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m19:18:36.138766 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m19:18:36.139677 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m19:18:36.144316 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m19:18:36.145803 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m19:18:36.146549 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: BEGIN
[0m19:18:36.147992 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m19:18:36.148959 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: BEGIN
[0m19:18:36.150014 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:18:36.150657 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m19:18:36.151704 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: BEGIN
[0m19:18:36.153002 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:18:36.154651 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: BEGIN
[0m19:18:36.155863 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:18:36.157564 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:18:36.158473 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m19:18:36.161033 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m19:18:36.161946 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m19:18:36.163058 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where high is null



      
    ) dbt_internal_test
[0m19:18:36.163965 [debug] [Thread-4  ]: SQL status: BEGIN in 0.008 seconds
[0m19:18:36.165154 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m19:18:36.165939 [debug] [Thread-2  ]: SQL status: BEGIN in 0.008 seconds
[0m19:18:36.167300 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m19:18:36.168426 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_end
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_end is null



      
    ) dbt_internal_test
[0m19:18:36.169680 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m19:18:36.170949 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_start
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_start is null



      
    ) dbt_internal_test
[0m19:18:36.172885 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where low is null



      
    ) dbt_internal_test
[0m19:18:36.223495 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.056 seconds
[0m19:18:36.227070 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: ROLLBACK
[0m19:18:36.228942 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: Close
[0m19:18:36.231181 [info ] [Thread-1  ]: 5 of 18 PASS not_null_stg_kaggle__btcusdt_high ................................. [[32mPASS[0m in 0.15s]
[0m19:18:36.233506 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m19:18:36.235300 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m19:18:36.237099 [info ] [Thread-1  ]: 9 of 18 START test not_null_stg_kaggle__btcusdt_number_of_trades ............... [RUN]
[0m19:18:36.238618 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m19:18:36.240089 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m19:18:36.250080 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m19:18:36.254117 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m19:18:36.259264 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m19:18:36.260076 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.088 seconds
[0m19:18:36.260903 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.087 seconds
[0m19:18:36.264390 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: ROLLBACK
[0m19:18:36.265546 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.087 seconds
[0m19:18:36.269504 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: ROLLBACK
[0m19:18:36.271055 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m19:18:36.272963 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: Close
[0m19:18:36.276725 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: ROLLBACK
[0m19:18:36.278486 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: Close
[0m19:18:36.279272 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: BEGIN
[0m19:18:36.280780 [info ] [Thread-3  ]: 6 of 18 PASS not_null_stg_kaggle__btcusdt_hour_end ............................. [[32mPASS[0m in 0.19s]
[0m19:18:36.282377 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: Close
[0m19:18:36.283617 [info ] [Thread-4  ]: 7 of 18 PASS not_null_stg_kaggle__btcusdt_hour_start ........................... [[32mPASS[0m in 0.20s]
[0m19:18:36.284770 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:18:36.286299 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m19:18:36.287805 [info ] [Thread-2  ]: 8 of 18 PASS not_null_stg_kaggle__btcusdt_low .................................. [[32mPASS[0m in 0.20s]
[0m19:18:36.289219 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m19:18:36.291197 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m19:18:36.292672 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m19:18:36.294624 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m19:18:36.296504 [info ] [Thread-3  ]: 10 of 18 START test not_null_stg_kaggle__btcusdt_open .......................... [RUN]
[0m19:18:36.297594 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m19:18:36.299118 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m19:18:36.300701 [info ] [Thread-4  ]: 11 of 18 START test not_null_stg_kaggle__btcusdt_open_date ..................... [RUN]
[0m19:18:36.302296 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m19:18:36.303489 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m19:18:36.304696 [info ] [Thread-2  ]: 12 of 18 START test not_null_stg_kaggle__btcusdt_open_time ..................... [RUN]
[0m19:18:36.306091 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m19:18:36.307193 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m19:18:36.308297 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select number_of_trades
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where number_of_trades is null



      
    ) dbt_internal_test
[0m19:18:36.309358 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m19:18:36.310418 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m19:18:36.317977 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m19:18:36.319473 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m19:18:36.326031 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m19:18:36.333306 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m19:18:36.334755 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m19:18:36.336422 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m19:18:36.340770 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m19:18:36.342127 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m19:18:36.346404 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m19:18:36.351764 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m19:18:36.353703 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m19:18:36.356062 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: BEGIN
[0m19:18:36.356927 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m19:18:36.357944 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:18:36.358924 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m19:18:36.360047 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: BEGIN
[0m19:18:36.361671 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.043 seconds
[0m19:18:36.362571 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: BEGIN
[0m19:18:36.363889 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:18:36.367014 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: ROLLBACK
[0m19:18:36.367812 [debug] [Thread-3  ]: SQL status: BEGIN in 0.010 seconds
[0m19:18:36.368750 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:18:36.371007 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: Close
[0m19:18:36.371765 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m19:18:36.374256 [info ] [Thread-1  ]: 9 of 18 PASS not_null_stg_kaggle__btcusdt_number_of_trades ..................... [[32mPASS[0m in 0.14s]
[0m19:18:36.375262 [debug] [Thread-4  ]: SQL status: BEGIN in 0.011 seconds
[0m19:18:36.376324 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open is null



      
    ) dbt_internal_test
[0m19:18:36.377635 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m19:18:36.378445 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m19:18:36.379340 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m19:18:36.380878 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m19:18:36.382047 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m19:18:36.383301 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_date
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_date is null



      
    ) dbt_internal_test
[0m19:18:36.384522 [info ] [Thread-1  ]: 13 of 18 START test not_null_stg_kaggle__btcusdt_quote_asset_volume ............ [RUN]
[0m19:18:36.385887 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is null



      
    ) dbt_internal_test
[0m19:18:36.387414 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m19:18:36.389459 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m19:18:36.402489 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m19:18:36.405951 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m19:18:36.413456 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m19:18:36.416746 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m19:18:36.418634 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: BEGIN
[0m19:18:36.420315 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:18:36.429045 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m19:18:36.431020 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m19:18:36.432808 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where quote_asset_volume is null



      
    ) dbt_internal_test
[0m19:18:36.437322 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.056 seconds
[0m19:18:36.444716 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: ROLLBACK
[0m19:18:36.447308 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: Close
[0m19:18:36.450464 [info ] [Thread-3  ]: 10 of 18 PASS not_null_stg_kaggle__btcusdt_open ................................ [[32mPASS[0m in 0.15s]
[0m19:18:36.452347 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.063 seconds
[0m19:18:36.454951 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m19:18:36.459868 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: ROLLBACK
[0m19:18:36.462505 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m19:18:36.465230 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: Close
[0m19:18:36.467096 [info ] [Thread-3  ]: 14 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ... [RUN]
[0m19:18:36.470112 [info ] [Thread-2  ]: 12 of 18 PASS not_null_stg_kaggle__btcusdt_open_time ........................... [[32mPASS[0m in 0.16s]
[0m19:18:36.472284 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m19:18:36.475083 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m19:18:36.476229 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.089 seconds
[0m19:18:36.477538 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m19:18:36.479373 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m19:18:36.482875 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: ROLLBACK
[0m19:18:36.490993 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m19:18:36.492374 [info ] [Thread-2  ]: 15 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume .. [RUN]
[0m19:18:36.494310 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: Close
[0m19:18:36.495760 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m19:18:36.497440 [info ] [Thread-4  ]: 11 of 18 PASS not_null_stg_kaggle__btcusdt_open_date ........................... [[32mPASS[0m in 0.19s]
[0m19:18:36.498709 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m19:18:36.499852 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m19:18:36.501911 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m19:18:36.502975 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.068 seconds
[0m19:18:36.508043 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m19:18:36.516186 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m19:18:36.517667 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m19:18:36.520623 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: ROLLBACK
[0m19:18:36.523743 [info ] [Thread-4  ]: 16 of 18 START test not_null_stg_kaggle__btcusdt_volume ........................ [RUN]
[0m19:18:36.525079 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m19:18:36.526332 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m19:18:36.527461 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: Close
[0m19:18:36.528601 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m19:18:36.529788 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: BEGIN
[0m19:18:36.534578 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m19:18:36.536289 [info ] [Thread-1  ]: 13 of 18 PASS not_null_stg_kaggle__btcusdt_quote_asset_volume .................. [[32mPASS[0m in 0.15s]
[0m19:18:36.537640 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m19:18:36.538829 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:18:36.541120 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m19:18:36.548359 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m19:18:36.550173 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m19:18:36.552300 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m19:18:36.553737 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: BEGIN
[0m19:18:36.555580 [info ] [Thread-1  ]: 17 of 18 START test unique_stg_kaggle__btcusdt_close_time ...................... [RUN]
[0m19:18:36.556624 [debug] [Thread-3  ]: SQL status: BEGIN in 0.018 seconds
[0m19:18:36.557665 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:18:36.559036 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m19:18:36.559919 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m19:18:36.560929 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m19:18:36.562684 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m19:18:36.567892 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m19:18:36.569350 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_base_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_base_asset_volume is null



      
    ) dbt_internal_test
[0m19:18:36.570352 [debug] [Thread-2  ]: SQL status: BEGIN in 0.013 seconds
[0m19:18:36.579732 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m19:18:36.582092 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m19:18:36.583546 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m19:18:36.585276 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_quote_asset_volume is null



      
    ) dbt_internal_test
[0m19:18:36.586983 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: BEGIN
[0m19:18:36.587894 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m19:18:36.589442 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:18:36.596578 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m19:18:36.601143 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m19:18:36.603171 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: BEGIN
[0m19:18:36.604755 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:18:36.606255 [debug] [Thread-4  ]: SQL status: BEGIN in 0.017 seconds
[0m19:18:36.608571 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m19:18:36.610323 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where volume is null



      
    ) dbt_internal_test
[0m19:18:36.613055 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m19:18:36.614746 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m19:18:36.616501 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    close_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is not null
group by close_time
having count(*) > 1



      
    ) dbt_internal_test
[0m19:18:36.655009 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.073 seconds
[0m19:18:36.659799 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: ROLLBACK
[0m19:18:36.662199 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: Close
[0m19:18:36.664645 [info ] [Thread-3  ]: 14 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ......... [[32mPASS[0m in 0.19s]
[0m19:18:36.667758 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m19:18:36.669706 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m19:18:36.671110 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.082 seconds
[0m19:18:36.672524 [info ] [Thread-3  ]: 18 of 18 START test unique_stg_kaggle__btcusdt_open_time ....................... [RUN]
[0m19:18:36.675901 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: ROLLBACK
[0m19:18:36.678164 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m19:18:36.680231 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: Close
[0m19:18:36.683532 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m19:18:36.686015 [info ] [Thread-2  ]: 15 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume ........ [[32mPASS[0m in 0.19s]
[0m19:18:36.687597 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.076 seconds
[0m19:18:36.694871 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m19:18:36.696380 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m19:18:36.699521 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: ROLLBACK
[0m19:18:36.702789 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m19:18:36.703902 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: Close
[0m19:18:36.708644 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m19:18:36.710430 [info ] [Thread-4  ]: 16 of 18 PASS not_null_stg_kaggle__btcusdt_volume .............................. [[32mPASS[0m in 0.18s]
[0m19:18:36.713136 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m19:18:36.715128 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m19:18:36.717202 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: BEGIN
[0m19:18:36.719131 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:18:36.726663 [debug] [Thread-3  ]: SQL status: BEGIN in 0.008 seconds
[0m19:18:36.728065 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m19:18:36.729470 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    open_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is not null
group by open_time
having count(*) > 1



      
    ) dbt_internal_test
[0m19:18:37.596708 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.866 seconds
[0m19:18:37.600101 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: ROLLBACK
[0m19:18:37.601790 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: Close
[0m19:18:37.603622 [info ] [Thread-3  ]: 18 of 18 PASS unique_stg_kaggle__btcusdt_open_time ............................. [[32mPASS[0m in 0.93s]
[0m19:18:37.605481 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m19:18:37.737260 [debug] [Thread-1  ]: SQL status: SELECT 1 in 1.119 seconds
[0m19:18:37.739777 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: ROLLBACK
[0m19:18:37.741665 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: Close
[0m19:18:37.743344 [info ] [Thread-1  ]: 17 of 18 PASS unique_stg_kaggle__btcusdt_close_time ............................ [[32mPASS[0m in 1.18s]
[0m19:18:37.744758 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m19:18:37.748347 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:37.749451 [debug] [MainThread]: On master: BEGIN
[0m19:18:37.750322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:18:37.755269 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:18:37.756357 [debug] [MainThread]: On master: COMMIT
[0m19:18:37.757371 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:37.758295 [debug] [MainThread]: On master: COMMIT
[0m19:18:37.759487 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:18:37.760496 [debug] [MainThread]: On master: Close
[0m19:18:37.761618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:37.762692 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb' was properly closed.
[0m19:18:37.763638 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42' was properly closed.
[0m19:18:37.764546 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa' was properly closed.
[0m19:18:37.765506 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae' was properly closed.
[0m19:18:37.766740 [info ] [MainThread]: 
[0m19:18:37.767953 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m19:18:37.772887 [debug] [MainThread]: Command end result
[0m19:18:37.773840 [info ] [MainThread]: 
[0m19:18:37.774966 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:18:37.775911 [info ] [MainThread]: 
[0m19:18:37.776892 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m19:18:37.778416 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9400053, "process_user_time": 3.406003, "process_kernel_time": 0.216531, "process_mem_max_rss": "114224", "process_out_blocks": "142", "process_in_blocks": "0"}
[0m19:18:37.779587 [debug] [MainThread]: Command `dbt test` succeeded at 19:18:37.779444 after 2.94 seconds
[0m19:18:37.780593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a13e8b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a114b0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a10515dc0>]}
[0m19:18:37.781585 [debug] [MainThread]: Flushing usage events
[0m19:18:41.360334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb2e80b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb2c4a4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb2c4a45b0>]}


============================== 19:18:41.367979 | 06f14cfb-217a-4685-bbd3-4fa76dafb316 ==============================
[0m19:18:41.367979 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:18:41.369196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models fct_hourly_trades', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:18:41.591323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06f14cfb-217a-4685-bbd3-4fa76dafb316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb2e3d8430>]}
[0m19:18:41.661207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06f14cfb-217a-4685-bbd3-4fa76dafb316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb2c669100>]}
[0m19:18:41.662595 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:18:41.691828 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m19:18:41.945662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:18:41.946497 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:18:42.018633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06f14cfb-217a-4685-bbd3-4fa76dafb316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb2b4f2df0>]}
[0m19:18:42.032981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06f14cfb-217a-4685-bbd3-4fa76dafb316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb2b497d30>]}
[0m19:18:42.034129 [info ] [MainThread]: Found 2 models, 26 data tests, 1 source, 540 macros
[0m19:18:42.035031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06f14cfb-217a-4685-bbd3-4fa76dafb316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb2b99c730>]}
[0m19:18:42.037403 [info ] [MainThread]: 
[0m19:18:42.038577 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:18:42.040670 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m19:18:42.156603 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m19:18:42.157742 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m19:18:42.158742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:42.164916 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m19:18:42.167089 [debug] [ThreadPool]: On list_company_dw: Close
[0m19:18:42.174225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m19:18:42.183627 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:18:42.184615 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m19:18:42.185514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:42.190143 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:18:42.191059 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:18:42.191976 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m19:18:42.195414 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m19:18:42.197426 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m19:18:42.198538 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m19:18:42.206330 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:42.207415 [debug] [MainThread]: On master: BEGIN
[0m19:18:42.208368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:18:42.213016 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:18:42.213945 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:42.215061 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:18:42.223170 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m19:18:42.225103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06f14cfb-217a-4685-bbd3-4fa76dafb316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb2b4dec70>]}
[0m19:18:42.226091 [debug] [MainThread]: On master: ROLLBACK
[0m19:18:42.227173 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:42.228007 [debug] [MainThread]: On master: BEGIN
[0m19:18:42.229700 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:18:42.230571 [debug] [MainThread]: On master: COMMIT
[0m19:18:42.231397 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:42.232178 [debug] [MainThread]: On master: COMMIT
[0m19:18:42.233209 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:18:42.234133 [debug] [MainThread]: On master: Close
[0m19:18:42.235291 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:18:42.236381 [info ] [MainThread]: 
[0m19:18:42.245726 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.fct_hourly_trades
[0m19:18:42.247060 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.fct_hourly_trades ....................... [RUN]
[0m19:18:42.248249 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.fct_hourly_trades)
[0m19:18:42.249268 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.fct_hourly_trades
[0m19:18:42.261775 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.fct_hourly_trades"
[0m19:18:42.266186 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.fct_hourly_trades
[0m19:18:42.323385 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.fct_hourly_trades"
[0m19:18:42.326004 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m19:18:42.326927 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: BEGIN
[0m19:18:42.327740 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:18:42.333058 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m19:18:42.334077 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m19:18:42.335089 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.fct_hourly_trades"} */

  
    

  create  table "company_dw"."analytics"."fct_hourly_trades__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."analytics"."stg_kaggle__btcusdt"

),


hourly as (

    select
        open_date,
        extract(hours from open_time) as open_hour,

        max(
            case
                when hour_start is true
                    then open
            end 
        ) as open_price,

        max(
            case
                when hour_end is true
                    then close
            end
        ) as close_price

    from source

    where
        hour_start is true or hour_end is true
    
    group by 1, 2

),


final as (

    select
        open_date,
        open_hour,
        open_price,
        close_price,       
        (close_price - open_price) * 1.00000000000000 / open_price as percent_gain

    from hourly

    where 
        open_price is not null
        and close_price is not null

)

select * from final
  );
  
[0m19:18:42.391927 [debug] [Thread-1  ]: SQL status: SELECT 276 in 0.056 seconds
[0m19:18:42.402261 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m19:18:42.403577 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.fct_hourly_trades"} */
alter table "company_dw"."analytics"."fct_hourly_trades__dbt_tmp" rename to "fct_hourly_trades"
[0m19:18:42.405327 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:18:42.431407 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: COMMIT
[0m19:18:42.432494 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m19:18:42.433477 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: COMMIT
[0m19:18:42.436027 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m19:18:42.446563 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."fct_hourly_trades__dbt_backup"
[0m19:18:42.454330 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m19:18:42.455526 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.fct_hourly_trades"} */
drop table if exists "company_dw"."analytics"."fct_hourly_trades__dbt_backup" cascade
[0m19:18:42.457347 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m19:18:42.461044 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: Close
[0m19:18:42.463600 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f14cfb-217a-4685-bbd3-4fa76dafb316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb2ac9fac0>]}
[0m19:18:42.465289 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.fct_hourly_trades .................. [[32mSELECT 276[0m in 0.21s]
[0m19:18:42.466669 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.fct_hourly_trades
[0m19:18:42.470152 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:42.471126 [debug] [MainThread]: On master: BEGIN
[0m19:18:42.472007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:18:42.477625 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m19:18:42.478670 [debug] [MainThread]: On master: COMMIT
[0m19:18:42.479611 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:42.480515 [debug] [MainThread]: On master: COMMIT
[0m19:18:42.481688 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:18:42.482571 [debug] [MainThread]: On master: Close
[0m19:18:42.483800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:42.485709 [debug] [MainThread]: Connection 'model.dbt_btc_transform.fct_hourly_trades' was properly closed.
[0m19:18:42.486701 [info ] [MainThread]: 
[0m19:18:42.487908 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m19:18:42.489343 [debug] [MainThread]: Command end result
[0m19:18:42.490223 [info ] [MainThread]: 
[0m19:18:42.491177 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:18:42.492100 [info ] [MainThread]: 
[0m19:18:42.493041 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:18:42.494476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2232114, "process_user_time": 2.997351, "process_kernel_time": 0.163917, "process_mem_max_rss": "109540", "process_out_blocks": "40", "process_in_blocks": "0"}
[0m19:18:42.495507 [debug] [MainThread]: Command `dbt run` succeeded at 19:18:42.495384 after 1.22 seconds
[0m19:18:42.496360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb2e80b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb2c14d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb2b497310>]}
[0m19:18:42.497321 [debug] [MainThread]: Flushing usage events
[0m19:18:47.745150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee9548100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee71d26a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee71d2640>]}


============================== 19:18:47.752834 | 3297c38d-c15d-4962-8ae1-2b9150ffde6b ==============================
[0m19:18:47.752834 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:18:47.754120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models fct_hourly_trades', 'send_anonymous_usage_stats': 'True'}
[0m19:18:47.972099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3297c38d-c15d-4962-8ae1-2b9150ffde6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee71f83d0>]}
[0m19:18:48.045280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3297c38d-c15d-4962-8ae1-2b9150ffde6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee9ad0df0>]}
[0m19:18:48.046658 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:18:48.076539 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m19:18:48.327776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:18:48.328642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:18:48.400740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3297c38d-c15d-4962-8ae1-2b9150ffde6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee5ff0e20>]}
[0m19:18:48.426055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3297c38d-c15d-4962-8ae1-2b9150ffde6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee63af3a0>]}
[0m19:18:48.427193 [info ] [MainThread]: Found 2 models, 26 data tests, 1 source, 540 macros
[0m19:18:48.428110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3297c38d-c15d-4962-8ae1-2b9150ffde6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee63af4c0>]}
[0m19:18:48.430812 [info ] [MainThread]: 
[0m19:18:48.432031 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:18:48.441242 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analytics'
[0m19:18:48.560741 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:18:48.561777 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m19:18:48.562772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:48.567855 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:18:48.568999 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:18:48.570007 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m19:18:48.573435 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m19:18:48.575591 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m19:18:48.576776 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m19:18:48.584859 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:48.585776 [debug] [MainThread]: On master: BEGIN
[0m19:18:48.586911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:18:48.591907 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:18:48.592989 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:48.594126 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:18:48.602982 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m19:18:48.604940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3297c38d-c15d-4962-8ae1-2b9150ffde6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee90f1dc0>]}
[0m19:18:48.605912 [debug] [MainThread]: On master: ROLLBACK
[0m19:18:48.607107 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:48.607965 [debug] [MainThread]: On master: BEGIN
[0m19:18:48.609301 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:18:48.610052 [debug] [MainThread]: On master: COMMIT
[0m19:18:48.610868 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:48.611682 [debug] [MainThread]: On master: COMMIT
[0m19:18:48.612792 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:18:48.613675 [debug] [MainThread]: On master: Close
[0m19:18:48.614881 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:18:48.615843 [info ] [MainThread]: 
[0m19:18:48.625919 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:18:48.626781 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:18:48.627544 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:18:48.628474 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:18:48.629232 [info ] [Thread-1  ]: 1 of 8 START test accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23  [RUN]
[0m19:18:48.630379 [info ] [Thread-2  ]: 2 of 8 START test dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour  [RUN]
[0m19:18:48.631766 [info ] [Thread-3  ]: 3 of 8 START test not_null_fct_hourly_trades_close_price ....................... [RUN]
[0m19:18:48.632988 [info ] [Thread-4  ]: 4 of 8 START test not_null_fct_hourly_trades_open_date ......................... [RUN]
[0m19:18:48.634175 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433)
[0m19:18:48.635397 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf'
[0m19:18:48.636726 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523'
[0m19:18:48.638155 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d'
[0m19:18:48.639200 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:18:48.640179 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:18:48.641195 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:18:48.642172 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:18:48.666655 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m19:18:48.681315 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m19:18:48.695043 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m19:18:48.703165 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m19:18:48.711690 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:18:48.712717 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:18:48.732398 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:18:48.739248 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:18:48.754296 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m19:18:48.751824 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m19:18:48.759011 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m19:18:48.763153 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m19:18:48.767935 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m19:18:48.769194 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m19:18:48.770560 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: BEGIN
[0m19:18:48.771570 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m19:18:48.772546 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m19:18:48.773501 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: BEGIN
[0m19:18:48.774523 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:18:48.775632 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: BEGIN
[0m19:18:48.777146 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: BEGIN
[0m19:18:48.778218 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:18:48.779838 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:18:48.781098 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:18:48.783777 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m19:18:48.785785 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m19:18:48.787906 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price
from "company_dw"."analytics"."fct_hourly_trades"
where close_price is null



      
    ) dbt_internal_test
[0m19:18:48.788899 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m19:18:48.789858 [debug] [Thread-2  ]: SQL status: BEGIN in 0.012 seconds
[0m19:18:48.790688 [debug] [Thread-4  ]: SQL status: BEGIN in 0.010 seconds
[0m19:18:48.792069 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m19:18:48.792950 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m19:18:48.794043 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m19:18:48.795117 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m19:18:48.796347 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        open_hour as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."fct_hourly_trades"
    group by open_hour

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23'
)



      
    ) dbt_internal_test
[0m19:18:48.803229 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: ROLLBACK
[0m19:18:48.804337 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        open_date, open_hour
    from "company_dw"."analytics"."fct_hourly_trades"
    group by open_date, open_hour
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m19:18:48.805610 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_date
from "company_dw"."analytics"."fct_hourly_trades"
where open_date is null



      
    ) dbt_internal_test
[0m19:18:48.807981 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: Close
[0m19:18:48.808990 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m19:18:48.811264 [info ] [Thread-3  ]: 3 of 8 PASS not_null_fct_hourly_trades_close_price ............................. [[32mPASS[0m in 0.17s]
[0m19:18:48.812582 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.004 seconds
[0m19:18:48.813443 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.003 seconds
[0m19:18:48.815794 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: ROLLBACK
[0m19:18:48.817330 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:18:48.820221 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: ROLLBACK
[0m19:18:48.823046 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: ROLLBACK
[0m19:18:48.824717 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: Close
[0m19:18:48.825733 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:18:48.827443 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: Close
[0m19:18:48.828675 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: Close
[0m19:18:48.830143 [info ] [Thread-1  ]: 1 of 8 PASS accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23  [[32mPASS[0m in 0.20s]
[0m19:18:48.831282 [info ] [Thread-3  ]: 5 of 8 START test not_null_fct_hourly_trades_open_hour ......................... [RUN]
[0m19:18:48.832750 [info ] [Thread-2  ]: 2 of 8 PASS dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour  [[32mPASS[0m in 0.20s]
[0m19:18:48.834255 [info ] [Thread-4  ]: 4 of 8 PASS not_null_fct_hourly_trades_open_date ............................... [[32mPASS[0m in 0.20s]
[0m19:18:48.835709 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:18:48.837028 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4)
[0m19:18:48.838970 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:18:48.840265 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:18:48.841436 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:18:48.842428 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:18:48.843617 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:18:48.844864 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.unique_fct_hourly_trades_open_date.238a32326f
[0m19:18:48.846053 [info ] [Thread-1  ]: 6 of 8 START test not_null_fct_hourly_trades_open_price ........................ [RUN]
[0m19:18:48.852785 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m19:18:48.853973 [info ] [Thread-2  ]: 7 of 8 START test not_null_fct_hourly_trades_percent_gain ...................... [RUN]
[0m19:18:48.855320 [info ] [Thread-4  ]: 8 of 8 START test unique_fct_hourly_trades_open_date ........................... [RUN]
[0m19:18:48.856516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd)
[0m19:18:48.858168 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf, now test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f)
[0m19:18:48.859243 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d, now test.dbt_btc_transform.unique_fct_hourly_trades_open_date.238a32326f)
[0m19:18:48.860300 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:18:48.860990 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:18:48.862005 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:18:48.862994 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.unique_fct_hourly_trades_open_date.238a32326f
[0m19:18:48.869358 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m19:18:48.873737 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m19:18:48.881319 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m19:18:48.890482 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_fct_hourly_trades_open_date.238a32326f"
[0m19:18:48.893090 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:18:48.894178 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m19:18:48.898453 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m19:18:48.899243 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:18:48.900263 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: BEGIN
[0m19:18:48.900975 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.unique_fct_hourly_trades_open_date.238a32326f
[0m19:18:48.906489 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m19:18:48.907743 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:18:48.909000 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m19:18:48.912999 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_fct_hourly_trades_open_date.238a32326f"
[0m19:18:48.915843 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: BEGIN
[0m19:18:48.917332 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m19:18:48.918751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:18:48.920185 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: BEGIN
[0m19:18:48.921079 [debug] [Thread-3  ]: SQL status: BEGIN in 0.013 seconds
[0m19:18:48.921969 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.unique_fct_hourly_trades_open_date.238a32326f"
[0m19:18:48.923917 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:18:48.925130 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m19:18:48.926562 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_fct_hourly_trades_open_date.238a32326f: BEGIN
[0m19:18:48.928166 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m19:18:48.929339 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_hour
from "company_dw"."analytics"."fct_hourly_trades"
where open_hour is null



      
    ) dbt_internal_test
[0m19:18:48.930492 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:18:48.931663 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m19:18:48.932509 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m19:18:48.934390 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m19:18:48.935281 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_price
from "company_dw"."analytics"."fct_hourly_trades"
where open_price is null



      
    ) dbt_internal_test
[0m19:18:48.936584 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m19:18:48.939190 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: ROLLBACK
[0m19:18:48.940002 [debug] [Thread-4  ]: SQL status: BEGIN in 0.010 seconds
[0m19:18:48.941430 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select percent_gain
from "company_dw"."analytics"."fct_hourly_trades"
where percent_gain is null



      
    ) dbt_internal_test
[0m19:18:48.942298 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m19:18:48.943427 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: Close
[0m19:18:48.944091 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.unique_fct_hourly_trades_open_date.238a32326f"
[0m19:18:48.946862 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: ROLLBACK
[0m19:18:48.947636 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.003 seconds
[0m19:18:48.949152 [info ] [Thread-3  ]: 5 of 8 PASS not_null_fct_hourly_trades_open_hour ............................... [[32mPASS[0m in 0.11s]
[0m19:18:48.950330 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_fct_hourly_trades_open_date.238a32326f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_fct_hourly_trades_open_date.238a32326f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    open_date as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."fct_hourly_trades"
where open_date is not null
group by open_date
having count(*) > 1



      
    ) dbt_internal_test
[0m19:18:48.952033 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: Close
[0m19:18:48.954516 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: ROLLBACK
[0m19:18:48.956131 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:18:48.958247 [info ] [Thread-1  ]: 6 of 8 PASS not_null_fct_hourly_trades_open_price .............................. [[32mPASS[0m in 0.10s]
[0m19:18:48.959381 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m19:18:48.960757 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: Close
[0m19:18:48.962714 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:18:48.965560 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_fct_hourly_trades_open_date.238a32326f: ROLLBACK
[0m19:18:48.967376 [info ] [Thread-2  ]: 7 of 8 PASS not_null_fct_hourly_trades_percent_gain ............................ [[32mPASS[0m in 0.11s]
[0m19:18:48.969916 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_fct_hourly_trades_open_date.238a32326f: Close
[0m19:18:48.971135 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:18:48.972666 [error] [Thread-4  ]: 8 of 8 FAIL 12 unique_fct_hourly_trades_open_date .............................. [[31mFAIL 12[0m in 0.11s]
[0m19:18:48.975102 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.unique_fct_hourly_trades_open_date.238a32326f
[0m19:18:48.978301 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:48.979349 [debug] [MainThread]: On master: BEGIN
[0m19:18:48.980296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:18:48.985664 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:18:48.986903 [debug] [MainThread]: On master: COMMIT
[0m19:18:48.987812 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:48.988732 [debug] [MainThread]: On master: COMMIT
[0m19:18:48.990112 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:18:48.991086 [debug] [MainThread]: On master: Close
[0m19:18:48.992215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:48.993081 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd' was properly closed.
[0m19:18:48.994080 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f' was properly closed.
[0m19:18:48.994941 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4' was properly closed.
[0m19:18:48.995759 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_fct_hourly_trades_open_date.238a32326f' was properly closed.
[0m19:18:48.996859 [info ] [MainThread]: 
[0m19:18:48.997906 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m19:18:49.000988 [debug] [MainThread]: Command end result
[0m19:18:49.001924 [info ] [MainThread]: 
[0m19:18:49.003115 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:18:49.004147 [info ] [MainThread]: 
[0m19:18:49.005266 [error] [MainThread]: [31mFailure in test unique_fct_hourly_trades_open_date (models/marts/docs/fct_hourly_trades.yml)[0m
[0m19:18:49.006384 [error] [MainThread]:   Got 12 results, configured to fail if != 0
[0m19:18:49.007332 [info ] [MainThread]: 
[0m19:18:49.008436 [info ] [MainThread]:   compiled code at target/compiled/dbt_btc_transform/models/marts/docs/fct_hourly_trades.yml/unique_fct_hourly_trades_open_date.sql
[0m19:18:49.009424 [info ] [MainThread]: 
[0m19:18:49.010413 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m19:18:49.012139 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.3532845, "process_user_time": 3.199937, "process_kernel_time": 0.182619, "process_mem_max_rss": "113192", "process_out_blocks": "82", "command_success": false, "process_in_blocks": "0"}
[0m19:18:49.013329 [debug] [MainThread]: Command `dbt test` failed at 19:18:49.013172 after 1.35 seconds
[0m19:18:49.014307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee9548100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee9ad0df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee5bd58e0>]}
[0m19:18:49.015269 [debug] [MainThread]: Flushing usage events
[0m19:20:06.202583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f941bdeb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9419a6b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9419a6b5b0>]}


============================== 19:20:06.211452 | 47e0e058-c2a5-4763-a16c-d6af613b1881 ==============================
[0m19:20:06.211452 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:20:06.212730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:20:06.450059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47e0e058-c2a5-4763-a16c-d6af613b1881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f941b998430>]}
[0m19:20:06.522306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47e0e058-c2a5-4763-a16c-d6af613b1881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9419c29100>]}
[0m19:20:06.523684 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:20:06.558435 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m19:20:06.744752 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:20:06.745989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '47e0e058-c2a5-4763-a16c-d6af613b1881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f941ad95880>]}
[0m19:20:08.903624 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:20:08.904750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '47e0e058-c2a5-4763-a16c-d6af613b1881', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f941869de80>]}
[0m19:20:09.345174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47e0e058-c2a5-4763-a16c-d6af613b1881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94192e0520>]}
[0m19:20:09.360351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47e0e058-c2a5-4763-a16c-d6af613b1881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9418708a00>]}
[0m19:20:09.361476 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m19:20:09.362404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47e0e058-c2a5-4763-a16c-d6af613b1881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94192e01c0>]}
[0m19:20:09.364664 [info ] [MainThread]: 
[0m19:20:09.365800 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:20:09.367467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m19:20:09.410913 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m19:20:09.411957 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m19:20:09.412901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:09.418854 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m19:20:09.420870 [debug] [ThreadPool]: On list_company_dw: Close
[0m19:20:09.427529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m19:20:09.436596 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:20:09.437425 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m19:20:09.438190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:09.443475 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:20:09.444413 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:20:09.445295 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m19:20:09.448575 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m19:20:09.450579 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m19:20:09.451637 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m19:20:09.459224 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:09.460213 [debug] [MainThread]: On master: BEGIN
[0m19:20:09.461026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:20:09.466266 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:20:09.467136 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:09.468318 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:20:09.476834 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m19:20:09.478742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47e0e058-c2a5-4763-a16c-d6af613b1881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f941b9722e0>]}
[0m19:20:09.479865 [debug] [MainThread]: On master: ROLLBACK
[0m19:20:09.481213 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:09.482027 [debug] [MainThread]: On master: BEGIN
[0m19:20:09.483496 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:20:09.484274 [debug] [MainThread]: On master: COMMIT
[0m19:20:09.485065 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:09.485907 [debug] [MainThread]: On master: COMMIT
[0m19:20:09.486951 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:20:09.487808 [debug] [MainThread]: On master: Close
[0m19:20:09.488854 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:20:09.489777 [info ] [MainThread]: 
[0m19:20:09.499036 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m19:20:09.500471 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m19:20:09.501581 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m19:20:09.502475 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m19:20:09.514730 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:20:09.520061 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m19:20:09.575016 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:20:09.579427 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:20:09.580545 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m19:20:09.581497 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:20:09.586500 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m19:20:09.587616 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:20:09.588764 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    -- I hate just putting a distinct to deal with duplicates but doing this because there are dupes in the source data.
    -- I would rather investigate why this is happening at the source and fix there but need to work
    -- with what was given
    select distinct 
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote_asset_volume,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        open_time::date as open_date,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minutes from open_time) = 0
            and extract(second from open_time) = 0
                then true
            else false
        end as hour_start,

        case    
            when extract(minutes from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as hour_end
            

    from source

)

select * from final
  );
  
[0m19:20:11.634924 [debug] [Thread-1  ]: SQL status: SELECT 999963 in 2.045 seconds
[0m19:20:11.645543 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:20:11.646570 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt" rename to "stg_kaggle__btcusdt__dbt_backup"
[0m19:20:11.648769 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:20:11.653671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:20:11.654634 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp" rename to "stg_kaggle__btcusdt"
[0m19:20:11.656049 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:20:11.688360 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m19:20:11.689486 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:20:11.690514 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m19:20:11.967436 [debug] [Thread-1  ]: SQL status: COMMIT in 0.276 seconds
[0m19:20:11.979059 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup"
[0m19:20:11.985907 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:20:11.986934 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
drop table if exists "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup" cascade
[0m19:20:12.002240 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.014 seconds
[0m19:20:12.005742 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m19:20:12.008248 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e0e058-c2a5-4763-a16c-d6af613b1881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9417bdfb80>]}
[0m19:20:12.009629 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.stg_kaggle__btcusdt ................ [[32mSELECT 999963[0m in 2.51s]
[0m19:20:12.011112 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m19:20:12.015175 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:12.016263 [debug] [MainThread]: On master: BEGIN
[0m19:20:12.017190 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:20:12.021977 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:20:12.022973 [debug] [MainThread]: On master: COMMIT
[0m19:20:12.023826 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:12.024675 [debug] [MainThread]: On master: COMMIT
[0m19:20:12.025729 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:20:12.026554 [debug] [MainThread]: On master: Close
[0m19:20:12.027585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:12.028382 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m19:20:12.029223 [info ] [MainThread]: 
[0m19:20:12.030111 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m19:20:12.031489 [debug] [MainThread]: Command end result
[0m19:20:12.032300 [info ] [MainThread]: 
[0m19:20:12.033278 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:20:12.034164 [info ] [MainThread]: 
[0m19:20:12.035158 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:20:12.036556 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9068103, "process_user_time": 5.43776, "process_kernel_time": 0.143125, "process_mem_max_rss": "115896", "process_out_blocks": "1219", "process_in_blocks": "0"}
[0m19:20:12.037620 [debug] [MainThread]: Command `dbt run` succeeded at 19:20:12.037500 after 5.91 seconds
[0m19:20:12.038534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f941bdeb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9419c72c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9419c29100>]}
[0m19:20:12.039600 [debug] [MainThread]: Flushing usage events
[0m19:20:16.470847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260678b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2604412610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26044125b0>]}


============================== 19:20:16.478335 | fbc5113d-1c48-455f-9c57-26069c04d9ab ==============================
[0m19:20:16.478335 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:20:16.479526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models stg_kaggle__btcusdt', 'send_anonymous_usage_stats': 'True'}
[0m19:20:16.701873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbc5113d-1c48-455f-9c57-26069c04d9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2604138490>]}
[0m19:20:16.771046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbc5113d-1c48-455f-9c57-26069c04d9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2605098d00>]}
[0m19:20:16.772506 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:20:16.809830 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m19:20:17.089628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:20:17.090539 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:20:17.161850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbc5113d-1c48-455f-9c57-26069c04d9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260346b130>]}
[0m19:20:17.187191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbc5113d-1c48-455f-9c57-26069c04d9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2603960700>]}
[0m19:20:17.188355 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m19:20:17.189222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbc5113d-1c48-455f-9c57-26069c04d9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26039601c0>]}
[0m19:20:17.192326 [info ] [MainThread]: 
[0m19:20:17.193424 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:20:17.200473 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analytics'
[0m19:20:17.316925 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:20:17.317990 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m19:20:17.318885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:17.324836 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m19:20:17.325858 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:20:17.326830 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m19:20:17.330542 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m19:20:17.332713 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m19:20:17.333856 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m19:20:17.342513 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:17.343516 [debug] [MainThread]: On master: BEGIN
[0m19:20:17.344405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:20:17.349451 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:20:17.350331 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:17.351483 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:20:17.360595 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m19:20:17.362598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbc5113d-1c48-455f-9c57-26069c04d9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26034ac730>]}
[0m19:20:17.363745 [debug] [MainThread]: On master: ROLLBACK
[0m19:20:17.364821 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:17.365660 [debug] [MainThread]: On master: BEGIN
[0m19:20:17.367000 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:20:17.367857 [debug] [MainThread]: On master: COMMIT
[0m19:20:17.368705 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:17.369478 [debug] [MainThread]: On master: COMMIT
[0m19:20:17.370405 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:20:17.371250 [debug] [MainThread]: On master: Close
[0m19:20:17.372268 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:20:17.373177 [info ] [MainThread]: 
[0m19:20:17.382997 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m19:20:17.383874 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m19:20:17.384611 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m19:20:17.385386 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m19:20:17.386079 [info ] [Thread-1  ]: 1 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_end__True__False ... [RUN]
[0m19:20:17.387303 [info ] [Thread-2  ]: 2 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_start__True__False . [RUN]
[0m19:20:17.388414 [info ] [Thread-3  ]: 3 of 18 START test not_null_stg_kaggle__btcusdt_close .......................... [RUN]
[0m19:20:17.389491 [info ] [Thread-4  ]: 4 of 18 START test not_null_stg_kaggle__btcusdt_close_time ..................... [RUN]
[0m19:20:17.390687 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872)
[0m19:20:17.392052 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m19:20:17.393281 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb'
[0m19:20:17.394423 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a'
[0m19:20:17.395525 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m19:20:17.396548 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m19:20:17.397506 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m19:20:17.398447 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m19:20:17.430510 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m19:20:17.433702 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m19:20:17.445779 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m19:20:17.451564 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m19:20:17.455035 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m19:20:17.456568 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m19:20:17.475647 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m19:20:17.480846 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m19:20:17.481648 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m19:20:17.485888 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m19:20:17.491469 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m19:20:17.496575 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m19:20:17.498151 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m19:20:17.499821 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m19:20:17.500801 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: BEGIN
[0m19:20:17.501528 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m19:20:17.502536 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: BEGIN
[0m19:20:17.503337 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m19:20:17.504311 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:20:17.505528 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: BEGIN
[0m19:20:17.506584 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:20:17.507645 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: BEGIN
[0m19:20:17.509439 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:20:17.511565 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:20:17.513123 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m19:20:17.515200 [debug] [Thread-2  ]: SQL status: BEGIN in 0.008 seconds
[0m19:20:17.516098 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m19:20:17.517502 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m19:20:17.518348 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m19:20:17.519451 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_end as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_end

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m19:20:17.520349 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m19:20:17.521408 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_start as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_start

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m19:20:17.522608 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m19:20:17.524288 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m19:20:17.526501 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close is null



      
    ) dbt_internal_test
[0m19:20:17.527868 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is null



      
    ) dbt_internal_test
[0m19:20:17.649006 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.123 seconds
[0m19:20:17.649991 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.126 seconds
[0m19:20:17.651031 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.118 seconds
[0m19:20:17.651861 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.120 seconds
[0m19:20:17.658060 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: ROLLBACK
[0m19:20:17.660721 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: ROLLBACK
[0m19:20:17.663199 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: ROLLBACK
[0m19:20:17.665695 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: ROLLBACK
[0m19:20:17.667065 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: Close
[0m19:20:17.668105 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: Close
[0m19:20:17.669247 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: Close
[0m19:20:17.670310 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: Close
[0m19:20:17.671455 [info ] [Thread-2  ]: 2 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_start__True__False ....... [[32mPASS[0m in 0.28s]
[0m19:20:17.673064 [info ] [Thread-1  ]: 1 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_end__True__False ......... [[32mPASS[0m in 0.28s]
[0m19:20:17.674717 [info ] [Thread-4  ]: 4 of 18 PASS not_null_stg_kaggle__btcusdt_close_time ........................... [[32mPASS[0m in 0.28s]
[0m19:20:17.676597 [info ] [Thread-3  ]: 3 of 18 PASS not_null_stg_kaggle__btcusdt_close ................................ [[32mPASS[0m in 0.28s]
[0m19:20:17.678053 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m19:20:17.679525 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m19:20:17.680771 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m19:20:17.682015 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m19:20:17.683391 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m19:20:17.684555 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m19:20:17.685704 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m19:20:17.686993 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m19:20:17.688193 [info ] [Thread-2  ]: 5 of 18 START test not_null_stg_kaggle__btcusdt_high ........................... [RUN]
[0m19:20:17.689372 [info ] [Thread-1  ]: 6 of 18 START test not_null_stg_kaggle__btcusdt_hour_end ....................... [RUN]
[0m19:20:17.690570 [info ] [Thread-4  ]: 7 of 18 START test not_null_stg_kaggle__btcusdt_hour_start ..................... [RUN]
[0m19:20:17.691758 [info ] [Thread-3  ]: 8 of 18 START test not_null_stg_kaggle__btcusdt_low ............................ [RUN]
[0m19:20:17.693022 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m19:20:17.694278 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m19:20:17.695391 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m19:20:17.696469 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m19:20:17.697519 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m19:20:17.698521 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m19:20:17.699587 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m19:20:17.700627 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m19:20:17.707103 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m19:20:17.713831 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m19:20:17.720253 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m19:20:17.727125 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m19:20:17.729990 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m19:20:17.731050 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m19:20:17.736966 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m19:20:17.737849 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m19:20:17.738819 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m19:20:17.743100 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m19:20:17.748054 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m19:20:17.752050 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m19:20:17.752894 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m19:20:17.756284 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m19:20:17.757074 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m19:20:17.757866 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: BEGIN
[0m19:20:17.759237 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m19:20:17.759943 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: BEGIN
[0m19:20:17.760998 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: BEGIN
[0m19:20:17.762015 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:20:17.763075 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: BEGIN
[0m19:20:17.764298 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:20:17.765322 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:20:17.767417 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:20:17.771916 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m19:20:17.773225 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m19:20:17.774064 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m19:20:17.775285 [debug] [Thread-4  ]: SQL status: BEGIN in 0.010 seconds
[0m19:20:17.776155 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where high is null



      
    ) dbt_internal_test
[0m19:20:17.777041 [debug] [Thread-3  ]: SQL status: BEGIN in 0.010 seconds
[0m19:20:17.777961 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m19:20:17.779011 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m19:20:17.780794 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m19:20:17.781923 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_end
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_end is null



      
    ) dbt_internal_test
[0m19:20:17.783279 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_start
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_start is null



      
    ) dbt_internal_test
[0m19:20:17.784382 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where low is null



      
    ) dbt_internal_test
[0m19:20:17.845751 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.065 seconds
[0m19:20:17.852281 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: ROLLBACK
[0m19:20:17.854571 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: Close
[0m19:20:17.857045 [info ] [Thread-2  ]: 5 of 18 PASS not_null_stg_kaggle__btcusdt_high ................................. [[32mPASS[0m in 0.16s]
[0m19:20:17.859860 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m19:20:17.861807 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m19:20:17.863737 [info ] [Thread-2  ]: 9 of 18 START test not_null_stg_kaggle__btcusdt_number_of_trades ............... [RUN]
[0m19:20:17.865990 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m19:20:17.868062 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m19:20:17.880623 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m19:20:17.881654 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.096 seconds
[0m19:20:17.882921 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.097 seconds
[0m19:20:17.884054 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.098 seconds
[0m19:20:17.886787 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: ROLLBACK
[0m19:20:17.889116 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: ROLLBACK
[0m19:20:17.889920 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m19:20:17.892022 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: ROLLBACK
[0m19:20:17.893346 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: Close
[0m19:20:17.894366 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: Close
[0m19:20:17.898700 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m19:20:17.900077 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: Close
[0m19:20:17.901150 [info ] [Thread-1  ]: 6 of 18 PASS not_null_stg_kaggle__btcusdt_hour_end ............................. [[32mPASS[0m in 0.21s]
[0m19:20:17.902683 [info ] [Thread-4  ]: 7 of 18 PASS not_null_stg_kaggle__btcusdt_hour_start ........................... [[32mPASS[0m in 0.21s]
[0m19:20:17.904994 [info ] [Thread-3  ]: 8 of 18 PASS not_null_stg_kaggle__btcusdt_low .................................. [[32mPASS[0m in 0.21s]
[0m19:20:17.906983 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m19:20:17.908239 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m19:20:17.910020 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m19:20:17.912174 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m19:20:17.913841 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m19:20:17.915352 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: BEGIN
[0m19:20:17.916976 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m19:20:17.918756 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m19:20:17.920368 [info ] [Thread-1  ]: 10 of 18 START test not_null_stg_kaggle__btcusdt_open .......................... [RUN]
[0m19:20:17.921704 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:20:17.923348 [info ] [Thread-4  ]: 11 of 18 START test not_null_stg_kaggle__btcusdt_open_date ..................... [RUN]
[0m19:20:17.924824 [info ] [Thread-3  ]: 12 of 18 START test not_null_stg_kaggle__btcusdt_open_time ..................... [RUN]
[0m19:20:17.926443 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m19:20:17.929795 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m19:20:17.931810 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m19:20:17.934143 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m19:20:17.935476 [debug] [Thread-2  ]: SQL status: BEGIN in 0.014 seconds
[0m19:20:17.936852 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m19:20:17.938678 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m19:20:17.949245 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m19:20:17.950829 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m19:20:17.958084 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m19:20:17.965803 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m19:20:17.967700 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select number_of_trades
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where number_of_trades is null



      
    ) dbt_internal_test
[0m19:20:17.969370 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m19:20:17.972388 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m19:20:17.978059 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m19:20:17.979796 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m19:20:17.984640 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m19:20:17.989777 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m19:20:17.991463 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m19:20:17.993181 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: BEGIN
[0m19:20:17.994004 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m19:20:17.995187 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:20:17.996048 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m19:20:17.997381 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: BEGIN
[0m19:20:17.999575 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: BEGIN
[0m19:20:18.000955 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:20:18.002191 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:20:18.003686 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m19:20:18.006456 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m19:20:18.008420 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open is null



      
    ) dbt_internal_test
[0m19:20:18.010623 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m19:20:18.011606 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m19:20:18.013286 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m19:20:18.016003 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m19:20:18.017826 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_date
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_date is null



      
    ) dbt_internal_test
[0m19:20:18.019918 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is null



      
    ) dbt_internal_test
[0m19:20:18.026385 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.054 seconds
[0m19:20:18.030696 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: ROLLBACK
[0m19:20:18.032962 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: Close
[0m19:20:18.035681 [info ] [Thread-2  ]: 9 of 18 PASS not_null_stg_kaggle__btcusdt_number_of_trades ..................... [[32mPASS[0m in 0.17s]
[0m19:20:18.038214 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m19:20:18.040411 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m19:20:18.041933 [info ] [Thread-2  ]: 13 of 18 START test not_null_stg_kaggle__btcusdt_quote_asset_volume ............ [RUN]
[0m19:20:18.044002 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m19:20:18.046331 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m19:20:18.058918 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m19:20:18.062403 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m19:20:18.070541 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m19:20:18.071597 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.061 seconds
[0m19:20:18.078008 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: ROLLBACK
[0m19:20:18.080443 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m19:20:18.081643 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: Close
[0m19:20:18.083439 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: BEGIN
[0m19:20:18.087734 [info ] [Thread-1  ]: 10 of 18 PASS not_null_stg_kaggle__btcusdt_open ................................ [[32mPASS[0m in 0.16s]
[0m19:20:18.090138 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:20:18.092855 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m19:20:18.096550 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m19:20:18.098671 [info ] [Thread-1  ]: 14 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ... [RUN]
[0m19:20:18.100948 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m19:20:18.102386 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.080 seconds
[0m19:20:18.103303 [debug] [Thread-2  ]: SQL status: BEGIN in 0.013 seconds
[0m19:20:18.104614 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m19:20:18.108102 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: ROLLBACK
[0m19:20:18.109022 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.087 seconds
[0m19:20:18.110303 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m19:20:18.118675 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m19:20:18.120762 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: Close
[0m19:20:18.123591 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: ROLLBACK
[0m19:20:18.125206 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where quote_asset_volume is null



      
    ) dbt_internal_test
[0m19:20:18.129110 [info ] [Thread-3  ]: 12 of 18 PASS not_null_stg_kaggle__btcusdt_open_time ........................... [[32mPASS[0m in 0.20s]
[0m19:20:18.131450 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m19:20:18.132681 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: Close
[0m19:20:18.134852 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m19:20:18.141804 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m19:20:18.143918 [info ] [Thread-4  ]: 11 of 18 PASS not_null_stg_kaggle__btcusdt_open_date ........................... [[32mPASS[0m in 0.21s]
[0m19:20:18.145616 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m19:20:18.148373 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m19:20:18.149701 [info ] [Thread-3  ]: 15 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume .. [RUN]
[0m19:20:18.150807 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m19:20:18.152311 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m19:20:18.153749 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m19:20:18.155117 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: BEGIN
[0m19:20:18.156842 [info ] [Thread-4  ]: 16 of 18 START test not_null_stg_kaggle__btcusdt_volume ........................ [RUN]
[0m19:20:18.158579 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m19:20:18.160380 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:20:18.162055 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m19:20:18.170901 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m19:20:18.173035 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m19:20:18.181246 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m19:20:18.183383 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m19:20:18.184394 [debug] [Thread-1  ]: SQL status: BEGIN in 0.024 seconds
[0m19:20:18.190871 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m19:20:18.192261 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.058 seconds
[0m19:20:18.192999 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m19:20:18.194057 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m19:20:18.197040 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: ROLLBACK
[0m19:20:18.198576 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_base_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_base_asset_volume is null



      
    ) dbt_internal_test
[0m19:20:18.199583 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m19:20:18.203676 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m19:20:18.205378 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: Close
[0m19:20:18.209723 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: BEGIN
[0m19:20:18.212424 [info ] [Thread-2  ]: 13 of 18 PASS not_null_stg_kaggle__btcusdt_quote_asset_volume .................. [[32mPASS[0m in 0.17s]
[0m19:20:18.213825 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:20:18.214714 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m19:20:18.216329 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m19:20:18.218742 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: BEGIN
[0m19:20:18.220851 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m19:20:18.222534 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m19:20:18.224576 [info ] [Thread-2  ]: 17 of 18 START test unique_stg_kaggle__btcusdt_close_time ...................... [RUN]
[0m19:20:18.226139 [debug] [Thread-3  ]: SQL status: BEGIN in 0.012 seconds
[0m19:20:18.228724 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m19:20:18.230484 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m19:20:18.231783 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m19:20:18.233097 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_quote_asset_volume is null



      
    ) dbt_internal_test
[0m19:20:18.234062 [debug] [Thread-4  ]: SQL status: BEGIN in 0.012 seconds
[0m19:20:18.243716 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m19:20:18.245518 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m19:20:18.247775 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where volume is null



      
    ) dbt_internal_test
[0m19:20:18.249693 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m19:20:18.258166 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m19:20:18.261964 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m19:20:18.263698 [debug] [Thread-2  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: BEGIN
[0m19:20:18.265434 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.059 seconds
[0m19:20:18.267000 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:20:18.270753 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: ROLLBACK
[0m19:20:18.274651 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: Close
[0m19:20:18.278243 [info ] [Thread-1  ]: 14 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ......... [[32mPASS[0m in 0.18s]
[0m19:20:18.280923 [debug] [Thread-2  ]: SQL status: BEGIN in 0.014 seconds
[0m19:20:18.282533 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m19:20:18.284041 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m19:20:18.285935 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m19:20:18.287757 [debug] [Thread-2  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    close_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is not null
group by close_time
having count(*) > 1



      
    ) dbt_internal_test
[0m19:20:18.289677 [info ] [Thread-1  ]: 18 of 18 START test unique_stg_kaggle__btcusdt_open_time ....................... [RUN]
[0m19:20:18.292081 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m19:20:18.294668 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m19:20:18.309013 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m19:20:18.313257 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m19:20:18.321055 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m19:20:18.322413 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.073 seconds
[0m19:20:18.324387 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.079 seconds
[0m19:20:18.327939 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: ROLLBACK
[0m19:20:18.331412 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: ROLLBACK
[0m19:20:18.332762 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m19:20:18.333935 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: Close
[0m19:20:18.335275 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: Close
[0m19:20:18.338196 [info ] [Thread-4  ]: 16 of 18 PASS not_null_stg_kaggle__btcusdt_volume .............................. [[32mPASS[0m in 0.18s]
[0m19:20:18.336077 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: BEGIN
[0m19:20:18.340087 [info ] [Thread-3  ]: 15 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume ........ [[32mPASS[0m in 0.19s]
[0m19:20:18.341928 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m19:20:18.343310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:20:18.344959 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m19:20:18.351447 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m19:20:18.352639 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m19:20:18.353764 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    open_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is not null
group by open_time
having count(*) > 1



      
    ) dbt_internal_test
[0m19:20:19.231460 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.940 seconds
[0m19:20:19.233955 [debug] [Thread-2  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: ROLLBACK
[0m19:20:19.235309 [debug] [Thread-2  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: Close
[0m19:20:19.236670 [info ] [Thread-2  ]: 17 of 18 PASS unique_stg_kaggle__btcusdt_close_time ............................ [[32mPASS[0m in 1.01s]
[0m19:20:19.238396 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m19:20:19.259457 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.904 seconds
[0m19:20:19.261892 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: ROLLBACK
[0m19:20:19.263246 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: Close
[0m19:20:19.264575 [info ] [Thread-1  ]: 18 of 18 PASS unique_stg_kaggle__btcusdt_open_time ............................. [[32mPASS[0m in 0.97s]
[0m19:20:19.266071 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m19:20:19.269158 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:19.270104 [debug] [MainThread]: On master: BEGIN
[0m19:20:19.271021 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:20:19.275719 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:20:19.276777 [debug] [MainThread]: On master: COMMIT
[0m19:20:19.277859 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:19.278746 [debug] [MainThread]: On master: COMMIT
[0m19:20:19.279946 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:20:19.280799 [debug] [MainThread]: On master: Close
[0m19:20:19.281767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:19.282579 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa' was properly closed.
[0m19:20:19.283398 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb' was properly closed.
[0m19:20:19.284206 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42' was properly closed.
[0m19:20:19.284988 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae' was properly closed.
[0m19:20:19.285985 [info ] [MainThread]: 
[0m19:20:19.286924 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m19:20:19.291566 [debug] [MainThread]: Command end result
[0m19:20:19.292411 [info ] [MainThread]: 
[0m19:20:19.293339 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:20:19.294256 [info ] [MainThread]: 
[0m19:20:19.295209 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m19:20:19.296652 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.8973713, "process_user_time": 3.504335, "process_kernel_time": 0.213742, "process_mem_max_rss": "114276", "process_in_blocks": "1072", "process_out_blocks": "141"}
[0m19:20:19.297762 [debug] [MainThread]: Command `dbt test` succeeded at 19:20:19.297643 after 2.90 seconds
[0m19:20:19.298676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260678b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26044410a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2605098d00>]}
[0m19:20:19.299572 [debug] [MainThread]: Flushing usage events
[0m19:20:23.807789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa71cfcb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa71ac2a640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa71ac2a5e0>]}


============================== 19:20:23.815212 | 0afa0855-b012-47e0-84ef-7ff4e979ea26 ==============================
[0m19:20:23.815212 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:20:23.816440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models fct_hourly_trades', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:20:24.032929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0afa0855-b012-47e0-84ef-7ff4e979ea26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa71ac9a160>]}
[0m19:20:24.102990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0afa0855-b012-47e0-84ef-7ff4e979ea26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa71ac5aa60>]}
[0m19:20:24.104481 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:20:24.134617 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m19:20:24.394596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:20:24.395453 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:20:24.467892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0afa0855-b012-47e0-84ef-7ff4e979ea26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa719cab130>]}
[0m19:20:24.481981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0afa0855-b012-47e0-84ef-7ff4e979ea26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa719c55ca0>]}
[0m19:20:24.483056 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m19:20:24.483983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0afa0855-b012-47e0-84ef-7ff4e979ea26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa71a1a7460>]}
[0m19:20:24.486331 [info ] [MainThread]: 
[0m19:20:24.487606 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:20:24.489212 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m19:20:24.598624 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m19:20:24.599746 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m19:20:24.600773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:24.607240 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m19:20:24.609483 [debug] [ThreadPool]: On list_company_dw: Close
[0m19:20:24.616781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m19:20:24.626534 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:20:24.627492 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m19:20:24.628410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:24.633291 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:20:24.634184 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:20:24.635265 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m19:20:24.638774 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m19:20:24.640967 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m19:20:24.642298 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m19:20:24.650208 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:24.651235 [debug] [MainThread]: On master: BEGIN
[0m19:20:24.652064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:20:24.656653 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:20:24.657517 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:24.658596 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:20:24.667010 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m19:20:24.668957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0afa0855-b012-47e0-84ef-7ff4e979ea26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa71f2c3af0>]}
[0m19:20:24.669927 [debug] [MainThread]: On master: ROLLBACK
[0m19:20:24.671240 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:24.672076 [debug] [MainThread]: On master: BEGIN
[0m19:20:24.673516 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:20:24.674321 [debug] [MainThread]: On master: COMMIT
[0m19:20:24.675178 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:24.675978 [debug] [MainThread]: On master: COMMIT
[0m19:20:24.677066 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:20:24.677892 [debug] [MainThread]: On master: Close
[0m19:20:24.678973 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:20:24.679912 [info ] [MainThread]: 
[0m19:20:24.689003 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.fct_hourly_trades
[0m19:20:24.690190 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.fct_hourly_trades ....................... [RUN]
[0m19:20:24.691557 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.fct_hourly_trades)
[0m19:20:24.692450 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.fct_hourly_trades
[0m19:20:24.704679 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.fct_hourly_trades"
[0m19:20:24.707602 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.fct_hourly_trades
[0m19:20:24.762442 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.fct_hourly_trades"
[0m19:20:24.764865 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m19:20:24.765804 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: BEGIN
[0m19:20:24.766656 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:20:24.771622 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m19:20:24.772605 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m19:20:24.773596 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.fct_hourly_trades"} */

  
    

  create  table "company_dw"."analytics"."fct_hourly_trades__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."analytics"."stg_kaggle__btcusdt"

),


hourly as (

    select
        open_date,
        extract(hours from open_time) as open_hour,

        max(
            case
                when hour_start is true
                    then open
            end 
        ) as open_price,

        max(
            case
                when hour_end is true
                    then close
            end
        ) as close_price

    from source

    where
        hour_start is true or hour_end is true
    
    group by 1, 2

),


final as (

    select
        open_date,
        open_hour,
        open_price,
        close_price,       
        (close_price - open_price) * 1.00000000000000 / open_price as percent_gain

    from hourly

    where 
        open_price is not null
        and close_price is not null

)

select * from final
  );
  
[0m19:20:24.833936 [debug] [Thread-1  ]: SQL status: SELECT 276 in 0.059 seconds
[0m19:20:24.843246 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m19:20:24.844263 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.fct_hourly_trades"} */
alter table "company_dw"."analytics"."fct_hourly_trades" rename to "fct_hourly_trades__dbt_backup"
[0m19:20:24.845820 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:20:24.850720 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m19:20:24.851701 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.fct_hourly_trades"} */
alter table "company_dw"."analytics"."fct_hourly_trades__dbt_tmp" rename to "fct_hourly_trades"
[0m19:20:24.852999 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:20:24.880057 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: COMMIT
[0m19:20:24.881113 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m19:20:24.882187 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: COMMIT
[0m19:20:24.884478 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m19:20:24.893357 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."fct_hourly_trades__dbt_backup"
[0m19:20:24.899292 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m19:20:24.900376 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.fct_hourly_trades"} */
drop table if exists "company_dw"."analytics"."fct_hourly_trades__dbt_backup" cascade
[0m19:20:24.902895 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m19:20:24.906251 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: Close
[0m19:20:24.908702 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0afa0855-b012-47e0-84ef-7ff4e979ea26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa719564a00>]}
[0m19:20:24.910112 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.fct_hourly_trades .................. [[32mSELECT 276[0m in 0.22s]
[0m19:20:24.911440 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.fct_hourly_trades
[0m19:20:24.914365 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:24.915202 [debug] [MainThread]: On master: BEGIN
[0m19:20:24.915995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:20:24.921041 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:20:24.922042 [debug] [MainThread]: On master: COMMIT
[0m19:20:24.922908 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:24.923719 [debug] [MainThread]: On master: COMMIT
[0m19:20:24.924726 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:20:24.925699 [debug] [MainThread]: On master: Close
[0m19:20:24.926675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:24.927519 [debug] [MainThread]: Connection 'model.dbt_btc_transform.fct_hourly_trades' was properly closed.
[0m19:20:24.928439 [info ] [MainThread]: 
[0m19:20:24.929429 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m19:20:24.930795 [debug] [MainThread]: Command end result
[0m19:20:24.931566 [info ] [MainThread]: 
[0m19:20:24.932485 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:20:24.933331 [info ] [MainThread]: 
[0m19:20:24.934297 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:20:24.935720 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1998081, "process_user_time": 2.925857, "process_kernel_time": 0.16311, "process_mem_max_rss": "109520", "process_out_blocks": "40", "process_in_blocks": "0"}
[0m19:20:24.936757 [debug] [MainThread]: Command `dbt run` succeeded at 19:20:24.936640 after 1.20 seconds
[0m19:20:24.937636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa71cfcb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa71aded130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa719c55f70>]}
[0m19:20:24.938535 [debug] [MainThread]: Flushing usage events
[0m19:20:30.562087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9bf4b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde99bd9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde99bd95e0>]}


============================== 19:20:30.569388 | 556ef04b-cf63-4f23-b41c-9ddb90471b9c ==============================
[0m19:20:30.569388 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:20:30.570585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models fct_hourly_trades', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:20:30.801139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '556ef04b-cf63-4f23-b41c-9ddb90471b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde99585e20>]}
[0m19:20:30.869743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '556ef04b-cf63-4f23-b41c-9ddb90471b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde99599b20>]}
[0m19:20:30.871169 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:20:30.900238 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m19:20:31.147285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:20:31.148096 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:20:31.221294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '556ef04b-cf63-4f23-b41c-9ddb90471b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde989eb130>]}
[0m19:20:31.246541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '556ef04b-cf63-4f23-b41c-9ddb90471b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde98de0760>]}
[0m19:20:31.247621 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m19:20:31.248604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '556ef04b-cf63-4f23-b41c-9ddb90471b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde98de0190>]}
[0m19:20:31.251228 [info ] [MainThread]: 
[0m19:20:31.252354 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:20:31.259429 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analytics'
[0m19:20:31.392678 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:20:31.393694 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m19:20:31.394540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:31.399968 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:20:31.400926 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:20:31.402004 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m19:20:31.405154 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m19:20:31.407126 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m19:20:31.408234 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m19:20:31.416042 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:31.417083 [debug] [MainThread]: On master: BEGIN
[0m19:20:31.417946 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:20:31.423102 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:20:31.423989 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:31.424977 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:20:31.433506 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m19:20:31.435401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '556ef04b-cf63-4f23-b41c-9ddb90471b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde995b00d0>]}
[0m19:20:31.436333 [debug] [MainThread]: On master: ROLLBACK
[0m19:20:31.437458 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:31.438223 [debug] [MainThread]: On master: BEGIN
[0m19:20:31.439673 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:20:31.440660 [debug] [MainThread]: On master: COMMIT
[0m19:20:31.441787 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:31.442653 [debug] [MainThread]: On master: COMMIT
[0m19:20:31.443751 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:20:31.444639 [debug] [MainThread]: On master: Close
[0m19:20:31.445838 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:20:31.447026 [info ] [MainThread]: 
[0m19:20:31.456758 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:20:31.457735 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:20:31.458499 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:20:31.459344 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:20:31.460145 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23  [RUN]
[0m19:20:31.461798 [info ] [Thread-2  ]: 2 of 7 START test dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour  [RUN]
[0m19:20:31.463102 [info ] [Thread-3  ]: 3 of 7 START test not_null_fct_hourly_trades_close_price ....................... [RUN]
[0m19:20:31.464357 [info ] [Thread-4  ]: 4 of 7 START test not_null_fct_hourly_trades_open_date ......................... [RUN]
[0m19:20:31.465647 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433)
[0m19:20:31.466881 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf'
[0m19:20:31.468158 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523'
[0m19:20:31.469531 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d'
[0m19:20:31.470637 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:20:31.471717 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:20:31.473222 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:20:31.474257 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:20:31.504925 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m19:20:31.514432 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m19:20:31.526007 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m19:20:31.531744 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m19:20:31.536425 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:20:31.537194 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:20:31.544272 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:20:31.562437 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:20:31.567670 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m19:20:31.580754 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m19:20:31.584831 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m19:20:31.589164 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m19:20:31.592080 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m19:20:31.593631 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m19:20:31.594760 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: BEGIN
[0m19:20:31.595568 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m19:20:31.596600 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: BEGIN
[0m19:20:31.597459 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m19:20:31.598341 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:20:31.599310 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: BEGIN
[0m19:20:31.600308 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:20:31.601361 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: BEGIN
[0m19:20:31.603345 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:20:31.605210 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:20:31.607159 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m19:20:31.609043 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m19:20:31.609887 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m19:20:31.611110 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        open_date, open_hour
    from "company_dw"."analytics"."fct_hourly_trades"
    group by open_date, open_hour
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m19:20:31.612059 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m19:20:31.613154 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m19:20:31.613903 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m19:20:31.615481 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m19:20:31.616574 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m19:20:31.617606 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        open_hour as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."fct_hourly_trades"
    group by open_hour

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23'
)



      
    ) dbt_internal_test
[0m19:20:31.618778 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m19:20:31.619971 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price
from "company_dw"."analytics"."fct_hourly_trades"
where close_price is null



      
    ) dbt_internal_test
[0m19:20:31.625809 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: ROLLBACK
[0m19:20:31.627490 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_date
from "company_dw"."analytics"."fct_hourly_trades"
where open_date is null



      
    ) dbt_internal_test
[0m19:20:31.628436 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m19:20:31.630184 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: Close
[0m19:20:31.630882 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m19:20:31.633479 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: ROLLBACK
[0m19:20:31.634284 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.003 seconds
[0m19:20:31.635528 [info ] [Thread-2  ]: 2 of 7 PASS dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour  [[32mPASS[0m in 0.17s]
[0m19:20:31.637884 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: ROLLBACK
[0m19:20:31.639266 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: Close
[0m19:20:31.641244 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: ROLLBACK
[0m19:20:31.642580 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:20:31.644012 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: Close
[0m19:20:31.645136 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23  [[32mPASS[0m in 0.18s]
[0m19:20:31.646443 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: Close
[0m19:20:31.647244 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:20:31.648628 [info ] [Thread-3  ]: 3 of 7 PASS not_null_fct_hourly_trades_close_price ............................. [[32mPASS[0m in 0.18s]
[0m19:20:31.649988 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:20:31.651396 [info ] [Thread-4  ]: 4 of 7 PASS not_null_fct_hourly_trades_open_date ............................... [[32mPASS[0m in 0.18s]
[0m19:20:31.652592 [info ] [Thread-2  ]: 5 of 7 START test not_null_fct_hourly_trades_open_hour ......................... [RUN]
[0m19:20:31.654109 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:20:31.655256 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:20:31.656517 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:20:31.657630 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4)
[0m19:20:31.658802 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:20:31.660003 [info ] [Thread-1  ]: 6 of 7 START test not_null_fct_hourly_trades_open_price ........................ [RUN]
[0m19:20:31.661733 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:20:31.662811 [info ] [Thread-3  ]: 7 of 7 START test not_null_fct_hourly_trades_percent_gain ...................... [RUN]
[0m19:20:31.664083 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd)
[0m19:20:31.670264 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m19:20:31.671329 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523, now test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f)
[0m19:20:31.672350 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:20:31.674044 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:20:31.679892 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m19:20:31.680820 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:20:31.686896 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m19:20:31.692765 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m19:20:31.694248 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:20:31.695587 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:20:31.699324 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m19:20:31.703481 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m19:20:31.704481 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m19:20:31.706574 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: BEGIN
[0m19:20:31.707623 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m19:20:31.708343 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:20:31.709060 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m19:20:31.710086 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: BEGIN
[0m19:20:31.711535 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: BEGIN
[0m19:20:31.712676 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:20:31.713604 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:20:31.715219 [debug] [Thread-2  ]: SQL status: BEGIN in 0.007 seconds
[0m19:20:31.717276 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m19:20:31.718439 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_hour
from "company_dw"."analytics"."fct_hourly_trades"
where open_hour is null



      
    ) dbt_internal_test
[0m19:20:31.719852 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m19:20:31.720704 [debug] [Thread-3  ]: SQL status: BEGIN in 0.007 seconds
[0m19:20:31.721422 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m19:20:31.722281 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m19:20:31.723357 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m19:20:31.725730 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: ROLLBACK
[0m19:20:31.726833 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_price
from "company_dw"."analytics"."fct_hourly_trades"
where open_price is null



      
    ) dbt_internal_test
[0m19:20:31.728080 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select percent_gain
from "company_dw"."analytics"."fct_hourly_trades"
where percent_gain is null



      
    ) dbt_internal_test
[0m19:20:31.729377 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: Close
[0m19:20:31.730939 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m19:20:31.731857 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m19:20:31.732862 [info ] [Thread-2  ]: 5 of 7 PASS not_null_fct_hourly_trades_open_hour ............................... [[32mPASS[0m in 0.08s]
[0m19:20:31.735392 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: ROLLBACK
[0m19:20:31.737567 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: ROLLBACK
[0m19:20:31.738819 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:20:31.740406 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: Close
[0m19:20:31.741389 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: Close
[0m19:20:31.743134 [info ] [Thread-1  ]: 6 of 7 PASS not_null_fct_hourly_trades_open_price .............................. [[32mPASS[0m in 0.08s]
[0m19:20:31.744492 [info ] [Thread-3  ]: 7 of 7 PASS not_null_fct_hourly_trades_percent_gain ............................ [[32mPASS[0m in 0.07s]
[0m19:20:31.745729 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:20:31.746909 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:20:31.750318 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:31.751178 [debug] [MainThread]: On master: BEGIN
[0m19:20:31.751976 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:20:31.756550 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:20:31.757543 [debug] [MainThread]: On master: COMMIT
[0m19:20:31.758305 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:31.759128 [debug] [MainThread]: On master: COMMIT
[0m19:20:31.760215 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:20:31.761050 [debug] [MainThread]: On master: Close
[0m19:20:31.762137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:31.762945 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd' was properly closed.
[0m19:20:31.763728 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4' was properly closed.
[0m19:20:31.764601 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f' was properly closed.
[0m19:20:31.765443 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d' was properly closed.
[0m19:20:31.766317 [info ] [MainThread]: 
[0m19:20:31.767219 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m19:20:31.769720 [debug] [MainThread]: Command end result
[0m19:20:31.770575 [info ] [MainThread]: 
[0m19:20:31.771501 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:20:31.772353 [info ] [MainThread]: 
[0m19:20:31.773253 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:20:31.774582 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.282564, "process_user_time": 3.128735, "process_kernel_time": 0.168013, "process_mem_max_rss": "113580", "process_out_blocks": "74", "process_in_blocks": "0"}
[0m19:20:31.775644 [debug] [MainThread]: Command `dbt test` succeeded at 19:20:31.775519 after 1.28 seconds
[0m19:20:31.776557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9bf4b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde99e22a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde985f0370>]}
[0m19:20:31.777488 [debug] [MainThread]: Flushing usage events
[0m19:20:36.316802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80043c2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800202b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800202b7c0>]}


============================== 19:20:36.324482 | 3d137feb-b5ba-4419-bffe-125f13abb2ca ==============================
[0m19:20:36.324482 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:20:36.325754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:20:36.533598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d137feb-b5ba-4419-bffe-125f13abb2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8003f9af40>]}
[0m19:20:36.602878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d137feb-b5ba-4419-bffe-125f13abb2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8001da1160>]}
[0m19:20:36.604439 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:20:36.635079 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:20:36.807104 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:20:36.811320 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25
[0m19:20:36.812255 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:20:36.813302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d137feb-b5ba-4419-bffe-125f13abb2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80033e3970>]}
[0m19:20:39.297163 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:20:39.298682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3d137feb-b5ba-4419-bffe-125f13abb2ca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8001989910>]}
[0m19:20:39.784446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d137feb-b5ba-4419-bffe-125f13abb2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80018a6a30>]}
[0m19:20:39.802431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d137feb-b5ba-4419-bffe-125f13abb2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800111cb80>]}
[0m19:20:39.803539 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m19:20:39.804565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d137feb-b5ba-4419-bffe-125f13abb2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80018991f0>]}
[0m19:20:39.807798 [info ] [MainThread]: 
[0m19:20:39.809914 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:20:39.816501 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m19:20:39.870299 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m19:20:39.871579 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m19:20:39.872783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:39.879674 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m19:20:39.881011 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m19:20:39.882167 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m19:20:39.886186 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m19:20:39.888641 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m19:20:39.890236 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m19:20:39.899303 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:39.900399 [debug] [MainThread]: On master: BEGIN
[0m19:20:39.901345 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:20:39.906758 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:20:39.907965 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:39.909227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:20:39.919161 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m19:20:39.921345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d137feb-b5ba-4419-bffe-125f13abb2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8003f67fd0>]}
[0m19:20:39.922357 [debug] [MainThread]: On master: ROLLBACK
[0m19:20:39.923464 [debug] [MainThread]: On master: Close
[0m19:20:39.924654 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:20:39.925661 [info ] [MainThread]: 
[0m19:20:39.935206 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m19:20:39.936346 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m19:20:39.937265 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m19:20:39.950265 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:20:39.952590 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m19:20:39.954031 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m19:20:39.956736 [debug] [Thread-3  ]: Began running node model.dbt_btc_transform.fct_hourly_trades
[0m19:20:39.957550 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m19:20:39.958236 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m19:20:39.959039 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m19:20:39.959868 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_btc_transform.fct_hourly_trades'
[0m19:20:39.961204 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872'
[0m19:20:39.962729 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m19:20:39.965009 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_btc_transform.stg_kaggle__btcusdt, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb)
[0m19:20:39.966167 [debug] [Thread-3  ]: Began compiling node model.dbt_btc_transform.fct_hourly_trades
[0m19:20:39.967212 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m19:20:39.968277 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m19:20:39.969274 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m19:20:39.974596 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_btc_transform.fct_hourly_trades"
[0m19:20:39.980503 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m19:20:39.986477 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m19:20:40.000281 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m19:20:40.003494 [debug] [Thread-3  ]: Began executing node model.dbt_btc_transform.fct_hourly_trades
[0m19:20:40.004771 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m19:20:40.006730 [debug] [Thread-3  ]: Finished running node model.dbt_btc_transform.fct_hourly_trades
[0m19:20:40.008069 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m19:20:40.008699 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m19:20:40.009799 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m19:20:40.011096 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m19:20:40.013684 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m19:20:40.016218 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m19:20:40.017539 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m19:20:40.018675 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_btc_transform.fct_hourly_trades, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a)
[0m19:20:40.019932 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m19:20:40.021109 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m19:20:40.022202 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m19:20:40.023274 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m19:20:40.024387 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m19:20:40.025754 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m19:20:40.027042 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m19:20:40.033476 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m19:20:40.034623 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m19:20:40.035692 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m19:20:40.041804 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m19:20:40.048761 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m19:20:40.055555 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m19:20:40.056716 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m19:20:40.059221 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m19:20:40.060454 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m19:20:40.061006 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m19:20:40.062167 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m19:20:40.063289 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m19:20:40.064483 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m19:20:40.066067 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m19:20:40.067509 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m19:20:40.068967 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m19:20:40.070226 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m19:20:40.071353 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m19:20:40.072587 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m19:20:40.073711 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m19:20:40.074772 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m19:20:40.075849 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m19:20:40.077180 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m19:20:40.078217 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m19:20:40.085759 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m19:20:40.086799 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m19:20:40.087890 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m19:20:40.094215 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m19:20:40.100902 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m19:20:40.107239 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m19:20:40.109192 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m19:20:40.111209 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m19:20:40.114358 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m19:20:40.117123 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m19:20:40.118274 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m19:20:40.119669 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m19:20:40.121864 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m19:20:40.124110 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m19:20:40.125926 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m19:20:40.127600 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m19:20:40.128859 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m19:20:40.130321 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m19:20:40.131932 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m19:20:40.133436 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m19:20:40.135143 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m19:20:40.136394 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m19:20:40.137646 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m19:20:40.138868 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m19:20:40.145655 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m19:20:40.154011 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m19:20:40.155188 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m19:20:40.156447 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m19:20:40.168189 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m19:20:40.169478 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m19:20:40.179383 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m19:20:40.181273 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m19:20:40.183775 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m19:20:40.185400 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m19:20:40.187717 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m19:20:40.189346 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m19:20:40.190344 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m19:20:40.192646 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m19:20:40.194332 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m19:20:40.195886 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m19:20:40.198733 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m19:20:40.200730 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m19:20:40.202755 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m19:20:40.204247 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m19:20:40.205766 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:20:40.207261 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m19:20:40.208575 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m19:20:40.218264 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m19:20:40.219896 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42, now test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433)
[0m19:20:40.221597 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m19:20:40.235738 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m19:20:40.237587 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:20:40.246878 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m19:20:40.248204 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m19:20:40.258755 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m19:20:40.260828 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m19:20:40.262869 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m19:20:40.264568 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m19:20:40.267610 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m19:20:40.269830 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:20:40.271415 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:20:40.282346 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:20:40.276625 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:20:40.279447 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae, now test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf)
[0m19:20:40.274148 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m19:20:40.289081 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:20:40.286066 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb, now test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523)
[0m19:20:40.287508 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:20:40.284217 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:20:40.306325 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d)
[0m19:20:40.292119 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:20:40.304768 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m19:20:40.290547 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4)
[0m19:20:40.307667 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:20:40.318066 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m19:20:40.320670 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:20:40.331220 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m19:20:40.332858 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:20:40.347025 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:20:40.344667 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:20:40.342106 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m19:20:40.348640 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:20:40.349935 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:20:40.351905 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:20:40.354152 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd)
[0m19:20:40.356966 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:20:40.358950 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:20:40.360100 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:20:40.361826 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:20:40.364852 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:20:40.366715 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523, now test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f)
[0m19:20:40.377976 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m19:20:40.380386 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:20:40.390410 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m19:20:40.391808 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:20:40.394450 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:20:40.396089 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:20:40.397969 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:20:40.402075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:40.403643 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4' was properly closed.
[0m19:20:40.406151 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd' was properly closed.
[0m19:20:40.408174 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f' was properly closed.
[0m19:20:40.409762 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d' was properly closed.
[0m19:20:40.420595 [debug] [MainThread]: Command end result
[0m19:20:40.644211 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m19:20:40.645145 [info ] [MainThread]: Building catalog
[0m19:20:40.658572 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m19:20:40.670354 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m19:20:40.671411 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m19:20:40.672276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:40.678100 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m19:20:40.679690 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m19:20:40.681220 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('fct_hourly_trades')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('btcusdt')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_kaggle__btcusdt')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m19:20:40.685556 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m19:20:40.692568 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m19:20:40.693966 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m19:20:40.801678 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m19:20:40.803469 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.5618277, "process_user_time": 6.229042, "process_kernel_time": 0.223303, "process_mem_max_rss": "191620", "process_out_blocks": "6713", "process_in_blocks": "0"}
[0m19:20:40.804699 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:20:40.804568 after 4.56 seconds
[0m19:20:40.805893 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:20:40.806881 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m19:20:40.808119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80043c2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800113c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8000481fd0>]}
[0m19:20:40.809238 [debug] [MainThread]: Flushing usage events
[0m19:23:52.854950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a9cfa070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a7959610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a79595b0>]}


============================== 19:23:52.863541 | ae756074-632e-4ea5-b8ea-ce6055788d8a ==============================
[0m19:23:52.863541 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:23:52.864991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models fct_hourly_trades', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:23:53.097047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae756074-632e-4ea5-b8ea-ce6055788d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a7397490>]}
[0m19:23:53.168175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae756074-632e-4ea5-b8ea-ce6055788d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a860ca90>]}
[0m19:23:53.169549 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:23:53.201678 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m19:23:53.383536 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:23:53.384833 [debug] [MainThread]: previous checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m19:23:53.385853 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:23:53.386977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ae756074-632e-4ea5-b8ea-ce6055788d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a8db5e50>]}
[0m19:23:55.685494 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:23:55.686631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ae756074-632e-4ea5-b8ea-ce6055788d8a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a6b647c0>]}
[0m19:23:56.149250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae756074-632e-4ea5-b8ea-ce6055788d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a6b7aee0>]}
[0m19:23:56.178897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae756074-632e-4ea5-b8ea-ce6055788d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a7345670>]}
[0m19:23:56.180207 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m19:23:56.181270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae756074-632e-4ea5-b8ea-ce6055788d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a6b7a160>]}
[0m19:23:56.184083 [info ] [MainThread]: 
[0m19:23:56.185265 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:23:56.192044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analytics'
[0m19:23:56.238619 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:23:56.239612 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m19:23:56.240538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:56.245843 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:23:56.246998 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m19:23:56.247989 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m19:23:56.251449 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m19:23:56.253521 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m19:23:56.254736 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m19:23:56.262561 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:56.263553 [debug] [MainThread]: On master: BEGIN
[0m19:23:56.264422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:23:56.269438 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:23:56.270464 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:56.271537 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:23:56.280591 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m19:23:56.282596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae756074-632e-4ea5-b8ea-ce6055788d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a73726d0>]}
[0m19:23:56.283606 [debug] [MainThread]: On master: ROLLBACK
[0m19:23:56.284791 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:56.285662 [debug] [MainThread]: On master: BEGIN
[0m19:23:56.286928 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:23:56.287761 [debug] [MainThread]: On master: COMMIT
[0m19:23:56.288700 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:56.289509 [debug] [MainThread]: On master: COMMIT
[0m19:23:56.290588 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:23:56.291724 [debug] [MainThread]: On master: Close
[0m19:23:56.292821 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:23:56.293712 [info ] [MainThread]: 
[0m19:23:56.302986 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:23:56.303849 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:23:56.304557 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:23:56.305461 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:23:56.306255 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23  [RUN]
[0m19:23:56.307483 [info ] [Thread-2  ]: 2 of 7 START test dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour  [RUN]
[0m19:23:56.308750 [info ] [Thread-3  ]: 3 of 7 START test not_null_fct_hourly_trades_close_price ....................... [RUN]
[0m19:23:56.309929 [info ] [Thread-4  ]: 4 of 7 START test not_null_fct_hourly_trades_open_date ......................... [RUN]
[0m19:23:56.311100 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433)
[0m19:23:56.312307 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf'
[0m19:23:56.313454 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523'
[0m19:23:56.315022 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d'
[0m19:23:56.316350 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:23:56.317457 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:23:56.318501 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:23:56.319548 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:23:56.333892 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m19:23:56.340106 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m19:23:56.353292 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m19:23:56.359003 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m19:23:56.361498 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:23:56.363423 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:23:56.404434 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m19:23:56.405466 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:23:56.406254 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:23:56.411144 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m19:23:56.417611 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m19:23:56.423579 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m19:23:56.425043 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m19:23:56.428317 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m19:23:56.429401 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: BEGIN
[0m19:23:56.430351 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m19:23:56.431403 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: BEGIN
[0m19:23:56.432245 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m19:23:56.433191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:23:56.434238 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: BEGIN
[0m19:23:56.435359 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:23:56.436807 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: BEGIN
[0m19:23:56.438948 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:23:56.441125 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:23:56.442790 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m19:23:56.444604 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m19:23:56.445665 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m19:23:56.446917 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        open_hour as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."fct_hourly_trades"
    group by open_hour

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23'
)



      
    ) dbt_internal_test
[0m19:23:56.447920 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m19:23:56.449136 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m19:23:56.449969 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m19:23:56.451337 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m19:23:56.452161 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m19:23:56.453119 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        open_date, open_hour
    from "company_dw"."analytics"."fct_hourly_trades"
    group by open_date, open_hour
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m19:23:56.454198 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m19:23:56.455392 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price
from "company_dw"."analytics"."fct_hourly_trades"
where close_price is null



      
    ) dbt_internal_test
[0m19:23:56.461321 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: ROLLBACK
[0m19:23:56.462995 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_date
from "company_dw"."analytics"."fct_hourly_trades"
where open_date is null



      
    ) dbt_internal_test
[0m19:23:56.463830 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m19:23:56.465494 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m19:23:56.466400 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: Close
[0m19:23:56.467152 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m19:23:56.469380 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: ROLLBACK
[0m19:23:56.471754 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: ROLLBACK
[0m19:23:56.473310 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23  [[32mPASS[0m in 0.16s]
[0m19:23:56.475682 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: ROLLBACK
[0m19:23:56.477032 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: Close
[0m19:23:56.478030 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: Close
[0m19:23:56.479030 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:23:56.480432 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: Close
[0m19:23:56.481568 [info ] [Thread-2  ]: 2 of 7 PASS dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour  [[32mPASS[0m in 0.17s]
[0m19:23:56.483059 [info ] [Thread-3  ]: 3 of 7 PASS not_null_fct_hourly_trades_close_price ............................. [[32mPASS[0m in 0.17s]
[0m19:23:56.484316 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:23:56.485927 [info ] [Thread-4  ]: 4 of 7 PASS not_null_fct_hourly_trades_open_date ............................... [[32mPASS[0m in 0.17s]
[0m19:23:56.487274 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:23:56.488534 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:23:56.489528 [info ] [Thread-1  ]: 5 of 7 START test not_null_fct_hourly_trades_open_hour ......................... [RUN]
[0m19:23:56.490989 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:23:56.492142 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:23:56.493360 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:23:56.494638 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4)
[0m19:23:56.496341 [info ] [Thread-2  ]: 6 of 7 START test not_null_fct_hourly_trades_open_price ........................ [RUN]
[0m19:23:56.497493 [info ] [Thread-3  ]: 7 of 7 START test not_null_fct_hourly_trades_percent_gain ...................... [RUN]
[0m19:23:56.498562 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:23:56.499579 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd)
[0m19:23:56.500741 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523, now test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f)
[0m19:23:56.507249 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m19:23:56.508237 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:23:56.509249 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:23:56.515701 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m19:23:56.517086 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:23:56.523469 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m19:23:56.528459 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m19:23:56.530423 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:23:56.534970 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m19:23:56.535805 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:23:56.537077 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m19:23:56.542243 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m19:23:56.543396 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: BEGIN
[0m19:23:56.544256 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m19:23:56.545627 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:23:56.546827 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: BEGIN
[0m19:23:56.547879 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m19:23:56.549405 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:23:56.550937 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: BEGIN
[0m19:23:56.552865 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:23:56.553802 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m19:23:56.555438 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m19:23:56.556704 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_hour
from "company_dw"."analytics"."fct_hourly_trades"
where open_hour is null



      
    ) dbt_internal_test
[0m19:23:56.557475 [debug] [Thread-2  ]: SQL status: BEGIN in 0.008 seconds
[0m19:23:56.559292 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m19:23:56.560139 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m19:23:56.560955 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m19:23:56.562086 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m19:23:56.563202 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_price
from "company_dw"."analytics"."fct_hourly_trades"
where open_price is null



      
    ) dbt_internal_test
[0m19:23:56.565766 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: ROLLBACK
[0m19:23:56.566969 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select percent_gain
from "company_dw"."analytics"."fct_hourly_trades"
where percent_gain is null



      
    ) dbt_internal_test
[0m19:23:56.568791 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: Close
[0m19:23:56.569476 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m19:23:56.571094 [info ] [Thread-1  ]: 5 of 7 PASS not_null_fct_hourly_trades_open_hour ............................... [[32mPASS[0m in 0.08s]
[0m19:23:56.571924 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m19:23:56.574264 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: ROLLBACK
[0m19:23:56.575617 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:23:56.578063 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: ROLLBACK
[0m19:23:56.579458 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: Close
[0m19:23:56.581183 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: Close
[0m19:23:56.582343 [info ] [Thread-2  ]: 6 of 7 PASS not_null_fct_hourly_trades_open_price .............................. [[32mPASS[0m in 0.08s]
[0m19:23:56.583823 [info ] [Thread-3  ]: 7 of 7 PASS not_null_fct_hourly_trades_percent_gain ............................ [[32mPASS[0m in 0.08s]
[0m19:23:56.585262 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:23:56.586705 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:23:56.590424 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:56.591322 [debug] [MainThread]: On master: BEGIN
[0m19:23:56.592180 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:23:56.597174 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:23:56.598159 [debug] [MainThread]: On master: COMMIT
[0m19:23:56.599022 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:56.599846 [debug] [MainThread]: On master: COMMIT
[0m19:23:56.600990 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:23:56.601816 [debug] [MainThread]: On master: Close
[0m19:23:56.602885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:56.603710 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4' was properly closed.
[0m19:23:56.604518 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd' was properly closed.
[0m19:23:56.605371 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f' was properly closed.
[0m19:23:56.606202 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d' was properly closed.
[0m19:23:56.607121 [info ] [MainThread]: 
[0m19:23:56.608041 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m19:23:56.610525 [debug] [MainThread]: Command end result
[0m19:23:56.611328 [info ] [MainThread]: 
[0m19:23:56.612342 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:56.613355 [info ] [MainThread]: 
[0m19:23:56.614371 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:23:56.615881 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.832736, "process_user_time": 5.658274, "process_kernel_time": 0.17966, "process_mem_max_rss": "118992", "process_out_blocks": "1252", "process_in_blocks": "0"}
[0m19:23:56.617037 [debug] [MainThread]: Command `dbt test` succeeded at 19:23:56.616823 after 3.83 seconds
[0m19:23:56.618215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a9cfa070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a671a4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a860ca90>]}
[0m19:23:56.619135 [debug] [MainThread]: Flushing usage events
[0m19:24:02.311834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9741cee0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973f959880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973f959820>]}


============================== 19:24:02.319639 | 5060a55e-f4f7-4a8f-bd72-c8e93935f0b1 ==============================
[0m19:24:02.319639 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:24:02.321032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m19:24:02.540357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5060a55e-f4f7-4a8f-bd72-c8e93935f0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973f39d550>]}
[0m19:24:02.610834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5060a55e-f4f7-4a8f-bd72-c8e93935f0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973f37abb0>]}
[0m19:24:02.612239 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:24:02.642178 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:24:02.828786 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:24:02.829855 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25
[0m19:24:02.830724 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:24:02.831795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5060a55e-f4f7-4a8f-bd72-c8e93935f0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9740ca4c70>]}
[0m19:24:04.968512 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:24:04.969697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5060a55e-f4f7-4a8f-bd72-c8e93935f0b1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973ebf3070>]}
[0m19:24:05.549774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5060a55e-f4f7-4a8f-bd72-c8e93935f0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973eb90880>]}
[0m19:24:05.589402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5060a55e-f4f7-4a8f-bd72-c8e93935f0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973eb9af10>]}
[0m19:24:05.602080 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m19:24:05.603975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5060a55e-f4f7-4a8f-bd72-c8e93935f0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973e2bb520>]}
[0m19:24:05.616135 [info ] [MainThread]: 
[0m19:24:05.618722 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:24:05.681235 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m19:24:05.764834 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m19:24:05.766045 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m19:24:05.766986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:05.775905 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m19:24:05.776908 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m19:24:05.777792 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m19:24:05.782307 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:24:05.784889 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m19:24:05.786312 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m19:24:05.794257 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:05.795278 [debug] [MainThread]: On master: BEGIN
[0m19:24:05.796074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:24:05.802145 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m19:24:05.803219 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:05.804311 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:24:05.813801 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m19:24:05.816544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5060a55e-f4f7-4a8f-bd72-c8e93935f0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973faf5eb0>]}
[0m19:24:05.817938 [debug] [MainThread]: On master: ROLLBACK
[0m19:24:05.819053 [debug] [MainThread]: On master: Close
[0m19:24:05.820668 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:24:05.821881 [info ] [MainThread]: 
[0m19:24:05.832287 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m19:24:05.834023 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m19:24:05.835174 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m19:24:05.849001 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m19:24:05.852744 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m19:24:05.854624 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m19:24:05.857161 [debug] [Thread-3  ]: Began running node model.dbt_btc_transform.fct_hourly_trades
[0m19:24:05.858213 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m19:24:05.859114 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m19:24:05.859883 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m19:24:05.860920 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_btc_transform.fct_hourly_trades'
[0m19:24:05.862433 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872'
[0m19:24:05.864583 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m19:24:05.866091 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_btc_transform.stg_kaggle__btcusdt, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb)
[0m19:24:05.867276 [debug] [Thread-3  ]: Began compiling node model.dbt_btc_transform.fct_hourly_trades
[0m19:24:05.868358 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m19:24:05.869514 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m19:24:05.870681 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m19:24:05.877038 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_btc_transform.fct_hourly_trades"
[0m19:24:05.885121 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m19:24:05.892637 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m19:24:05.910532 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m19:24:05.914102 [debug] [Thread-3  ]: Began executing node model.dbt_btc_transform.fct_hourly_trades
[0m19:24:05.917253 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m19:24:05.918485 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m19:24:05.920094 [debug] [Thread-3  ]: Finished running node model.dbt_btc_transform.fct_hourly_trades
[0m19:24:05.921460 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m19:24:05.923935 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m19:24:05.926856 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m19:24:05.928900 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m19:24:05.931913 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m19:24:05.934115 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m19:24:05.936019 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m19:24:05.938348 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_btc_transform.fct_hourly_trades, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a)
[0m19:24:05.941043 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m19:24:05.942882 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m19:24:05.945483 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m19:24:05.947749 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m19:24:05.951544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m19:24:05.953794 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m19:24:05.957255 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m19:24:05.975692 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m19:24:05.978120 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m19:24:05.996041 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m19:24:06.008054 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m19:24:06.045139 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m19:24:06.047642 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m19:24:06.051749 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m19:24:06.055590 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m19:24:06.056891 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m19:24:06.059037 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m19:24:06.060508 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m19:24:06.062091 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m19:24:06.064018 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m19:24:06.065637 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m19:24:06.068404 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m19:24:06.070920 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m19:24:06.073713 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m19:24:06.075817 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m19:24:06.077490 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m19:24:06.079196 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m19:24:06.080723 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m19:24:06.083731 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m19:24:06.086078 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m19:24:06.098172 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m19:24:06.100007 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m19:24:06.109129 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m19:24:06.110892 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m19:24:06.123012 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m19:24:06.125139 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m19:24:06.140735 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m19:24:06.142900 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m19:24:06.144521 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m19:24:06.147321 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m19:24:06.150964 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m19:24:06.152750 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m19:24:06.153920 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m19:24:06.155876 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m19:24:06.157290 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m19:24:06.159511 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m19:24:06.161050 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m19:24:06.162390 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m19:24:06.163846 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m19:24:06.165214 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m19:24:06.166473 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m19:24:06.168006 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m19:24:06.169448 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m19:24:06.170989 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m19:24:06.178026 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m19:24:06.179132 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m19:24:06.187175 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m19:24:06.188290 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m19:24:06.199017 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m19:24:06.201175 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m19:24:06.210329 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m19:24:06.211784 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m19:24:06.214232 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m19:24:06.216110 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m19:24:06.219256 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m19:24:06.220503 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m19:24:06.221483 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m19:24:06.223794 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m19:24:06.225402 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m19:24:06.227221 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m19:24:06.228376 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m19:24:06.229727 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m19:24:06.230889 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m19:24:06.232247 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:24:06.233370 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m19:24:06.234816 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m19:24:06.236188 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m19:24:06.238441 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42, now test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433)
[0m19:24:06.246665 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m19:24:06.247978 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m19:24:06.259223 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m19:24:06.260411 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:24:06.268891 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m19:24:06.270513 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m19:24:06.283947 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m19:24:06.285587 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m19:24:06.287436 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m19:24:06.288954 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m19:24:06.290500 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m19:24:06.291858 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:24:06.292892 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:24:06.294530 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m19:24:06.295883 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:24:06.315540 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m19:24:06.322595 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae, now test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf)
[0m19:24:06.324290 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:24:06.325790 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb, now test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523)
[0m19:24:06.327404 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:24:06.328871 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:24:06.330346 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d)
[0m19:24:06.331688 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:24:06.333534 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4)
[0m19:24:06.343401 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m19:24:06.344506 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:24:06.352973 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m19:24:06.354131 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:24:06.363597 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m19:24:06.375158 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m19:24:06.376987 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:24:06.378986 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:24:06.382198 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m19:24:06.384381 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:24:06.385998 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:24:06.387611 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m19:24:06.389157 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:24:06.391246 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m19:24:06.392975 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m19:24:06.394492 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:24:06.396115 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd)
[0m19:24:06.399098 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523, now test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f)
[0m19:24:06.400869 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:24:06.402373 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:24:06.411355 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m19:24:06.420410 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m19:24:06.423271 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:24:06.425648 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m19:24:06.426594 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:24:06.429462 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m19:24:06.433397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:06.435153 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4' was properly closed.
[0m19:24:06.436800 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd' was properly closed.
[0m19:24:06.438052 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d' was properly closed.
[0m19:24:06.439445 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f' was properly closed.
[0m19:24:06.446975 [debug] [MainThread]: Command end result
[0m19:24:06.724617 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m19:24:06.726233 [info ] [MainThread]: Building catalog
[0m19:24:06.753356 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m19:24:06.786958 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m19:24:06.788899 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m19:24:06.790889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:06.801262 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:24:06.803286 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m19:24:06.805512 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_kaggle__btcusdt')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('btcusdt')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('fct_hourly_trades')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m19:24:06.812202 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.005 seconds
[0m19:24:06.824740 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m19:24:06.826348 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m19:24:06.936331 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m19:24:06.938136 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.7003694, "process_user_time": 6.433608, "process_kernel_time": 0.225414, "process_mem_max_rss": "191620", "process_out_blocks": "6713", "process_in_blocks": "0"}
[0m19:24:06.939399 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:24:06.939263 after 4.70 seconds
[0m19:24:06.940305 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:24:06.941058 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m19:24:06.941826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9741cee0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97417f6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973f37abb0>]}
[0m19:24:06.942688 [debug] [MainThread]: Flushing usage events
[0m12:49:26.990185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c9e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185f3d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1185f3520>]}


============================== 12:49:26.997111 | 1d892712-d284-45a0-a779-297dada5d8cf ==============================
[0m12:49:26.997111 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:49:26.997735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/devincavagnaro/Documents/dev/dbt-btc-data-stack/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/devincavagnaro/Documents/dev/dbt-btc-data-stack/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:49:27.003676 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'POSTGRES_USER'
[0m12:49:27.006719 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.09498509, "process_user_time": 1.965354, "process_kernel_time": 0.507858, "process_mem_max_rss": "98443264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:49:27.007725 [debug] [MainThread]: Command `dbt docs generate` failed at 12:49:27.007572 after 0.10 seconds
[0m12:49:27.008152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c9e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186471c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118647e50>]}
[0m12:49:27.008545 [debug] [MainThread]: Flushing usage events
[0m17:49:40.762642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eadf010a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eabb98640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eabb985e0>]}


============================== 17:49:40.773400 | 51edbd6c-ca88-406f-817f-c0a5b8564fc5 ==============================
[0m17:49:40.773400 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:49:40.774849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:49:41.229225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51edbd6c-ca88-406f-817f-c0a5b8564fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eabc08160>]}
[0m17:49:41.363309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51edbd6c-ca88-406f-817f-c0a5b8564fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eabbc8a60>]}
[0m17:49:41.365285 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:49:41.417727 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m17:49:41.621257 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:49:41.622424 [debug] [MainThread]: previous checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m17:49:41.623323 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:49:41.624362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '51edbd6c-ca88-406f-817f-c0a5b8564fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eacec7c70>]}
[0m17:49:43.831555 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:49:43.832652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '51edbd6c-ca88-406f-817f-c0a5b8564fc5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eaa55d190>]}
[0m17:49:44.281650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51edbd6c-ca88-406f-817f-c0a5b8564fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eaad43c70>]}
[0m17:49:44.314529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51edbd6c-ca88-406f-817f-c0a5b8564fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eaa5cf790>]}
[0m17:49:44.315705 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m17:49:44.316735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51edbd6c-ca88-406f-817f-c0a5b8564fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eaad40640>]}
[0m17:49:44.319178 [info ] [MainThread]: 
[0m17:49:44.320567 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:49:44.322506 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m17:49:44.417945 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m17:49:44.418958 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m17:49:44.419769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:44.426145 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m17:49:44.428217 [debug] [ThreadPool]: On list_company_dw: Close
[0m17:49:44.435639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m17:49:44.445329 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m17:49:44.446527 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m17:49:44.447412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:44.453847 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m17:49:44.454905 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m17:49:44.455837 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:49:44.470561 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.014 seconds
[0m17:49:44.472671 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m17:49:44.473739 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m17:49:44.482095 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:44.483136 [debug] [MainThread]: On master: BEGIN
[0m17:49:44.484027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:44.489561 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m17:49:44.490547 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:44.491652 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:49:44.514588 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m17:49:44.516618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51edbd6c-ca88-406f-817f-c0a5b8564fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eabbb6340>]}
[0m17:49:44.517630 [debug] [MainThread]: On master: ROLLBACK
[0m17:49:44.518764 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:44.519605 [debug] [MainThread]: On master: BEGIN
[0m17:49:44.520995 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:49:44.521869 [debug] [MainThread]: On master: COMMIT
[0m17:49:44.522712 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:44.523504 [debug] [MainThread]: On master: COMMIT
[0m17:49:44.524559 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:49:44.525425 [debug] [MainThread]: On master: Close
[0m17:49:44.526670 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:49:44.527577 [info ] [MainThread]: 
[0m17:49:44.537693 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m17:49:44.538914 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m17:49:44.539983 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m17:49:44.540918 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m17:49:44.553909 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m17:49:44.558763 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m17:49:44.614709 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m17:49:44.620725 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m17:49:44.621836 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m17:49:44.622733 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:44.628704 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m17:49:44.630093 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m17:49:44.631652 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    -- I hate just putting a distinct to deal with duplicates but doing this because there are dupes in the source data.
    -- I would rather investigate why this is happening at the source and fix there but need to work
    -- with what was given
    select distinct 
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote_asset_volume,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        open_time::date as open_date,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minutes from open_time) = 0
            and extract(second from open_time) = 0
                then true
            else false
        end as hour_start,

        case    
            when extract(minutes from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as hour_end
            

    from source

)

select * from final
  );
  
[0m17:50:22.058035 [debug] [Thread-1  ]: SQL status: SELECT 9999891 in 37.421 seconds
[0m17:50:22.125025 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m17:50:22.127827 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt" rename to "stg_kaggle__btcusdt__dbt_backup"
[0m17:50:22.137595 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.006 seconds
[0m17:50:22.148968 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m17:50:22.150834 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp" rename to "stg_kaggle__btcusdt"
[0m17:50:22.153553 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:50:22.204504 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m17:50:22.207349 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m17:50:22.208939 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m17:50:22.211409 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m17:50:22.226445 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup"
[0m17:50:22.234857 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m17:50:22.236329 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
drop table if exists "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup" cascade
[0m17:50:22.257357 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.020 seconds
[0m17:50:22.264131 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m17:50:22.269217 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51edbd6c-ca88-406f-817f-c0a5b8564fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea9cdfb50>]}
[0m17:50:22.271730 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.stg_kaggle__btcusdt ................ [[32mSELECT 9999891[0m in 37.73s]
[0m17:50:22.274592 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m17:50:22.280755 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:22.282252 [debug] [MainThread]: On master: BEGIN
[0m17:50:22.283469 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:22.297441 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m17:50:22.299960 [debug] [MainThread]: On master: COMMIT
[0m17:50:22.303084 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:22.305536 [debug] [MainThread]: On master: COMMIT
[0m17:50:22.308678 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:50:22.310809 [debug] [MainThread]: On master: Close
[0m17:50:22.313964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:22.316752 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m17:50:22.318712 [info ] [MainThread]: 
[0m17:50:22.320653 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 38.00 seconds (38.00s).
[0m17:50:22.323903 [debug] [MainThread]: Command end result
[0m17:50:22.326005 [info ] [MainThread]: 
[0m17:50:22.328033 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:22.329652 [info ] [MainThread]: 
[0m17:50:22.331468 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:50:22.341887 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 41.674206, "process_user_time": 5.910301, "process_kernel_time": 0.952495, "process_mem_max_rss": "115544", "process_in_blocks": "51472", "process_out_blocks": "1220"}
[0m17:50:22.345052 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:22.344643 after 41.68 seconds
[0m17:50:22.347826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eadf010a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eaa8fe700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eabbc8a60>]}
[0m17:50:22.349713 [debug] [MainThread]: Flushing usage events
[0m17:50:29.202389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e2260b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e2026b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e2026b640>]}


============================== 17:50:29.215046 | 84befdc0-f916-4689-bb56-697ecec5d5e8 ==============================
[0m17:50:29.215046 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:50:29.216988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models fct_hourly_trades', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:50:29.477949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84befdc0-f916-4689-bb56-697ecec5d5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e202913d0>]}
[0m17:50:29.549015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84befdc0-f916-4689-bb56-697ecec5d5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e22b9ddf0>]}
[0m17:50:29.550575 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:50:29.585377 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m17:50:29.870784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:50:29.871601 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:50:29.948339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84befdc0-f916-4689-bb56-697ecec5d5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1f2eb130>]}
[0m17:50:29.966779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84befdc0-f916-4689-bb56-697ecec5d5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1f295ca0>]}
[0m17:50:29.967901 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m17:50:29.968837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84befdc0-f916-4689-bb56-697ecec5d5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1f7e74c0>]}
[0m17:50:29.971356 [info ] [MainThread]: 
[0m17:50:29.972688 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:50:29.974480 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m17:50:30.091219 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m17:50:30.092538 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m17:50:30.093587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:30.101426 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m17:50:30.103796 [debug] [ThreadPool]: On list_company_dw: Close
[0m17:50:30.112378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m17:50:30.123174 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m17:50:30.124496 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m17:50:30.125461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:30.130802 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m17:50:30.131858 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m17:50:30.132893 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:50:30.138196 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m17:50:30.140434 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m17:50:30.141738 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m17:50:30.150710 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:30.151731 [debug] [MainThread]: On master: BEGIN
[0m17:50:30.152662 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:30.158271 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:50:30.159343 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:30.160673 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:50:30.170589 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m17:50:30.172662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84befdc0-f916-4689-bb56-697ecec5d5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1f2d99d0>]}
[0m17:50:30.173715 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:30.174927 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:30.175983 [debug] [MainThread]: On master: BEGIN
[0m17:50:30.177523 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:50:30.178542 [debug] [MainThread]: On master: COMMIT
[0m17:50:30.179468 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:30.180381 [debug] [MainThread]: On master: COMMIT
[0m17:50:30.181482 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:50:30.182454 [debug] [MainThread]: On master: Close
[0m17:50:30.183582 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:50:30.184498 [info ] [MainThread]: 
[0m17:50:30.198338 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.fct_hourly_trades
[0m17:50:30.199684 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.fct_hourly_trades ....................... [RUN]
[0m17:50:30.200906 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.fct_hourly_trades)
[0m17:50:30.201961 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.fct_hourly_trades
[0m17:50:30.215137 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.fct_hourly_trades"
[0m17:50:30.219687 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.fct_hourly_trades
[0m17:50:30.277777 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.fct_hourly_trades"
[0m17:50:30.281447 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m17:50:30.282552 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: BEGIN
[0m17:50:30.283530 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:30.288694 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m17:50:30.289837 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m17:50:30.290930 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.fct_hourly_trades"} */

  
    

  create  table "company_dw"."analytics"."fct_hourly_trades__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."analytics"."stg_kaggle__btcusdt"

),


hourly as (

    select
        open_date,
        extract(hours from open_time) as open_hour,

        max(
            case
                when hour_start is true
                    then open
            end 
        ) as open_price,

        max(
            case
                when hour_end is true
                    then close
            end
        ) as close_price

    from source

    where
        hour_start is true or hour_end is true
    
    group by 1, 2

),


final as (

    select
        open_date,
        open_hour,
        open_price,
        close_price,       
        (close_price - open_price) * 1.00000000000000 / open_price as percent_gain

    from hourly

    where 
        open_price is not null
        and close_price is not null

)

select * from final
  );
  
[0m17:50:34.656924 [debug] [Thread-1  ]: SQL status: SELECT 2775 in 4.364 seconds
[0m17:50:34.672413 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m17:50:34.673602 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.fct_hourly_trades"} */
alter table "company_dw"."analytics"."fct_hourly_trades" rename to "fct_hourly_trades__dbt_backup"
[0m17:50:34.676229 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:50:34.681834 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m17:50:34.682896 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.fct_hourly_trades"} */
alter table "company_dw"."analytics"."fct_hourly_trades__dbt_tmp" rename to "fct_hourly_trades"
[0m17:50:34.685488 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:50:34.718038 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: COMMIT
[0m17:50:34.719196 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m17:50:34.720178 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: COMMIT
[0m17:50:35.211251 [debug] [Thread-1  ]: SQL status: COMMIT in 0.490 seconds
[0m17:50:35.221271 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."fct_hourly_trades__dbt_backup"
[0m17:50:35.229728 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m17:50:35.231653 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.fct_hourly_trades"} */
drop table if exists "company_dw"."analytics"."fct_hourly_trades__dbt_backup" cascade
[0m17:50:35.240685 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.008 seconds
[0m17:50:35.247833 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: Close
[0m17:50:35.251508 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84befdc0-f916-4689-bb56-697ecec5d5e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1eb409a0>]}
[0m17:50:35.253508 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.fct_hourly_trades .................. [[32mSELECT 2775[0m in 5.05s]
[0m17:50:35.255448 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.fct_hourly_trades
[0m17:50:35.259695 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:35.260797 [debug] [MainThread]: On master: BEGIN
[0m17:50:35.261726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:35.269267 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:50:35.270455 [debug] [MainThread]: On master: COMMIT
[0m17:50:35.271506 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:35.272493 [debug] [MainThread]: On master: COMMIT
[0m17:50:35.273730 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:50:35.274739 [debug] [MainThread]: On master: Close
[0m17:50:35.276089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:35.277640 [debug] [MainThread]: Connection 'model.dbt_btc_transform.fct_hourly_trades' was properly closed.
[0m17:50:35.278764 [info ] [MainThread]: 
[0m17:50:35.279831 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m17:50:35.281361 [debug] [MainThread]: Command end result
[0m17:50:35.282304 [info ] [MainThread]: 
[0m17:50:35.283652 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:35.284850 [info ] [MainThread]: 
[0m17:50:35.286099 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:50:35.288938 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1795897, "process_user_time": 3.530205, "process_kernel_time": 0.333057, "process_mem_max_rss": "109148", "process_out_blocks": "40", "process_in_blocks": "0"}
[0m17:50:35.290626 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:35.290376 after 6.18 seconds
[0m17:50:35.292124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e2260b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1fad7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1f7e7850>]}
[0m17:50:35.293503 [debug] [MainThread]: Flushing usage events
[0m17:50:39.486075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a0421100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09e0ab6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09e0ab640>]}


============================== 17:50:39.494045 | feba2d07-aa9f-4c11-8b0c-911d2b41a202 ==============================
[0m17:50:39.494045 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:50:39.495325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models stg_kaggle__btcusdt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:50:39.735968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'feba2d07-aa9f-4c11-8b0c-911d2b41a202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09e0d13d0>]}
[0m17:50:39.811308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'feba2d07-aa9f-4c11-8b0c-911d2b41a202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a09badf0>]}
[0m17:50:39.813059 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:50:39.847815 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m17:50:40.141197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:50:40.142044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:50:40.224225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'feba2d07-aa9f-4c11-8b0c-911d2b41a202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09d0eb130>]}
[0m17:50:40.259467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'feba2d07-aa9f-4c11-8b0c-911d2b41a202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09d5e07f0>]}
[0m17:50:40.260674 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m17:50:40.261659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feba2d07-aa9f-4c11-8b0c-911d2b41a202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09d5e0220>]}
[0m17:50:40.265088 [info ] [MainThread]: 
[0m17:50:40.266376 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:50:40.273328 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analytics'
[0m17:50:40.391426 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m17:50:40.392522 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m17:50:40.393608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:40.401199 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m17:50:40.402324 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m17:50:40.403440 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:50:40.407440 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m17:50:40.409716 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m17:50:40.410972 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m17:50:40.419732 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:40.420798 [debug] [MainThread]: On master: BEGIN
[0m17:50:40.421647 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:40.427113 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m17:50:40.428206 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:40.429413 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:50:40.438660 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m17:50:40.440723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feba2d07-aa9f-4c11-8b0c-911d2b41a202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09e0c83d0>]}
[0m17:50:40.441933 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:40.443080 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:40.443968 [debug] [MainThread]: On master: BEGIN
[0m17:50:40.445498 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:50:40.446741 [debug] [MainThread]: On master: COMMIT
[0m17:50:40.447688 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:40.448709 [debug] [MainThread]: On master: COMMIT
[0m17:50:40.449881 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:50:40.450732 [debug] [MainThread]: On master: Close
[0m17:50:40.451831 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:50:40.452795 [info ] [MainThread]: 
[0m17:50:40.465162 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m17:50:40.466016 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m17:50:40.466721 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m17:50:40.467527 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m17:50:40.468238 [info ] [Thread-1  ]: 1 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_end__True__False ... [RUN]
[0m17:50:40.469498 [info ] [Thread-2  ]: 2 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_start__True__False . [RUN]
[0m17:50:40.470607 [info ] [Thread-3  ]: 3 of 18 START test not_null_stg_kaggle__btcusdt_close .......................... [RUN]
[0m17:50:40.471876 [info ] [Thread-4  ]: 4 of 18 START test not_null_stg_kaggle__btcusdt_close_time ..................... [RUN]
[0m17:50:40.473110 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872)
[0m17:50:40.474324 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m17:50:40.475547 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb'
[0m17:50:40.476681 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a'
[0m17:50:40.477852 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m17:50:40.479002 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m17:50:40.480001 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m17:50:40.481012 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m17:50:40.509553 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m17:50:40.510938 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m17:50:40.522776 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m17:50:40.528772 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m17:50:40.533645 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m17:50:40.534686 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m17:50:40.541706 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m17:50:40.542434 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m17:50:40.559361 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m17:50:40.563843 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m17:50:40.568964 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m17:50:40.572991 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m17:50:40.578939 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m17:50:40.579980 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m17:50:40.580995 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: BEGIN
[0m17:50:40.582134 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m17:50:40.583077 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: BEGIN
[0m17:50:40.583980 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m17:50:40.584900 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:40.585921 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: BEGIN
[0m17:50:40.586897 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:50:40.587947 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: BEGIN
[0m17:50:40.590549 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m17:50:40.592787 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:50:40.595145 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m17:50:40.597427 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m17:50:40.599219 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_end as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_end

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m17:50:40.600195 [debug] [Thread-3  ]: SQL status: BEGIN in 0.013 seconds
[0m17:50:40.602117 [debug] [Thread-2  ]: SQL status: BEGIN in 0.012 seconds
[0m17:50:40.603041 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m17:50:40.603822 [debug] [Thread-4  ]: SQL status: BEGIN in 0.011 seconds
[0m17:50:40.605025 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m17:50:40.606368 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close is null



      
    ) dbt_internal_test
[0m17:50:40.607698 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m17:50:40.608947 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_start as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_start

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m17:50:40.611205 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is null



      
    ) dbt_internal_test
[0m17:50:41.528794 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.918 seconds
[0m17:50:41.541658 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: ROLLBACK
[0m17:50:41.544391 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: Close
[0m17:50:41.547138 [info ] [Thread-4  ]: 4 of 18 PASS not_null_stg_kaggle__btcusdt_close_time ........................... [[32mPASS[0m in 1.07s]
[0m17:50:41.550215 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m17:50:41.552524 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m17:50:41.555015 [info ] [Thread-4  ]: 5 of 18 START test not_null_stg_kaggle__btcusdt_high ........................... [RUN]
[0m17:50:41.558451 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m17:50:41.560424 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m17:50:41.574151 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m17:50:41.578466 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m17:50:41.584853 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m17:50:41.588316 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m17:50:41.590185 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: BEGIN
[0m17:50:41.592212 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:50:41.602149 [debug] [Thread-4  ]: SQL status: BEGIN in 0.010 seconds
[0m17:50:41.604094 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m17:50:41.606216 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where high is null



      
    ) dbt_internal_test
[0m17:50:41.791518 [debug] [Thread-3  ]: SQL status: SELECT 1 in 1.184 seconds
[0m17:50:41.797817 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: ROLLBACK
[0m17:50:41.801549 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: Close
[0m17:50:41.807744 [info ] [Thread-3  ]: 3 of 18 PASS not_null_stg_kaggle__btcusdt_close ................................ [[32mPASS[0m in 1.33s]
[0m17:50:41.816035 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m17:50:41.819510 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m17:50:41.821995 [info ] [Thread-3  ]: 6 of 18 START test not_null_stg_kaggle__btcusdt_hour_end ....................... [RUN]
[0m17:50:41.826701 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m17:50:41.830231 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m17:50:41.845832 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m17:50:41.855410 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m17:50:41.866067 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m17:50:41.871759 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m17:50:41.873727 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: BEGIN
[0m17:50:41.878876 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:50:41.888078 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m17:50:41.890316 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m17:50:41.892437 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_end
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_end is null



      
    ) dbt_internal_test
[0m17:50:42.579597 [debug] [Thread-1  ]: SQL status: SELECT 1 in 1.980 seconds
[0m17:50:42.584732 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: ROLLBACK
[0m17:50:42.587094 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: Close
[0m17:50:42.589463 [info ] [Thread-1  ]: 1 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_end__True__False ......... [[32mPASS[0m in 2.12s]
[0m17:50:42.595723 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m17:50:42.599232 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m17:50:42.601751 [info ] [Thread-1  ]: 7 of 18 START test not_null_stg_kaggle__btcusdt_hour_start ..................... [RUN]
[0m17:50:42.604972 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m17:50:42.607226 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m17:50:42.609201 [debug] [Thread-4  ]: SQL status: SELECT 1 in 1.001 seconds
[0m17:50:42.626133 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m17:50:42.629656 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: ROLLBACK
[0m17:50:42.633732 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: Close
[0m17:50:42.636445 [info ] [Thread-4  ]: 5 of 18 PASS not_null_stg_kaggle__btcusdt_high ................................. [[32mPASS[0m in 1.08s]
[0m17:50:42.638876 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m17:50:42.640522 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m17:50:42.641962 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m17:50:42.651768 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m17:50:42.653694 [info ] [Thread-4  ]: 8 of 18 START test not_null_stg_kaggle__btcusdt_low ............................ [RUN]
[0m17:50:42.657464 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m17:50:42.659264 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m17:50:42.666331 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m17:50:42.669785 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m17:50:42.671154 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: BEGIN
[0m17:50:42.673191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:42.674530 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m17:50:42.681184 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m17:50:42.683135 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m17:50:42.684931 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m17:50:42.686205 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m17:50:42.687392 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_start
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_start is null



      
    ) dbt_internal_test
[0m17:50:42.688758 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: BEGIN
[0m17:50:42.691121 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:50:42.700567 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m17:50:42.702556 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m17:50:42.704973 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where low is null



      
    ) dbt_internal_test
[0m17:50:43.311778 [debug] [Thread-2  ]: SQL status: SELECT 1 in 2.701 seconds
[0m17:50:43.317824 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: ROLLBACK
[0m17:50:43.320732 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: Close
[0m17:50:43.325121 [info ] [Thread-2  ]: 2 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_start__True__False ....... [[32mPASS[0m in 2.85s]
[0m17:50:43.328520 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m17:50:43.331315 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m17:50:43.334201 [info ] [Thread-2  ]: 9 of 18 START test not_null_stg_kaggle__btcusdt_number_of_trades ............... [RUN]
[0m17:50:43.336707 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m17:50:43.339015 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m17:50:43.354618 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m17:50:43.359067 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m17:50:43.370334 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m17:50:43.374465 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m17:50:43.376457 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: BEGIN
[0m17:50:43.378343 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:50:43.389500 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m17:50:43.392398 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m17:50:43.394623 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select number_of_trades
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where number_of_trades is null



      
    ) dbt_internal_test
[0m17:50:43.480681 [debug] [Thread-3  ]: SQL status: SELECT 1 in 1.586 seconds
[0m17:50:43.485826 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: ROLLBACK
[0m17:50:43.489660 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: Close
[0m17:50:43.493903 [info ] [Thread-3  ]: 6 of 18 PASS not_null_stg_kaggle__btcusdt_hour_end ............................. [[32mPASS[0m in 1.67s]
[0m17:50:43.497868 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m17:50:43.500271 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m17:50:43.502448 [info ] [Thread-3  ]: 10 of 18 START test not_null_stg_kaggle__btcusdt_open .......................... [RUN]
[0m17:50:43.505311 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m17:50:43.507557 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m17:50:43.526490 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m17:50:43.529390 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m17:50:43.537886 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m17:50:43.547117 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m17:50:43.552829 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: BEGIN
[0m17:50:43.555108 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:50:43.572548 [debug] [Thread-3  ]: SQL status: BEGIN in 0.018 seconds
[0m17:50:43.574888 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m17:50:43.578110 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open is null



      
    ) dbt_internal_test
[0m17:50:43.723330 [debug] [Thread-4  ]: SQL status: SELECT 1 in 1.016 seconds
[0m17:50:43.728317 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: ROLLBACK
[0m17:50:43.731258 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: Close
[0m17:50:43.734033 [info ] [Thread-4  ]: 8 of 18 PASS not_null_stg_kaggle__btcusdt_low .................................. [[32mPASS[0m in 1.08s]
[0m17:50:43.737224 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m17:50:43.739305 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m17:50:43.741534 [info ] [Thread-4  ]: 11 of 18 START test not_null_stg_kaggle__btcusdt_open_date ..................... [RUN]
[0m17:50:43.745251 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m17:50:43.748335 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m17:50:43.763298 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m17:50:43.770450 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m17:50:43.777497 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m17:50:43.781328 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m17:50:43.783342 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: BEGIN
[0m17:50:43.785681 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:50:43.795613 [debug] [Thread-4  ]: SQL status: BEGIN in 0.010 seconds
[0m17:50:43.797682 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m17:50:43.799777 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_date
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_date is null



      
    ) dbt_internal_test
[0m17:50:44.369484 [debug] [Thread-1  ]: SQL status: SELECT 1 in 1.679 seconds
[0m17:50:44.378142 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: ROLLBACK
[0m17:50:44.382658 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: Close
[0m17:50:44.386105 [info ] [Thread-1  ]: 7 of 18 PASS not_null_stg_kaggle__btcusdt_hour_start ........................... [[32mPASS[0m in 1.78s]
[0m17:50:44.388823 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m17:50:44.392264 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m17:50:44.396803 [info ] [Thread-1  ]: 12 of 18 START test not_null_stg_kaggle__btcusdt_open_time ..................... [RUN]
[0m17:50:44.399415 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m17:50:44.401749 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m17:50:44.416689 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m17:50:44.421595 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m17:50:44.431732 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m17:50:44.435842 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m17:50:44.437783 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: BEGIN
[0m17:50:44.439706 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:44.450335 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m17:50:44.452564 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m17:50:44.454591 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is null



      
    ) dbt_internal_test
[0m17:50:44.477439 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.897 seconds
[0m17:50:44.480927 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: ROLLBACK
[0m17:50:44.483332 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: Close
[0m17:50:44.485401 [info ] [Thread-3  ]: 10 of 18 PASS not_null_stg_kaggle__btcusdt_open ................................ [[32mPASS[0m in 0.98s]
[0m17:50:44.489073 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m17:50:44.491299 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m17:50:44.493458 [info ] [Thread-3  ]: 13 of 18 START test not_null_stg_kaggle__btcusdt_quote_asset_volume ............ [RUN]
[0m17:50:44.496297 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m17:50:44.498476 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m17:50:44.515825 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m17:50:44.519864 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m17:50:44.530233 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m17:50:44.537068 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m17:50:44.539037 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: BEGIN
[0m17:50:44.541198 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:50:44.552126 [debug] [Thread-3  ]: SQL status: BEGIN in 0.011 seconds
[0m17:50:44.554263 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m17:50:44.556509 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where quote_asset_volume is null



      
    ) dbt_internal_test
[0m17:50:45.250785 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.794 seconds
[0m17:50:45.257358 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: ROLLBACK
[0m17:50:45.262341 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: Close
[0m17:50:45.265457 [info ] [Thread-1  ]: 12 of 18 PASS not_null_stg_kaggle__btcusdt_open_time ........................... [[32mPASS[0m in 0.87s]
[0m17:50:45.268745 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m17:50:45.271302 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m17:50:45.275539 [info ] [Thread-1  ]: 14 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ... [RUN]
[0m17:50:45.280994 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m17:50:45.286635 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m17:50:45.301341 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m17:50:45.305097 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m17:50:45.313641 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m17:50:45.317427 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m17:50:45.319214 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: BEGIN
[0m17:50:45.320836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:45.331209 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m17:50:45.332561 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m17:50:45.334283 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_base_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_base_asset_volume is null



      
    ) dbt_internal_test
[0m17:50:45.389211 [debug] [Thread-4  ]: SQL status: SELECT 1 in 1.586 seconds
[0m17:50:45.469618 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: ROLLBACK
[0m17:50:45.472679 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: Close
[0m17:50:45.476915 [info ] [Thread-4  ]: 11 of 18 PASS not_null_stg_kaggle__btcusdt_open_date ........................... [[32mPASS[0m in 1.73s]
[0m17:50:45.481935 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m17:50:45.484794 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m17:50:45.492391 [info ] [Thread-4  ]: 15 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume .. [RUN]
[0m17:50:45.496566 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m17:50:45.499848 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m17:50:45.515876 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m17:50:45.520442 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m17:50:45.526430 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m17:50:45.530593 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m17:50:45.532655 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: BEGIN
[0m17:50:45.535019 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:50:45.544393 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m17:50:45.546427 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m17:50:45.548680 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_quote_asset_volume is null



      
    ) dbt_internal_test
[0m17:50:45.559476 [debug] [Thread-2  ]: SQL status: SELECT 1 in 2.163 seconds
[0m17:50:45.564641 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: ROLLBACK
[0m17:50:45.566660 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: Close
[0m17:50:45.569296 [info ] [Thread-2  ]: 9 of 18 PASS not_null_stg_kaggle__btcusdt_number_of_trades ..................... [[32mPASS[0m in 2.23s]
[0m17:50:45.571986 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m17:50:45.574066 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m17:50:45.576211 [info ] [Thread-2  ]: 16 of 18 START test not_null_stg_kaggle__btcusdt_volume ........................ [RUN]
[0m17:50:45.578686 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m17:50:45.580573 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m17:50:45.596907 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m17:50:45.601396 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m17:50:45.611074 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m17:50:45.615715 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m17:50:45.617673 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: BEGIN
[0m17:50:45.619469 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:50:45.629673 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m17:50:45.631669 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m17:50:45.633644 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where volume is null



      
    ) dbt_internal_test
[0m17:50:45.913156 [debug] [Thread-3  ]: SQL status: SELECT 1 in 1.354 seconds
[0m17:50:45.918177 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: ROLLBACK
[0m17:50:45.920798 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: Close
[0m17:50:45.923334 [info ] [Thread-3  ]: 13 of 18 PASS not_null_stg_kaggle__btcusdt_quote_asset_volume .................. [[32mPASS[0m in 1.43s]
[0m17:50:45.926473 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m17:50:45.928525 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m17:50:45.930308 [info ] [Thread-3  ]: 17 of 18 START test unique_stg_kaggle__btcusdt_close_time ...................... [RUN]
[0m17:50:45.932339 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m17:50:45.934324 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m17:50:45.954744 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m17:50:45.959192 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m17:50:45.968239 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m17:50:45.972237 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m17:50:45.973574 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: BEGIN
[0m17:50:45.975197 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:50:45.985481 [debug] [Thread-3  ]: SQL status: BEGIN in 0.010 seconds
[0m17:50:45.987054 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m17:50:45.988441 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    close_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is not null
group by close_time
having count(*) > 1



      
    ) dbt_internal_test
[0m17:50:48.430994 [debug] [Thread-1  ]: SQL status: SELECT 1 in 3.081 seconds
[0m17:50:48.837285 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: ROLLBACK
[0m17:50:48.850532 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: Close
[0m17:50:48.855458 [debug] [Thread-4  ]: SQL status: SELECT 1 in 3.304 seconds
[0m17:50:48.872330 [info ] [Thread-1  ]: 14 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ......... [[32mPASS[0m in 3.59s]
[0m17:50:48.880667 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: ROLLBACK
[0m17:50:48.884778 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m17:50:48.891051 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m17:50:48.893645 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: Close
[0m17:50:48.897745 [info ] [Thread-1  ]: 18 of 18 START test unique_stg_kaggle__btcusdt_open_time ....................... [RUN]
[0m17:50:48.902595 [info ] [Thread-4  ]: 15 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume ........ [[32mPASS[0m in 3.41s]
[0m17:50:48.906272 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m17:50:48.911203 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m17:50:48.915551 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m17:50:48.961536 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m17:50:48.969331 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m17:50:48.982359 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m17:50:48.987664 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m17:50:48.990046 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: BEGIN
[0m17:50:48.992125 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:49.097565 [debug] [Thread-2  ]: SQL status: SELECT 1 in 3.461 seconds
[0m17:50:49.106616 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: ROLLBACK
[0m17:50:49.110014 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: Close
[0m17:50:49.112883 [info ] [Thread-2  ]: 16 of 18 PASS not_null_stg_kaggle__btcusdt_volume .............................. [[32mPASS[0m in 3.53s]
[0m17:50:49.115605 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m17:50:49.216597 [debug] [Thread-1  ]: SQL status: BEGIN in 0.225 seconds
[0m17:50:49.218559 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m17:50:49.220589 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    open_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is not null
group by open_time
having count(*) > 1



      
    ) dbt_internal_test
[0m17:51:00.904332 [debug] [Thread-3  ]: SQL status: SELECT 1 in 14.914 seconds
[0m17:51:00.910195 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: ROLLBACK
[0m17:51:00.911667 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: Close
[0m17:51:00.913449 [info ] [Thread-3  ]: 17 of 18 PASS unique_stg_kaggle__btcusdt_close_time ............................ [[32mPASS[0m in 14.98s]
[0m17:51:00.915110 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m17:51:01.537536 [debug] [Thread-1  ]: SQL status: SELECT 1 in 12.315 seconds
[0m17:51:01.540319 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: ROLLBACK
[0m17:51:01.541722 [debug] [Thread-1  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: Close
[0m17:51:01.543224 [info ] [Thread-1  ]: 18 of 18 PASS unique_stg_kaggle__btcusdt_open_time ............................. [[32mPASS[0m in 12.64s]
[0m17:51:01.544851 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m17:51:01.552102 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:01.553293 [debug] [MainThread]: On master: BEGIN
[0m17:51:01.554266 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:01.561987 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:51:01.563243 [debug] [MainThread]: On master: COMMIT
[0m17:51:01.564347 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:01.565492 [debug] [MainThread]: On master: COMMIT
[0m17:51:01.567163 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:51:01.568275 [debug] [MainThread]: On master: Close
[0m17:51:01.569657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:01.570859 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa' was properly closed.
[0m17:51:01.571998 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae' was properly closed.
[0m17:51:01.573176 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb' was properly closed.
[0m17:51:01.574282 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42' was properly closed.
[0m17:51:01.575640 [info ] [MainThread]: 
[0m17:51:01.577356 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 21.31 seconds (21.31s).
[0m17:51:01.584883 [debug] [MainThread]: Command end result
[0m17:51:01.586412 [info ] [MainThread]: 
[0m17:51:01.587967 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:01.589185 [info ] [MainThread]: 
[0m17:51:01.590537 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m17:51:01.595137 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 22.19676, "process_user_time": 4.631899, "process_kernel_time": 0.336276, "process_mem_max_rss": "114948", "process_in_blocks": "1440", "process_out_blocks": "142"}
[0m17:51:01.597767 [debug] [MainThread]: Command `dbt test` succeeded at 17:51:01.597546 after 22.20 seconds
[0m17:51:01.599786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0a0421100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09d8d7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09ccd4b80>]}
[0m17:51:01.601618 [debug] [MainThread]: Flushing usage events
[0m17:51:06.036037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9396a8a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9394719610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93947195b0>]}


============================== 17:51:06.043567 | fe7adfff-662e-4923-ac4b-ff75327b1115 ==============================
[0m17:51:06.043567 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:51:06.044756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models fct_hourly_trades', 'send_anonymous_usage_stats': 'True'}
[0m17:51:06.281842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe7adfff-662e-4923-ac4b-ff75327b1115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9396659430>]}
[0m17:51:06.355680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe7adfff-662e-4923-ac4b-ff75327b1115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93948d7100>]}
[0m17:51:06.357189 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:51:06.390435 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m17:51:06.677404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:51:06.678256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:51:06.754797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe7adfff-662e-4923-ac4b-ff75327b1115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f939352b130>]}
[0m17:51:06.785236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe7adfff-662e-4923-ac4b-ff75327b1115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93939207c0>]}
[0m17:51:06.786375 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m17:51:06.787357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe7adfff-662e-4923-ac4b-ff75327b1115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93939201f0>]}
[0m17:51:06.790157 [info ] [MainThread]: 
[0m17:51:06.791352 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:51:06.798157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analytics'
[0m17:51:06.916089 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m17:51:06.917673 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m17:51:06.918974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:06.926515 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m17:51:06.927697 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m17:51:06.929119 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:51:06.934139 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m17:51:06.936508 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m17:51:06.937879 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m17:51:06.947139 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:06.948277 [debug] [MainThread]: On master: BEGIN
[0m17:51:06.949247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:06.954889 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:51:06.955963 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:06.957198 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:51:06.967367 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m17:51:06.969410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe7adfff-662e-4923-ac4b-ff75327b1115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93947363d0>]}
[0m17:51:06.970464 [debug] [MainThread]: On master: ROLLBACK
[0m17:51:06.971641 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:06.972543 [debug] [MainThread]: On master: BEGIN
[0m17:51:06.974018 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:51:06.974896 [debug] [MainThread]: On master: COMMIT
[0m17:51:06.975765 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:06.976625 [debug] [MainThread]: On master: COMMIT
[0m17:51:06.977836 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:51:06.978695 [debug] [MainThread]: On master: Close
[0m17:51:06.979929 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:51:06.980913 [info ] [MainThread]: 
[0m17:51:06.991052 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m17:51:06.991953 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m17:51:06.992687 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m17:51:06.993620 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m17:51:06.994441 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23  [RUN]
[0m17:51:06.995589 [info ] [Thread-2  ]: 2 of 7 START test dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour  [RUN]
[0m17:51:06.996772 [info ] [Thread-3  ]: 3 of 7 START test not_null_fct_hourly_trades_close_price ....................... [RUN]
[0m17:51:06.998015 [info ] [Thread-4  ]: 4 of 7 START test not_null_fct_hourly_trades_open_date ......................... [RUN]
[0m17:51:06.999350 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433)
[0m17:51:07.000526 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf'
[0m17:51:07.001704 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523'
[0m17:51:07.002984 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d'
[0m17:51:07.004112 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m17:51:07.005285 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m17:51:07.006754 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m17:51:07.007948 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m17:51:07.047220 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m17:51:07.047904 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m17:51:07.059679 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m17:51:07.065696 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m17:51:07.070859 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m17:51:07.071638 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m17:51:07.072637 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m17:51:07.085221 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m17:51:07.100389 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m17:51:07.102890 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m17:51:07.108006 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m17:51:07.112069 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m17:51:07.116077 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m17:51:07.117072 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m17:51:07.117942 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: BEGIN
[0m17:51:07.119035 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: BEGIN
[0m17:51:07.119755 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m17:51:07.120800 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m17:51:07.121517 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:51:07.122527 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:51:07.123593 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: BEGIN
[0m17:51:07.124653 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: BEGIN
[0m17:51:07.127447 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m17:51:07.129134 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:51:07.131208 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m17:51:07.132158 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m17:51:07.133584 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m17:51:07.134913 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m17:51:07.135863 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m17:51:07.137005 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price
from "company_dw"."analytics"."fct_hourly_trades"
where close_price is null



      
    ) dbt_internal_test
[0m17:51:07.138666 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        open_hour as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."fct_hourly_trades"
    group by open_hour

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23'
)



      
    ) dbt_internal_test
[0m17:51:07.139615 [debug] [Thread-4  ]: SQL status: BEGIN in 0.011 seconds
[0m17:51:07.140539 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m17:51:07.142554 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m17:51:07.143788 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m17:51:07.144587 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m17:51:07.145403 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        open_date, open_hour
    from "company_dw"."analytics"."fct_hourly_trades"
    group by open_date, open_hour
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m17:51:07.146745 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_date
from "company_dw"."analytics"."fct_hourly_trades"
where open_date is null



      
    ) dbt_internal_test
[0m17:51:07.152772 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: ROLLBACK
[0m17:51:07.155222 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: ROLLBACK
[0m17:51:07.157511 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: Close
[0m17:51:07.158414 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m17:51:07.159233 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: Close
[0m17:51:07.160420 [info ] [Thread-3  ]: 3 of 7 PASS not_null_fct_hourly_trades_close_price ............................. [[32mPASS[0m in 0.16s]
[0m17:51:07.161295 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.005 seconds
[0m17:51:07.164142 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: ROLLBACK
[0m17:51:07.165699 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23  [[32mPASS[0m in 0.17s]
[0m17:51:07.167123 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m17:51:07.169691 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: ROLLBACK
[0m17:51:07.171184 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: Close
[0m17:51:07.172202 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m17:51:07.173390 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m17:51:07.174733 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: Close
[0m17:51:07.175812 [info ] [Thread-4  ]: 4 of 7 PASS not_null_fct_hourly_trades_open_date ............................... [[32mPASS[0m in 0.17s]
[0m17:51:07.177068 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m17:51:07.178226 [info ] [Thread-3  ]: 5 of 7 START test not_null_fct_hourly_trades_open_hour ......................... [RUN]
[0m17:51:07.179756 [info ] [Thread-2  ]: 2 of 7 PASS dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour  [[32mPASS[0m in 0.18s]
[0m17:51:07.181158 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m17:51:07.182891 [info ] [Thread-1  ]: 6 of 7 START test not_null_fct_hourly_trades_open_price ........................ [RUN]
[0m17:51:07.184173 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4)
[0m17:51:07.185507 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m17:51:07.186707 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m17:51:07.187949 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd)
[0m17:51:07.189047 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m17:51:07.190631 [info ] [Thread-4  ]: 7 of 7 START test not_null_fct_hourly_trades_percent_gain ...................... [RUN]
[0m17:51:07.191856 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m17:51:07.198159 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m17:51:07.199303 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d, now test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f)
[0m17:51:07.205233 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m17:51:07.206758 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m17:51:07.208347 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m17:51:07.214179 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m17:51:07.218541 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m17:51:07.219530 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m17:51:07.228337 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m17:51:07.229284 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m17:51:07.230882 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m17:51:07.234746 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m17:51:07.236126 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m17:51:07.236913 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: BEGIN
[0m17:51:07.238683 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: BEGIN
[0m17:51:07.239768 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:51:07.240567 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m17:51:07.241477 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:51:07.243189 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: BEGIN
[0m17:51:07.245297 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:51:07.247737 [debug] [Thread-3  ]: SQL status: BEGIN in 0.008 seconds
[0m17:51:07.249133 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m17:51:07.249925 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m17:51:07.251113 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_hour
from "company_dw"."analytics"."fct_hourly_trades"
where open_hour is null



      
    ) dbt_internal_test
[0m17:51:07.252016 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m17:51:07.253026 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m17:51:07.254505 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m17:51:07.255171 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m17:51:07.256278 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_price
from "company_dw"."analytics"."fct_hourly_trades"
where open_price is null



      
    ) dbt_internal_test
[0m17:51:07.257512 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select percent_gain
from "company_dw"."analytics"."fct_hourly_trades"
where percent_gain is null



      
    ) dbt_internal_test
[0m17:51:07.260133 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: ROLLBACK
[0m17:51:07.262704 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m17:51:07.263534 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: Close
[0m17:51:07.264336 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.003 seconds
[0m17:51:07.266712 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: ROLLBACK
[0m17:51:07.268482 [info ] [Thread-3  ]: 5 of 7 PASS not_null_fct_hourly_trades_open_hour ............................... [[32mPASS[0m in 0.08s]
[0m17:51:07.271302 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: ROLLBACK
[0m17:51:07.272869 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: Close
[0m17:51:07.273883 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m17:51:07.275379 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: Close
[0m17:51:07.276724 [info ] [Thread-1  ]: 6 of 7 PASS not_null_fct_hourly_trades_open_price .............................. [[32mPASS[0m in 0.09s]
[0m17:51:07.281014 [info ] [Thread-4  ]: 7 of 7 PASS not_null_fct_hourly_trades_percent_gain ............................ [[32mPASS[0m in 0.08s]
[0m17:51:07.283535 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m17:51:07.285624 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m17:51:07.291879 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:07.293518 [debug] [MainThread]: On master: BEGIN
[0m17:51:07.295188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:07.302622 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:51:07.303900 [debug] [MainThread]: On master: COMMIT
[0m17:51:07.304900 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:07.305756 [debug] [MainThread]: On master: COMMIT
[0m17:51:07.307082 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:51:07.308004 [debug] [MainThread]: On master: Close
[0m17:51:07.309115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:07.309915 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd' was properly closed.
[0m17:51:07.310683 [debug] [MainThread]: Connection 'test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf' was properly closed.
[0m17:51:07.311620 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4' was properly closed.
[0m17:51:07.312422 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f' was properly closed.
[0m17:51:07.313401 [info ] [MainThread]: 
[0m17:51:07.314344 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m17:51:07.317100 [debug] [MainThread]: Command end result
[0m17:51:07.317922 [info ] [MainThread]: 
[0m17:51:07.318938 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:07.319931 [info ] [MainThread]: 
[0m17:51:07.320909 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m17:51:07.322444 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3610703, "process_user_time": 3.465902, "process_kernel_time": 0.237516, "process_mem_max_rss": "112896", "process_out_blocks": "73", "process_in_blocks": "0"}
[0m17:51:07.323641 [debug] [MainThread]: Command `dbt test` succeeded at 17:51:07.323517 after 1.36 seconds
[0m17:51:07.324675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9396a8a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93940b0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9393117e20>]}
[0m17:51:07.325660 [debug] [MainThread]: Flushing usage events
[0m17:51:12.448540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b47f19fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b45b997f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b45b99790>]}


============================== 17:51:12.457543 | a06cb4eb-632e-4861-ad6a-289112e07126 ==============================
[0m17:51:12.457543 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:51:12.458798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:51:12.710160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a06cb4eb-632e-4861-ad6a-289112e07126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b45bbefd0>]}
[0m17:51:12.785356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a06cb4eb-632e-4861-ad6a-289112e07126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b484df130>]}
[0m17:51:12.786860 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:51:12.823546 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:51:13.004225 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:51:13.005486 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25
[0m17:51:13.006471 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:51:13.007632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a06cb4eb-632e-4861-ad6a-289112e07126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b46f66220>]}
[0m17:51:15.306685 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:51:15.307882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a06cb4eb-632e-4861-ad6a-289112e07126', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b45165730>]}
[0m17:51:15.869174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a06cb4eb-632e-4861-ad6a-289112e07126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b45587d60>]}
[0m17:51:15.896113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a06cb4eb-632e-4861-ad6a-289112e07126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b444d0d90>]}
[0m17:51:15.897645 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m17:51:15.899188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a06cb4eb-632e-4861-ad6a-289112e07126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b45da1d00>]}
[0m17:51:15.903695 [info ] [MainThread]: 
[0m17:51:15.905375 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:51:15.914085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m17:51:15.976667 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m17:51:15.978152 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m17:51:15.979410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:15.987817 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m17:51:15.989472 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m17:51:15.990819 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m17:51:15.995962 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m17:51:15.998821 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m17:51:16.000627 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m17:51:16.011395 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:16.012766 [debug] [MainThread]: On master: BEGIN
[0m17:51:16.013937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:16.020834 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:51:16.022774 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:16.024407 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:51:16.037120 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m17:51:16.039911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a06cb4eb-632e-4861-ad6a-289112e07126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b47aa8eb0>]}
[0m17:51:16.041426 [debug] [MainThread]: On master: ROLLBACK
[0m17:51:16.043386 [debug] [MainThread]: On master: Close
[0m17:51:16.046914 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:51:16.048420 [info ] [MainThread]: 
[0m17:51:16.098016 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m17:51:16.105973 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m17:51:16.114359 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m17:51:16.185491 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m17:51:16.188918 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m17:51:16.190633 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m17:51:16.193247 [debug] [Thread-3  ]: Began running node model.dbt_btc_transform.fct_hourly_trades
[0m17:51:16.194122 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m17:51:16.194883 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m17:51:16.195672 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m17:51:16.196590 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_btc_transform.fct_hourly_trades'
[0m17:51:16.197956 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872'
[0m17:51:16.199383 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m17:51:16.201039 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_btc_transform.stg_kaggle__btcusdt, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb)
[0m17:51:16.202545 [debug] [Thread-3  ]: Began compiling node model.dbt_btc_transform.fct_hourly_trades
[0m17:51:16.203730 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m17:51:16.204873 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m17:51:16.206016 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m17:51:16.211810 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_btc_transform.fct_hourly_trades"
[0m17:51:16.218707 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m17:51:16.225232 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m17:51:16.239739 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m17:51:16.243469 [debug] [Thread-3  ]: Began executing node model.dbt_btc_transform.fct_hourly_trades
[0m17:51:16.244560 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m17:51:16.246053 [debug] [Thread-3  ]: Finished running node model.dbt_btc_transform.fct_hourly_trades
[0m17:51:16.247065 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m17:51:16.248632 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m17:51:16.249327 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m17:51:16.250484 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m17:51:16.252569 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m17:51:16.253840 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m17:51:16.256108 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m17:51:16.257689 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_btc_transform.fct_hourly_trades, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a)
[0m17:51:16.259035 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m17:51:16.260504 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m17:51:16.261863 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m17:51:16.263364 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m17:51:16.265415 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m17:51:16.266768 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m17:51:16.268165 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m17:51:16.275953 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m17:51:16.277031 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m17:51:16.283251 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m17:51:16.284386 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m17:51:16.291148 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m17:51:16.292676 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m17:51:16.299886 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m17:51:16.301054 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m17:51:16.302978 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m17:51:16.304328 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m17:51:16.305805 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m17:51:16.307000 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m17:51:16.307800 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m17:51:16.309256 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m17:51:16.310511 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m17:51:16.311686 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m17:51:16.313395 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m17:51:16.314692 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m17:51:16.316063 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m17:51:16.317127 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m17:51:16.318255 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m17:51:16.319478 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m17:51:16.320526 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m17:51:16.329245 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m17:51:16.330482 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m17:51:16.331620 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m17:51:16.338123 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m17:51:16.340038 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m17:51:16.346626 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m17:51:16.346286 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m17:51:16.354100 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m17:51:16.355802 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m17:51:16.356808 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m17:51:16.358712 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m17:51:16.359863 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m17:51:16.361032 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m17:51:16.361979 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m17:51:16.362825 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m17:51:16.364233 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m17:51:16.365491 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m17:51:16.366875 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m17:51:16.368017 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m17:51:16.369230 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m17:51:16.370708 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m17:51:16.372090 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m17:51:16.378758 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m17:51:16.379878 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m17:51:16.380935 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m17:51:16.382085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m17:51:16.383688 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m17:51:16.390643 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m17:51:16.391743 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m17:51:16.392517 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m17:51:16.400790 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m17:51:16.408206 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m17:51:16.411096 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m17:51:16.411993 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m17:51:16.414725 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m17:51:16.415979 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m17:51:16.417658 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m17:51:16.418486 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m17:51:16.419571 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m17:51:16.421096 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m17:51:16.422493 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m17:51:16.424214 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m17:51:16.425698 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m17:51:16.426858 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m17:51:16.428041 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m17:51:16.429449 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m17:51:16.436459 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m17:51:16.437612 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m17:51:16.438770 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m17:51:16.439986 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42, now test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433)
[0m17:51:16.441820 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m17:51:16.452771 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m17:51:16.453943 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m17:51:16.454893 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m17:51:16.462819 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m17:51:16.465152 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m17:51:16.472787 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m17:51:16.474240 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m17:51:16.476224 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m17:51:16.478090 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m17:51:16.478994 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m17:51:16.480803 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae, now test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf)
[0m17:51:16.482115 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m17:51:16.483010 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m17:51:16.484776 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m17:51:16.485944 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m17:51:16.487234 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb, now test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523)
[0m17:51:16.489237 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m17:51:16.490989 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m17:51:16.501528 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m17:51:16.510018 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m17:51:16.511831 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m17:51:16.513752 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d)
[0m17:51:16.524350 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m17:51:16.526426 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4)
[0m17:51:16.527605 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m17:51:16.528911 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m17:51:16.530921 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m17:51:16.533142 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m17:51:16.534637 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m17:51:16.542630 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m17:51:16.551547 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m17:51:16.553568 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m17:51:16.556044 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m17:51:16.559322 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd)
[0m17:51:16.560402 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m17:51:16.561726 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m17:51:16.562813 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m17:51:16.563972 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m17:51:16.565848 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m17:51:16.567168 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523, now test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f)
[0m17:51:16.569070 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m17:51:16.576873 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m17:51:16.578990 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m17:51:16.587936 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m17:51:16.589184 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m17:51:16.591231 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m17:51:16.592838 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m17:51:16.594643 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m17:51:16.598471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:16.600157 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4' was properly closed.
[0m17:51:16.602214 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd' was properly closed.
[0m17:51:16.604191 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f' was properly closed.
[0m17:51:16.606158 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d' was properly closed.
[0m17:51:16.615506 [debug] [MainThread]: Command end result
[0m17:51:16.844199 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:51:16.845191 [info ] [MainThread]: Building catalog
[0m17:51:16.862828 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m17:51:16.874651 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m17:51:16.875627 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m17:51:16.876543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:16.881677 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m17:51:16.882637 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m17:51:16.883731 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('btcusdt')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_kaggle__btcusdt')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('fct_hourly_trades')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:51:16.898622 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.013 seconds
[0m17:51:16.909962 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m17:51:16.911677 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m17:51:17.087731 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m17:51:17.089749 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.7348943, "process_user_time": 6.408346, "process_kernel_time": 0.253958, "process_mem_max_rss": "117256", "process_in_blocks": "3200", "process_out_blocks": "6713"}
[0m17:51:17.091388 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:51:17.091140 after 4.74 seconds
[0m17:51:17.092469 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:51:17.093336 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m17:51:17.097380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b47f19fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b449ded60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b451a0a60>]}
[0m17:51:17.099850 [debug] [MainThread]: Flushing usage events
[0m20:20:12.244860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf81a2d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf5a2c5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf5a2c580>]}


============================== 20:20:12.254977 | 56167561-c721-4ae0-956b-4b0f0dde9d70 ==============================
[0m20:20:12.254977 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:20:12.256523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models stg_kaggle__btcusdt', 'send_anonymous_usage_stats': 'True'}
[0m20:20:12.783780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56167561-c721-4ae0-956b-4b0f0dde9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf5ab3c40>]}
[0m20:20:12.857349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56167561-c721-4ae0-956b-4b0f0dde9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf66d77c0>]}
[0m20:20:12.859305 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:20:12.896825 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m20:20:13.076073 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m20:20:13.077658 [debug] [MainThread]: previous checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m20:20:13.078756 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:20:13.080014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56167561-c721-4ae0-956b-4b0f0dde9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf6ea04f0>]}
[0m20:20:15.295409 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:20:15.296841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '56167561-c721-4ae0-956b-4b0f0dde9d70', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf4739340>]}
[0m20:20:15.752831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56167561-c721-4ae0-956b-4b0f0dde9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf4b58640>]}
[0m20:20:15.785951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56167561-c721-4ae0-956b-4b0f0dde9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf46d3d90>]}
[0m20:20:15.787186 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m20:20:15.788243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56167561-c721-4ae0-956b-4b0f0dde9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf4f91e80>]}
[0m20:20:15.790775 [info ] [MainThread]: 
[0m20:20:15.792082 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:20:15.793888 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:20:15.876494 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:20:15.877508 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:20:15.878340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:15.888519 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m20:20:15.891150 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:20:15.898190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m20:20:15.907774 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m20:20:15.908696 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m20:20:15.909486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:15.916117 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:20:15.917080 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m20:20:15.918013 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:20:15.933413 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.014 seconds
[0m20:20:15.935610 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m20:20:15.936783 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m20:20:15.944980 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:15.946188 [debug] [MainThread]: On master: BEGIN
[0m20:20:15.947113 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:15.953947 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:20:15.954999 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:15.956342 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:20:15.977801 [debug] [MainThread]: SQL status: SELECT 0 in 0.020 seconds
[0m20:20:15.980037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56167561-c721-4ae0-956b-4b0f0dde9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf4b1ca60>]}
[0m20:20:15.981131 [debug] [MainThread]: On master: ROLLBACK
[0m20:20:15.982324 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:15.983332 [debug] [MainThread]: On master: BEGIN
[0m20:20:15.984609 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:20:15.985428 [debug] [MainThread]: On master: COMMIT
[0m20:20:15.986208 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:15.987086 [debug] [MainThread]: On master: COMMIT
[0m20:20:15.988182 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:20:15.989210 [debug] [MainThread]: On master: Close
[0m20:20:15.990658 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:20:15.991719 [info ] [MainThread]: 
[0m20:20:16.001951 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m20:20:16.003408 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.stg_kaggle__btcusdt ..................... [RUN]
[0m20:20:16.004571 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m20:20:16.005523 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m20:20:16.018827 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m20:20:16.024561 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m20:20:16.084367 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m20:20:16.089495 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m20:20:16.090593 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: BEGIN
[0m20:20:16.091480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:20:16.096700 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m20:20:16.097771 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m20:20:16.098970 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */

  
    

  create  table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."raw"."btcusdt" where ignore = 0

),


final as (

    -- I hate just putting a distinct to deal with duplicates but doing this because there are dupes in the source data.
    -- I would rather investigate why this is happening at the source and fix there but need to work
    -- with what was given
    select distinct 
        open_time,
        close_time,
        open,
        high,
        low,
        close,
        volume,
        quote_asset_volume,
        number_of_trades,
        taker_buy_base_asset_volume,
        taker_buy_quote_asset_volume,
        open_time::date as open_date,
        -- for this analysis we are only interested in the close and end of every given hour
        -- this flag helps for filtering in the following int_ model
        case
            when extract(minutes from open_time) = 0
            and extract(second from open_time) = 0
                then true
            else false
        end as hour_start,

        case    
            when extract(minutes from close_time) = 59 
            and extract(second from close_time) = 59.999
                then true
            else false
        end as hour_end
            

    from source

)

select * from final
  );
  
[0m20:26:13.183839 [debug] [Thread-1  ]: SQL status: SELECT 110671480 in 357.062 seconds
[0m20:26:13.258481 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m20:26:13.259845 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt" rename to "stg_kaggle__btcusdt__dbt_backup"
[0m20:26:13.266395 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.005 seconds
[0m20:26:13.272526 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m20:26:13.273588 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
alter table "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_tmp" rename to "stg_kaggle__btcusdt"
[0m20:26:13.276111 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:26:13.308020 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m20:26:13.309129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m20:26:13.310101 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: COMMIT
[0m20:26:13.312251 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m20:26:13.321795 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup"
[0m20:26:13.328024 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m20:26:13.329030 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.stg_kaggle__btcusdt"} */
drop table if exists "company_dw"."analytics"."stg_kaggle__btcusdt__dbt_backup" cascade
[0m20:26:13.349789 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.020 seconds
[0m20:26:13.357805 [debug] [Thread-1  ]: On model.dbt_btc_transform.stg_kaggle__btcusdt: Close
[0m20:26:13.362682 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56167561-c721-4ae0-956b-4b0f0dde9d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf3b9eaf0>]}
[0m20:26:13.365358 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.stg_kaggle__btcusdt ................ [[32mSELECT 110671480[0m in 357.36s]
[0m20:26:13.370687 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m20:26:13.376443 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:13.377566 [debug] [MainThread]: On master: BEGIN
[0m20:26:13.378517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:26:13.387955 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:26:13.389063 [debug] [MainThread]: On master: COMMIT
[0m20:26:13.389973 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:13.390944 [debug] [MainThread]: On master: COMMIT
[0m20:26:13.392207 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:26:13.393093 [debug] [MainThread]: On master: Close
[0m20:26:13.394382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:13.395215 [debug] [MainThread]: Connection 'model.dbt_btc_transform.stg_kaggle__btcusdt' was properly closed.
[0m20:26:13.397002 [info ] [MainThread]: 
[0m20:26:13.398317 [info ] [MainThread]: Finished running 1 table model in 0 hours 5 minutes and 57.60 seconds (357.60s).
[0m20:26:13.399996 [debug] [MainThread]: Command end result
[0m20:26:13.400885 [info ] [MainThread]: 
[0m20:26:13.402069 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:26:13.403184 [info ] [MainThread]: 
[0m20:26:13.404230 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:26:13.409185 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 361.24515, "process_user_time": 5.847148, "process_kernel_time": 0.864033, "process_mem_max_rss": "114464", "process_in_blocks": "46184", "process_out_blocks": "2300"}
[0m20:26:13.411072 [debug] [MainThread]: Command `dbt run` succeeded at 20:26:13.410868 after 361.25 seconds
[0m20:26:13.412468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf81a2d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf4b58640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf66d77c0>]}
[0m20:26:13.413606 [debug] [MainThread]: Flushing usage events
[0m20:26:18.349519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c07a650a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c056eb640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c056eb5e0>]}


============================== 20:26:18.357126 | b2e6360d-c71c-42cd-9c3f-0e99dbd1ef09 ==============================
[0m20:26:18.357126 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:26:18.358499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models fct_hourly_trades', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:26:18.602963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2e6360d-c71c-42cd-9c3f-0e99dbd1ef09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0575a160>]}
[0m20:26:18.680457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2e6360d-c71c-42cd-9c3f-0e99dbd1ef09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0571aa60>]}
[0m20:26:18.681868 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:26:18.715759 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m20:26:19.001794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:26:19.002895 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:26:19.079640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2e6360d-c71c-42cd-9c3f-0e99dbd1ef09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0452b130>]}
[0m20:26:19.104856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2e6360d-c71c-42cd-9c3f-0e99dbd1ef09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c044d5ca0>]}
[0m20:26:19.106016 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m20:26:19.107227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2e6360d-c71c-42cd-9c3f-0e99dbd1ef09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c04927460>]}
[0m20:26:19.109883 [info ] [MainThread]: 
[0m20:26:19.111174 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:26:19.112931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw'
[0m20:26:19.231854 [debug] [ThreadPool]: Using postgres connection "list_company_dw"
[0m20:26:19.233058 [debug] [ThreadPool]: On list_company_dw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:26:19.234276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:19.241639 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m20:26:19.244145 [debug] [ThreadPool]: On list_company_dw: Close
[0m20:26:19.251797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_company_dw, now list_company_dw_analytics)
[0m20:26:19.261583 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m20:26:19.262503 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m20:26:19.263403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:19.268503 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m20:26:19.269457 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m20:26:19.270389 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:26:19.274325 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m20:26:19.276363 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m20:26:19.277463 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m20:26:19.285297 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:19.286237 [debug] [MainThread]: On master: BEGIN
[0m20:26:19.287023 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:26:19.292052 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m20:26:19.293086 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:19.294221 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:26:19.304235 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m20:26:19.306121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2e6360d-c71c-42cd-9c3f-0e99dbd1ef09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c04519910>]}
[0m20:26:19.307129 [debug] [MainThread]: On master: ROLLBACK
[0m20:26:19.308287 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:19.309100 [debug] [MainThread]: On master: BEGIN
[0m20:26:19.310426 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:26:19.311217 [debug] [MainThread]: On master: COMMIT
[0m20:26:19.312007 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:19.312834 [debug] [MainThread]: On master: COMMIT
[0m20:26:19.313822 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:26:19.315168 [debug] [MainThread]: On master: Close
[0m20:26:19.316949 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:26:19.318334 [info ] [MainThread]: 
[0m20:26:19.330586 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.fct_hourly_trades
[0m20:26:19.332108 [info ] [Thread-1  ]: 1 of 1 START sql table model analytics.fct_hourly_trades ....................... [RUN]
[0m20:26:19.333446 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now model.dbt_btc_transform.fct_hourly_trades)
[0m20:26:19.334508 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.fct_hourly_trades
[0m20:26:19.348162 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.fct_hourly_trades"
[0m20:26:19.352679 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.fct_hourly_trades
[0m20:26:19.410541 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_btc_transform.fct_hourly_trades"
[0m20:26:19.414969 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m20:26:19.416082 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: BEGIN
[0m20:26:19.417066 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:26:19.423879 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m20:26:19.425091 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m20:26:19.426357 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.fct_hourly_trades"} */

  
    

  create  table "company_dw"."analytics"."fct_hourly_trades__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select * from "company_dw"."analytics"."stg_kaggle__btcusdt"

),


hourly as (

    select
        open_date,
        extract(hours from open_time) as open_hour,

        max(
            case
                when hour_start is true
                    then open
            end 
        ) as open_price,

        max(
            case
                when hour_end is true
                    then close
            end
        ) as close_price

    from source

    where
        hour_start is true or hour_end is true
    
    group by 1, 2

),


final as (

    select
        open_date,
        open_hour,
        open_price,
        close_price,       
        (close_price - open_price) * 1.00000000000000 / open_price as percent_gain

    from hourly

    where 
        open_price is not null
        and close_price is not null

)

select * from final
  );
  
[0m20:27:02.103165 [debug] [Thread-1  ]: SQL status: SELECT 30736 in 42.674 seconds
[0m20:27:02.119650 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m20:27:02.120741 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.fct_hourly_trades"} */
alter table "company_dw"."analytics"."fct_hourly_trades" rename to "fct_hourly_trades__dbt_backup"
[0m20:27:02.122380 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:02.127628 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m20:27:02.128646 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.fct_hourly_trades"} */
alter table "company_dw"."analytics"."fct_hourly_trades__dbt_tmp" rename to "fct_hourly_trades"
[0m20:27:02.131057 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:02.160215 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: COMMIT
[0m20:27:02.161310 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m20:27:02.162274 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: COMMIT
[0m20:27:02.173283 [debug] [Thread-1  ]: SQL status: COMMIT in 0.010 seconds
[0m20:27:02.185653 [debug] [Thread-1  ]: Applying DROP to: "company_dw"."analytics"."fct_hourly_trades__dbt_backup"
[0m20:27:02.193107 [debug] [Thread-1  ]: Using postgres connection "model.dbt_btc_transform.fct_hourly_trades"
[0m20:27:02.194309 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "model.dbt_btc_transform.fct_hourly_trades"} */
drop table if exists "company_dw"."analytics"."fct_hourly_trades__dbt_backup" cascade
[0m20:27:02.203675 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.008 seconds
[0m20:27:02.210625 [debug] [Thread-1  ]: On model.dbt_btc_transform.fct_hourly_trades: Close
[0m20:27:02.215938 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2e6360d-c71c-42cd-9c3f-0e99dbd1ef09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c03de1fa0>]}
[0m20:27:02.220309 [info ] [Thread-1  ]: 1 of 1 OK created sql table model analytics.fct_hourly_trades .................. [[32mSELECT 30736[0m in 42.88s]
[0m20:27:02.224273 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.fct_hourly_trades
[0m20:27:02.229591 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:02.230689 [debug] [MainThread]: On master: BEGIN
[0m20:27:02.231633 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:27:02.237380 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m20:27:02.238450 [debug] [MainThread]: On master: COMMIT
[0m20:27:02.239300 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:02.240180 [debug] [MainThread]: On master: COMMIT
[0m20:27:02.241428 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:27:02.242282 [debug] [MainThread]: On master: Close
[0m20:27:02.243413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:02.244377 [debug] [MainThread]: Connection 'model.dbt_btc_transform.fct_hourly_trades' was properly closed.
[0m20:27:02.245390 [info ] [MainThread]: 
[0m20:27:02.246488 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 43.13 seconds (43.13s).
[0m20:27:02.248059 [debug] [MainThread]: Command end result
[0m20:27:02.248943 [info ] [MainThread]: 
[0m20:27:02.250214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:27:02.251177 [info ] [MainThread]: 
[0m20:27:02.252227 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:27:02.254411 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 43.98111, "process_user_time": 3.082737, "process_kernel_time": 0.245356, "process_mem_max_rss": "108064", "process_out_blocks": "40", "process_in_blocks": "0"}
[0m20:27:02.255796 [debug] [MainThread]: Command `dbt run` succeeded at 20:27:02.255640 after 43.98 seconds
[0m20:27:02.256885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c07a650a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c058ad130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c049277f0>]}
[0m20:27:02.257891 [debug] [MainThread]: Flushing usage events
[0m20:27:06.442105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9f1c8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9ce2b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9ce2b640>]}


============================== 20:27:06.449866 | 39275a62-f15f-493c-8406-e7ccaa1711ab ==============================
[0m20:27:06.449866 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:27:06.451162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models stg_kaggle__btcusdt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:27:06.684456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39275a62-f15f-493c-8406-e7ccaa1711ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9ce503d0>]}
[0m20:27:06.757790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39275a62-f15f-493c-8406-e7ccaa1711ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9f750df0>]}
[0m20:27:06.759203 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:27:06.792252 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m20:27:07.072068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:27:07.072985 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:27:07.147434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39275a62-f15f-493c-8406-e7ccaa1711ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9beab130>]}
[0m20:27:07.183275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39275a62-f15f-493c-8406-e7ccaa1711ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9c3a67f0>]}
[0m20:27:07.184425 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m20:27:07.185345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39275a62-f15f-493c-8406-e7ccaa1711ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9c3a6220>]}
[0m20:27:07.188703 [info ] [MainThread]: 
[0m20:27:07.190056 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:27:07.197244 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analytics'
[0m20:27:07.313125 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m20:27:07.314184 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m20:27:07.315043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:07.321487 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m20:27:07.322448 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m20:27:07.323342 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:27:07.326847 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m20:27:07.328879 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m20:27:07.329998 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m20:27:07.338128 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:07.339170 [debug] [MainThread]: On master: BEGIN
[0m20:27:07.339956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:07.345487 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m20:27:07.346453 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:07.347636 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:27:07.356643 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m20:27:07.358502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39275a62-f15f-493c-8406-e7ccaa1711ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9ce483d0>]}
[0m20:27:07.359458 [debug] [MainThread]: On master: ROLLBACK
[0m20:27:07.360566 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:07.361552 [debug] [MainThread]: On master: BEGIN
[0m20:27:07.362884 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:27:07.363714 [debug] [MainThread]: On master: COMMIT
[0m20:27:07.364479 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:07.365390 [debug] [MainThread]: On master: COMMIT
[0m20:27:07.366475 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:27:07.367280 [debug] [MainThread]: On master: Close
[0m20:27:07.368552 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:27:07.369595 [info ] [MainThread]: 
[0m20:27:07.379309 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m20:27:07.381774 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m20:27:07.380869 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m20:27:07.380137 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m20:27:07.382495 [info ] [Thread-1  ]: 1 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_end__True__False ... [RUN]
[0m20:27:07.383588 [info ] [Thread-4  ]: 4 of 18 START test not_null_stg_kaggle__btcusdt_close_time ..................... [RUN]
[0m20:27:07.384719 [info ] [Thread-3  ]: 3 of 18 START test not_null_stg_kaggle__btcusdt_close .......................... [RUN]
[0m20:27:07.385864 [info ] [Thread-2  ]: 2 of 18 START test accepted_values_stg_kaggle__btcusdt_hour_start__True__False . [RUN]
[0m20:27:07.387040 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872)
[0m20:27:07.388310 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a'
[0m20:27:07.389464 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb'
[0m20:27:07.390588 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m20:27:07.391595 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m20:27:07.392565 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m20:27:07.393858 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m20:27:07.394908 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m20:27:07.424338 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m20:27:07.430214 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m20:27:07.436153 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m20:27:07.442295 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m20:27:07.450345 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m20:27:07.451523 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m20:27:07.477685 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m20:27:07.478565 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m20:27:07.483852 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m20:27:07.493613 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m20:27:07.501489 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m20:27:07.505564 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m20:27:07.510772 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m20:27:07.511847 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: BEGIN
[0m20:27:07.513248 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m20:27:07.513906 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:27:07.514645 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m20:27:07.515747 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m20:27:07.516420 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: BEGIN
[0m20:27:07.518312 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: BEGIN
[0m20:27:07.519469 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: BEGIN
[0m20:27:07.520807 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:27:07.521990 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:27:07.522814 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m20:27:07.523897 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:27:07.526288 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m20:27:07.528179 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close is null



      
    ) dbt_internal_test
[0m20:27:07.529792 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:27:07.530636 [debug] [Thread-4  ]: SQL status: BEGIN in 0.010 seconds
[0m20:27:07.531841 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m20:27:07.533045 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m20:27:07.533810 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m20:27:07.535018 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_end as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_end

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m20:27:07.536262 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m20:27:07.537367 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is null



      
    ) dbt_internal_test
[0m20:27:07.538856 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        hour_start as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."stg_kaggle__btcusdt"
    group by hour_start

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m20:27:44.148068 [debug] [Thread-3  ]: SQL status: SELECT 1 in 36.619 seconds
[0m20:27:44.149018 [debug] [Thread-4  ]: SQL status: SELECT 1 in 36.609 seconds
[0m20:27:44.157630 [debug] [Thread-1  ]: SQL status: SELECT 1 in 36.619 seconds
[0m20:27:44.158674 [debug] [Thread-2  ]: SQL status: SELECT 1 in 36.619 seconds
[0m20:27:44.159429 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: ROLLBACK
[0m20:27:44.162413 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: ROLLBACK
[0m20:27:44.165392 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: ROLLBACK
[0m20:27:44.168528 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: ROLLBACK
[0m20:27:44.170584 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb: Close
[0m20:27:44.171930 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a: Close
[0m20:27:44.173222 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872: Close
[0m20:27:44.174509 [debug] [Thread-2  ]: On test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18: Close
[0m20:27:44.175999 [info ] [Thread-3  ]: 3 of 18 PASS not_null_stg_kaggle__btcusdt_close ................................ [[32mPASS[0m in 36.79s]
[0m20:27:44.177706 [info ] [Thread-4  ]: 4 of 18 PASS not_null_stg_kaggle__btcusdt_close_time ........................... [[32mPASS[0m in 36.79s]
[0m20:27:44.179699 [info ] [Thread-1  ]: 1 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_end__True__False ......... [[32mPASS[0m in 36.79s]
[0m20:27:44.183683 [info ] [Thread-2  ]: 2 of 18 PASS accepted_values_stg_kaggle__btcusdt_hour_start__True__False ....... [[32mPASS[0m in 36.79s]
[0m20:27:44.185372 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m20:27:44.187217 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m20:27:44.188727 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m20:27:44.190345 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m20:27:44.191662 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m20:27:44.193164 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m20:27:44.194531 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m20:27:44.196076 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m20:27:44.197438 [info ] [Thread-3  ]: 5 of 18 START test not_null_stg_kaggle__btcusdt_high ........................... [RUN]
[0m20:27:44.198975 [info ] [Thread-4  ]: 6 of 18 START test not_null_stg_kaggle__btcusdt_hour_end ....................... [RUN]
[0m20:27:44.200400 [info ] [Thread-1  ]: 7 of 18 START test not_null_stg_kaggle__btcusdt_hour_start ..................... [RUN]
[0m20:27:44.201903 [info ] [Thread-2  ]: 8 of 18 START test not_null_stg_kaggle__btcusdt_low ............................ [RUN]
[0m20:27:44.203322 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m20:27:44.204823 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m20:27:44.206114 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m20:27:44.207381 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m20:27:44.208576 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m20:27:44.209901 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m20:27:44.210989 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m20:27:44.212184 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m20:27:44.219900 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m20:27:44.227191 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m20:27:44.234439 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m20:27:44.243470 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m20:27:44.250052 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m20:27:44.251190 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m20:27:44.251967 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m20:27:44.256573 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m20:27:44.257931 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m20:27:44.262404 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m20:27:44.267524 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m20:27:44.274176 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m20:27:44.276166 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m20:27:44.278359 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m20:27:44.279352 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: BEGIN
[0m20:27:44.280921 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: BEGIN
[0m20:27:44.281832 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m20:27:44.282785 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m20:27:44.283860 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m20:27:44.285008 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:27:44.286052 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: BEGIN
[0m20:27:44.287119 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: BEGIN
[0m20:27:44.289366 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:27:44.290842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:27:44.293692 [debug] [Thread-3  ]: SQL status: BEGIN in 0.010 seconds
[0m20:27:44.295398 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m20:27:44.296343 [debug] [Thread-4  ]: SQL status: BEGIN in 0.011 seconds
[0m20:27:44.297890 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where high is null



      
    ) dbt_internal_test
[0m20:27:44.298921 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:27:44.299786 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m20:27:44.300778 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m20:27:44.302503 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m20:27:44.303761 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m20:27:44.304994 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_end
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_end is null



      
    ) dbt_internal_test
[0m20:27:44.306334 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour_start
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where hour_start is null



      
    ) dbt_internal_test
[0m20:27:44.307698 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where low is null



      
    ) dbt_internal_test
[0m20:28:20.936541 [debug] [Thread-3  ]: SQL status: SELECT 1 in 36.632 seconds
[0m20:28:20.938263 [debug] [Thread-2  ]: SQL status: SELECT 1 in 36.625 seconds
[0m20:28:20.940113 [debug] [Thread-1  ]: SQL status: SELECT 1 in 36.628 seconds
[0m20:28:20.944753 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: ROLLBACK
[0m20:28:20.946129 [debug] [Thread-4  ]: SQL status: SELECT 1 in 36.634 seconds
[0m20:28:20.949331 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: ROLLBACK
[0m20:28:20.953129 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: ROLLBACK
[0m20:28:20.955421 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58: Close
[0m20:28:20.958037 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: ROLLBACK
[0m20:28:20.959789 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a: Close
[0m20:28:20.960929 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95: Close
[0m20:28:20.962268 [info ] [Thread-3  ]: 5 of 18 PASS not_null_stg_kaggle__btcusdt_high ................................. [[32mPASS[0m in 36.76s]
[0m20:28:20.963990 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf: Close
[0m20:28:20.965245 [info ] [Thread-2  ]: 8 of 18 PASS not_null_stg_kaggle__btcusdt_low .................................. [[32mPASS[0m in 36.76s]
[0m20:28:20.967278 [info ] [Thread-1  ]: 7 of 18 PASS not_null_stg_kaggle__btcusdt_hour_start ........................... [[32mPASS[0m in 36.76s]
[0m20:28:20.969154 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m20:28:20.971331 [info ] [Thread-4  ]: 6 of 18 PASS not_null_stg_kaggle__btcusdt_hour_end ............................. [[32mPASS[0m in 36.77s]
[0m20:28:20.973113 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m20:28:20.975161 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m20:28:20.977020 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m20:28:20.978661 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m20:28:20.980211 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m20:28:20.981701 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m20:28:20.983151 [info ] [Thread-3  ]: 9 of 18 START test not_null_stg_kaggle__btcusdt_number_of_trades ............... [RUN]
[0m20:28:20.984780 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m20:28:20.986054 [info ] [Thread-2  ]: 10 of 18 START test not_null_stg_kaggle__btcusdt_open .......................... [RUN]
[0m20:28:20.987466 [info ] [Thread-1  ]: 11 of 18 START test not_null_stg_kaggle__btcusdt_open_date ..................... [RUN]
[0m20:28:20.988994 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m20:28:20.990082 [info ] [Thread-4  ]: 12 of 18 START test not_null_stg_kaggle__btcusdt_open_time ..................... [RUN]
[0m20:28:20.991555 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m20:28:20.992933 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m20:28:20.994155 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m20:28:20.995217 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m20:28:20.996466 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m20:28:20.997808 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m20:28:21.005191 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m20:28:21.006170 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m20:28:21.015332 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m20:28:21.023857 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m20:28:21.031762 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m20:28:21.036754 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m20:28:21.038890 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m20:28:21.044285 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m20:28:21.049768 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m20:28:21.050725 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m20:28:21.051787 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m20:28:21.057868 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m20:28:21.064124 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m20:28:21.066098 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m20:28:21.067025 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m20:28:21.068594 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m20:28:21.069871 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: BEGIN
[0m20:28:21.071169 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: BEGIN
[0m20:28:21.072415 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m20:28:21.073371 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: BEGIN
[0m20:28:21.074645 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:28:21.075823 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m20:28:21.076954 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: BEGIN
[0m20:28:21.077927 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:28:21.081068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:28:21.085182 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m20:28:21.086834 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m20:28:21.087768 [debug] [Thread-3  ]: SQL status: BEGIN in 0.012 seconds
[0m20:28:21.089222 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open is null



      
    ) dbt_internal_test
[0m20:28:21.090288 [debug] [Thread-4  ]: SQL status: BEGIN in 0.012 seconds
[0m20:28:21.091147 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m20:28:21.092181 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m20:28:21.093984 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m20:28:21.095227 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m20:28:21.096501 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select number_of_trades
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where number_of_trades is null



      
    ) dbt_internal_test
[0m20:28:21.097908 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_time
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is null



      
    ) dbt_internal_test
[0m20:28:21.099282 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_date
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_date is null



      
    ) dbt_internal_test
[0m20:28:57.621159 [debug] [Thread-3  ]: SQL status: SELECT 1 in 36.519 seconds
[0m20:28:57.622638 [debug] [Thread-4  ]: SQL status: SELECT 1 in 36.520 seconds
[0m20:28:57.624402 [debug] [Thread-2  ]: SQL status: SELECT 1 in 36.530 seconds
[0m20:28:57.629345 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: ROLLBACK
[0m20:28:57.630643 [debug] [Thread-1  ]: SQL status: SELECT 1 in 36.528 seconds
[0m20:28:57.633684 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: ROLLBACK
[0m20:28:57.636749 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: ROLLBACK
[0m20:28:57.638627 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7: Close
[0m20:28:57.641997 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: ROLLBACK
[0m20:28:57.644071 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2: Close
[0m20:28:57.644999 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e: Close
[0m20:28:57.646521 [info ] [Thread-3  ]: 9 of 18 PASS not_null_stg_kaggle__btcusdt_number_of_trades ..................... [[32mPASS[0m in 36.66s]
[0m20:28:57.648568 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6: Close
[0m20:28:57.650188 [info ] [Thread-4  ]: 12 of 18 PASS not_null_stg_kaggle__btcusdt_open_time ........................... [[32mPASS[0m in 36.65s]
[0m20:28:57.652244 [info ] [Thread-2  ]: 10 of 18 PASS not_null_stg_kaggle__btcusdt_open ................................ [[32mPASS[0m in 36.66s]
[0m20:28:57.654314 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m20:28:57.656451 [info ] [Thread-1  ]: 11 of 18 PASS not_null_stg_kaggle__btcusdt_open_date ........................... [[32mPASS[0m in 36.66s]
[0m20:28:57.659632 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m20:28:57.661647 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m20:28:57.663952 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m20:28:57.666131 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m20:28:57.667725 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m20:28:57.669215 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m20:28:57.670698 [info ] [Thread-3  ]: 13 of 18 START test not_null_stg_kaggle__btcusdt_quote_asset_volume ............ [RUN]
[0m20:28:57.672225 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m20:28:57.673865 [info ] [Thread-4  ]: 14 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ... [RUN]
[0m20:28:57.675383 [info ] [Thread-2  ]: 15 of 18 START test not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume .. [RUN]
[0m20:28:57.677265 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m20:28:57.678686 [info ] [Thread-1  ]: 16 of 18 START test not_null_stg_kaggle__btcusdt_volume ........................ [RUN]
[0m20:28:57.679909 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m20:28:57.681504 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m20:28:57.682831 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m20:28:57.684248 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m20:28:57.685565 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m20:28:57.686943 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m20:28:57.696570 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m20:28:57.698013 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m20:28:57.706841 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m20:28:57.715411 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m20:28:57.725933 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m20:28:57.728092 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m20:28:57.731078 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m20:28:57.737494 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m20:28:57.746198 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m20:28:57.747209 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m20:28:57.748423 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m20:28:57.755118 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m20:28:57.760465 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m20:28:57.761902 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m20:28:57.765886 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: BEGIN
[0m20:28:57.766840 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m20:28:57.768234 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m20:28:57.769445 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m20:28:57.770432 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: BEGIN
[0m20:28:57.771402 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m20:28:57.773871 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: BEGIN
[0m20:28:57.775465 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:28:57.777300 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: BEGIN
[0m20:28:57.781741 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:28:57.779814 [debug] [Thread-3  ]: SQL status: BEGIN in 0.011 seconds
[0m20:28:57.778804 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:28:57.784038 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m20:28:57.786298 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where quote_asset_volume is null



      
    ) dbt_internal_test
[0m20:28:57.787413 [debug] [Thread-4  ]: SQL status: BEGIN in 0.012 seconds
[0m20:28:57.789233 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m20:28:57.790405 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m20:28:57.791913 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m20:28:57.792857 [debug] [Thread-2  ]: SQL status: BEGIN in 0.014 seconds
[0m20:28:57.794045 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_base_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_base_asset_volume is null



      
    ) dbt_internal_test
[0m20:28:57.795960 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where volume is null



      
    ) dbt_internal_test
[0m20:28:57.797485 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m20:28:57.800179 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select taker_buy_quote_asset_volume
from "company_dw"."analytics"."stg_kaggle__btcusdt"
where taker_buy_quote_asset_volume is null



      
    ) dbt_internal_test
[0m20:29:32.980848 [debug] [Thread-3  ]: SQL status: SELECT 1 in 35.192 seconds
[0m20:29:32.981983 [debug] [Thread-4  ]: SQL status: SELECT 1 in 35.183 seconds
[0m20:29:32.982933 [debug] [Thread-1  ]: SQL status: SELECT 1 in 35.183 seconds
[0m20:29:32.984433 [debug] [Thread-2  ]: SQL status: SELECT 1 in 35.182 seconds
[0m20:29:32.987035 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: ROLLBACK
[0m20:29:32.990081 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: ROLLBACK
[0m20:29:32.992992 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: ROLLBACK
[0m20:29:32.995974 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: ROLLBACK
[0m20:29:32.997850 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0: Close
[0m20:29:32.999307 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639: Close
[0m20:29:33.000582 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae: Close
[0m20:29:33.001841 [debug] [Thread-2  ]: On test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42: Close
[0m20:29:33.003136 [info ] [Thread-3  ]: 13 of 18 PASS not_null_stg_kaggle__btcusdt_quote_asset_volume .................. [[32mPASS[0m in 35.33s]
[0m20:29:33.005127 [info ] [Thread-4  ]: 14 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume ......... [[32mPASS[0m in 35.33s]
[0m20:29:33.007513 [info ] [Thread-1  ]: 16 of 18 PASS not_null_stg_kaggle__btcusdt_volume .............................. [[32mPASS[0m in 35.32s]
[0m20:29:33.009755 [info ] [Thread-2  ]: 15 of 18 PASS not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume ........ [[32mPASS[0m in 35.33s]
[0m20:29:33.011823 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m20:29:33.013726 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m20:29:33.015624 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m20:29:33.017219 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m20:29:33.018704 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m20:29:33.020243 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m20:29:33.022748 [info ] [Thread-3  ]: 17 of 18 START test unique_stg_kaggle__btcusdt_close_time ...................... [RUN]
[0m20:29:33.024196 [info ] [Thread-4  ]: 18 of 18 START test unique_stg_kaggle__btcusdt_open_time ....................... [RUN]
[0m20:29:33.025780 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m20:29:33.027190 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m20:29:33.028629 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m20:29:33.029998 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m20:29:33.042169 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m20:29:33.049530 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m20:29:33.053816 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m20:29:33.058769 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m20:29:33.059571 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m20:29:33.065073 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m20:29:33.066907 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m20:29:33.069959 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: BEGIN
[0m20:29:33.071121 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m20:29:33.071984 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m20:29:33.073296 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: BEGIN
[0m20:29:33.075365 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:29:33.080796 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m20:29:33.082229 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m20:29:33.083110 [debug] [Thread-4  ]: SQL status: BEGIN in 0.008 seconds
[0m20:29:33.084339 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    close_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where close_time is not null
group by close_time
having count(*) > 1



      
    ) dbt_internal_test
[0m20:29:33.085743 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m20:29:33.087835 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    open_time as unique_field,
    count(*) as n_records

from "company_dw"."analytics"."stg_kaggle__btcusdt"
where open_time is not null
group by open_time
having count(*) > 1



      
    ) dbt_internal_test
[0m20:33:27.170522 [debug] [Thread-3  ]: SQL status: SELECT 1 in 234.074 seconds
[0m20:33:27.181560 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: ROLLBACK
[0m20:33:27.183437 [debug] [Thread-3  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb: Close
[0m20:33:27.186673 [info ] [Thread-3  ]: 17 of 18 PASS unique_stg_kaggle__btcusdt_close_time ............................ [[32mPASS[0m in 234.16s]
[0m20:33:27.190963 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m20:33:27.663442 [debug] [Thread-4  ]: SQL status: SELECT 1 in 234.567 seconds
[0m20:33:27.666749 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: ROLLBACK
[0m20:33:27.668471 [debug] [Thread-4  ]: On test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa: Close
[0m20:33:27.670536 [info ] [Thread-4  ]: 18 of 18 PASS unique_stg_kaggle__btcusdt_open_time ............................. [[32mPASS[0m in 234.64s]
[0m20:33:27.672315 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m20:33:27.678398 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:27.679734 [debug] [MainThread]: On master: BEGIN
[0m20:33:27.680933 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:33:27.687896 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:33:27.689124 [debug] [MainThread]: On master: COMMIT
[0m20:33:27.690172 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:27.691182 [debug] [MainThread]: On master: COMMIT
[0m20:33:27.692529 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:33:27.693562 [debug] [MainThread]: On master: Close
[0m20:33:27.694874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:27.695935 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae' was properly closed.
[0m20:33:27.696892 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa' was properly closed.
[0m20:33:27.698041 [debug] [MainThread]: Connection 'test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb' was properly closed.
[0m20:33:27.698971 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42' was properly closed.
[0m20:33:27.700201 [info ] [MainThread]: 
[0m20:33:27.701758 [info ] [MainThread]: Finished running 18 data tests in 0 hours 6 minutes and 20.51 seconds (380.51s).
[0m20:33:27.707930 [debug] [MainThread]: Command end result
[0m20:33:27.709144 [info ] [MainThread]: 
[0m20:33:27.710726 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:27.712040 [info ] [MainThread]: 
[0m20:33:27.713232 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m20:33:27.716903 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 381.3398, "process_user_time": 3.623038, "process_kernel_time": 0.272385, "process_mem_max_rss": "113312", "process_in_blocks": "1440", "process_out_blocks": "142"}
[0m20:33:27.719026 [debug] [MainThread]: Command `dbt test` succeeded at 20:33:27.718698 after 381.34 seconds
[0m20:33:27.720482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9f1c8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9c698af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9b26ca90>]}
[0m20:33:27.721772 [debug] [MainThread]: Flushing usage events
[0m20:33:33.315768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3930eae040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392eb19580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392eb19520>]}


============================== 20:33:33.323501 | 0d7d6522-0665-4d98-89f8-adfc7041de8a ==============================
[0m20:33:33.323501 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:33:33.324837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models fct_hourly_trades', 'send_anonymous_usage_stats': 'True'}
[0m20:33:33.566420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d7d6522-0665-4d98-89f8-adfc7041de8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392eb54070>]}
[0m20:33:33.645033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d7d6522-0665-4d98-89f8-adfc7041de8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392f7c5850>]}
[0m20:33:33.646790 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:33:33.683510 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m20:33:33.975714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:33:33.976660 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:33:34.074221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d7d6522-0665-4d98-89f8-adfc7041de8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392d92b130>]}
[0m20:33:34.104460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d7d6522-0665-4d98-89f8-adfc7041de8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392dd20700>]}
[0m20:33:34.105582 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m20:33:34.106665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d7d6522-0665-4d98-89f8-adfc7041de8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392dd34a30>]}
[0m20:33:34.109703 [info ] [MainThread]: 
[0m20:33:34.111272 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:33:34.118326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_analytics'
[0m20:33:34.238027 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m20:33:34.239223 [debug] [ThreadPool]: On list_company_dw_analytics: BEGIN
[0m20:33:34.240147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:34.245720 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m20:33:34.246975 [debug] [ThreadPool]: Using postgres connection "list_company_dw_analytics"
[0m20:33:34.248015 [debug] [ThreadPool]: On list_company_dw_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_analytics"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:33:34.251966 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m20:33:34.254363 [debug] [ThreadPool]: On list_company_dw_analytics: ROLLBACK
[0m20:33:34.255704 [debug] [ThreadPool]: On list_company_dw_analytics: Close
[0m20:33:34.264695 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:34.265937 [debug] [MainThread]: On master: BEGIN
[0m20:33:34.266872 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:33:34.272367 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m20:33:34.273401 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:34.274602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:33:34.284498 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m20:33:34.286674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d7d6522-0665-4d98-89f8-adfc7041de8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3930a27f10>]}
[0m20:33:34.287669 [debug] [MainThread]: On master: ROLLBACK
[0m20:33:34.288958 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:34.289913 [debug] [MainThread]: On master: BEGIN
[0m20:33:34.291339 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:33:34.292171 [debug] [MainThread]: On master: COMMIT
[0m20:33:34.293126 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:34.293964 [debug] [MainThread]: On master: COMMIT
[0m20:33:34.295101 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:33:34.295939 [debug] [MainThread]: On master: Close
[0m20:33:34.297196 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:33:34.298236 [info ] [MainThread]: 
[0m20:33:34.308292 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m20:33:34.309129 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m20:33:34.309833 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m20:33:34.310775 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m20:33:34.311591 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23  [RUN]
[0m20:33:34.313069 [info ] [Thread-2  ]: 2 of 7 START test dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour  [RUN]
[0m20:33:34.314225 [info ] [Thread-3  ]: 3 of 7 START test not_null_fct_hourly_trades_close_price ....................... [RUN]
[0m20:33:34.315348 [info ] [Thread-4  ]: 4 of 7 START test not_null_fct_hourly_trades_open_date ......................... [RUN]
[0m20:33:34.316621 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_analytics, now test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433)
[0m20:33:34.317837 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf'
[0m20:33:34.319062 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523'
[0m20:33:34.320158 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d'
[0m20:33:34.321156 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m20:33:34.322135 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m20:33:34.323123 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m20:33:34.324118 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m20:33:34.359518 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m20:33:34.362397 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m20:33:34.374379 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m20:33:34.380250 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m20:33:34.387436 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m20:33:34.388503 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m20:33:34.395390 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m20:33:34.402553 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m20:33:34.413639 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m20:33:34.417431 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m20:33:34.422311 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m20:33:34.426205 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m20:33:34.429770 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m20:33:34.430828 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m20:33:34.431543 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: BEGIN
[0m20:33:34.432295 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m20:33:34.433431 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m20:33:34.434104 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: BEGIN
[0m20:33:34.435118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:34.436164 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: BEGIN
[0m20:33:34.437155 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: BEGIN
[0m20:33:34.438137 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:33:34.439838 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m20:33:34.442061 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m20:33:34.446104 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m20:33:34.448905 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m20:33:34.450564 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        open_hour as value_field,
        count(*) as n_records

    from "company_dw"."analytics"."fct_hourly_trades"
    group by open_hour

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23'
)



      
    ) dbt_internal_test
[0m20:33:34.451493 [debug] [Thread-2  ]: SQL status: BEGIN in 0.013 seconds
[0m20:33:34.452919 [debug] [Thread-4  ]: SQL status: BEGIN in 0.013 seconds
[0m20:33:34.453756 [debug] [Thread-3  ]: SQL status: BEGIN in 0.012 seconds
[0m20:33:34.454565 [debug] [Thread-2  ]: Using postgres connection "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m20:33:34.455676 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m20:33:34.456686 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m20:33:34.457817 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        open_date, open_hour
    from "company_dw"."analytics"."fct_hourly_trades"
    group by open_date, open_hour
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m20:33:34.459093 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_date
from "company_dw"."analytics"."fct_hourly_trades"
where open_date is null



      
    ) dbt_internal_test
[0m20:33:34.460251 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close_price
from "company_dw"."analytics"."fct_hourly_trades"
where close_price is null



      
    ) dbt_internal_test
[0m20:33:34.461036 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.008 seconds
[0m20:33:34.469225 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: ROLLBACK
[0m20:33:34.470521 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.008 seconds
[0m20:33:34.471213 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.009 seconds
[0m20:33:34.473882 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: ROLLBACK
[0m20:33:34.474637 [debug] [Thread-1  ]: On test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433: Close
[0m20:33:34.477337 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: ROLLBACK
[0m20:33:34.478683 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523: Close
[0m20:33:34.479893 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23  [[32mPASS[0m in 0.16s]
[0m20:33:34.481423 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d: Close
[0m20:33:34.482528 [info ] [Thread-3  ]: 3 of 7 PASS not_null_fct_hourly_trades_close_price ............................. [[32mPASS[0m in 0.16s]
[0m20:33:34.483422 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.021 seconds
[0m20:33:34.484823 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m20:33:34.486381 [info ] [Thread-4  ]: 4 of 7 PASS not_null_fct_hourly_trades_open_date ............................... [[32mPASS[0m in 0.17s]
[0m20:33:34.487624 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m20:33:34.490323 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: ROLLBACK
[0m20:33:34.491510 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m20:33:34.493107 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m20:33:34.494144 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m20:33:34.495716 [debug] [Thread-2  ]: On test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf: Close
[0m20:33:34.496563 [info ] [Thread-1  ]: 5 of 7 START test not_null_fct_hourly_trades_open_hour ......................... [RUN]
[0m20:33:34.497855 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m20:33:34.498884 [info ] [Thread-3  ]: 6 of 7 START test not_null_fct_hourly_trades_open_price ........................ [RUN]
[0m20:33:34.500445 [info ] [Thread-2  ]: 2 of 7 PASS dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour  [[32mPASS[0m in 0.18s]
[0m20:33:34.501441 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4)
[0m20:33:34.502646 [info ] [Thread-4  ]: 7 of 7 START test not_null_fct_hourly_trades_percent_gain ...................... [RUN]
[0m20:33:34.504036 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd)
[0m20:33:34.505453 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m20:33:34.506548 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m20:33:34.507607 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d, now test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f)
[0m20:33:34.508579 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m20:33:34.515386 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m20:33:34.516410 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m20:33:34.522137 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m20:33:34.528736 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m20:33:34.530239 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m20:33:34.532361 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m20:33:34.536854 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m20:33:34.542110 [debug] [Thread-3  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m20:33:34.543148 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m20:33:34.547588 [debug] [Thread-4  ]: Writing runtime sql for node "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m20:33:34.548844 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m20:33:34.549629 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m20:33:34.550967 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: BEGIN
[0m20:33:34.551932 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m20:33:34.552786 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: BEGIN
[0m20:33:34.553829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:34.555122 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: BEGIN
[0m20:33:34.556143 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m20:33:34.557736 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m20:33:34.562568 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m20:33:34.563367 [debug] [Thread-3  ]: SQL status: BEGIN in 0.007 seconds
[0m20:33:34.564396 [debug] [Thread-1  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m20:33:34.565123 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m20:33:34.566067 [debug] [Thread-3  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m20:33:34.567126 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_hour
from "company_dw"."analytics"."fct_hourly_trades"
where open_hour is null



      
    ) dbt_internal_test
[0m20:33:34.568171 [debug] [Thread-4  ]: Using postgres connection "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m20:33:34.569267 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open_price
from "company_dw"."analytics"."fct_hourly_trades"
where open_price is null



      
    ) dbt_internal_test
[0m20:33:34.570777 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "node_id": "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select percent_gain
from "company_dw"."analytics"."fct_hourly_trades"
where percent_gain is null



      
    ) dbt_internal_test
[0m20:33:34.572830 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m20:33:34.575357 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: ROLLBACK
[0m20:33:34.576106 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.004 seconds
[0m20:33:34.576771 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.004 seconds
[0m20:33:34.578030 [debug] [Thread-1  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4: Close
[0m20:33:34.580053 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: ROLLBACK
[0m20:33:34.582201 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: ROLLBACK
[0m20:33:34.583681 [info ] [Thread-1  ]: 5 of 7 PASS not_null_fct_hourly_trades_open_hour ............................... [[32mPASS[0m in 0.08s]
[0m20:33:34.585033 [debug] [Thread-3  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd: Close
[0m20:33:34.586016 [debug] [Thread-4  ]: On test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f: Close
[0m20:33:34.587087 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m20:33:34.588520 [info ] [Thread-3  ]: 6 of 7 PASS not_null_fct_hourly_trades_open_price .............................. [[32mPASS[0m in 0.08s]
[0m20:33:34.590247 [info ] [Thread-4  ]: 7 of 7 PASS not_null_fct_hourly_trades_percent_gain ............................ [[32mPASS[0m in 0.08s]
[0m20:33:34.592324 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m20:33:34.593599 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m20:33:34.597008 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:34.597918 [debug] [MainThread]: On master: BEGIN
[0m20:33:34.598643 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:33:34.603669 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m20:33:34.604721 [debug] [MainThread]: On master: COMMIT
[0m20:33:34.605607 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:34.606414 [debug] [MainThread]: On master: COMMIT
[0m20:33:34.607577 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:33:34.608431 [debug] [MainThread]: On master: Close
[0m20:33:34.609463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:34.610291 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4' was properly closed.
[0m20:33:34.611105 [debug] [MainThread]: Connection 'test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf' was properly closed.
[0m20:33:34.611929 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd' was properly closed.
[0m20:33:34.612725 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f' was properly closed.
[0m20:33:34.613579 [info ] [MainThread]: 
[0m20:33:34.614607 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m20:33:34.617186 [debug] [MainThread]: Command end result
[0m20:33:34.618005 [info ] [MainThread]: 
[0m20:33:34.618887 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:34.619825 [info ] [MainThread]: 
[0m20:33:34.620751 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:33:34.622250 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3836045, "process_user_time": 3.339713, "process_kernel_time": 0.248845, "process_mem_max_rss": "111996", "process_out_blocks": "73", "process_in_blocks": "0"}
[0m20:33:34.623348 [debug] [MainThread]: Command `dbt test` succeeded at 20:33:34.623227 after 1.38 seconds
[0m20:33:34.624268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3930eae040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392d531820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f392f7c5850>]}
[0m20:33:34.625150 [debug] [MainThread]: Flushing usage events
[0m20:33:39.138974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5b065040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee58ceb850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee58ceb7f0>]}


============================== 20:33:39.147362 | b753bac8-bc88-4d35-b212-548ae184e3a0 ==============================
[0m20:33:39.147362 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:33:39.148522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:33:39.368962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b753bac8-bc88-4d35-b212-548ae184e3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee58d16a90>]}
[0m20:33:39.441896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b753bac8-bc88-4d35-b212-548ae184e3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee586ceca0>]}
[0m20:33:39.443429 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:33:39.474718 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:33:39.653744 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m20:33:39.654849 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25
[0m20:33:39.655775 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:33:39.656752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b753bac8-bc88-4d35-b212-548ae184e3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5a07aa90>]}
[0m20:33:41.778210 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:33:41.779361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b753bac8-bc88-4d35-b212-548ae184e3a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee583c44c0>]}
[0m20:33:42.226055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b753bac8-bc88-4d35-b212-548ae184e3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee57f1a1c0>]}
[0m20:33:42.250713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b753bac8-bc88-4d35-b212-548ae184e3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee57eb6040>]}
[0m20:33:42.251891 [info ] [MainThread]: Found 2 models, 25 data tests, 1 source, 540 macros
[0m20:33:42.252863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b753bac8-bc88-4d35-b212-548ae184e3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee57eb6a90>]}
[0m20:33:42.256206 [info ] [MainThread]: 
[0m20:33:42.257675 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:33:42.264044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_company_dw_dev'
[0m20:33:42.319293 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:33:42.320297 [debug] [ThreadPool]: On list_company_dw_dev: BEGIN
[0m20:33:42.321100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:42.326409 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m20:33:42.327380 [debug] [ThreadPool]: Using postgres connection "list_company_dw_dev"
[0m20:33:42.328281 [debug] [ThreadPool]: On list_company_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "list_company_dw_dev"} */
select
      'company_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'company_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m20:33:42.331694 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m20:33:42.333674 [debug] [ThreadPool]: On list_company_dw_dev: ROLLBACK
[0m20:33:42.334797 [debug] [ThreadPool]: On list_company_dw_dev: Close
[0m20:33:42.342674 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:42.343681 [debug] [MainThread]: On master: BEGIN
[0m20:33:42.344533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:33:42.349502 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m20:33:42.350428 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:42.351478 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:33:42.360312 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m20:33:42.362269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b753bac8-bc88-4d35-b212-548ae184e3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5abe7f10>]}
[0m20:33:42.363280 [debug] [MainThread]: On master: ROLLBACK
[0m20:33:42.364378 [debug] [MainThread]: On master: Close
[0m20:33:42.365497 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:33:42.366411 [info ] [MainThread]: 
[0m20:33:42.375533 [debug] [Thread-1  ]: Began running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m20:33:42.376742 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_company_dw_dev, now model.dbt_btc_transform.stg_kaggle__btcusdt)
[0m20:33:42.377743 [debug] [Thread-1  ]: Began compiling node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m20:33:42.390593 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_btc_transform.stg_kaggle__btcusdt"
[0m20:33:42.397182 [debug] [Thread-1  ]: Began executing node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m20:33:42.398755 [debug] [Thread-1  ]: Finished running node model.dbt_btc_transform.stg_kaggle__btcusdt
[0m20:33:42.401116 [debug] [Thread-3  ]: Began running node model.dbt_btc_transform.fct_hourly_trades
[0m20:33:42.401874 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m20:33:42.402821 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m20:33:42.403558 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m20:33:42.404362 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_btc_transform.fct_hourly_trades'
[0m20:33:42.405573 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872'
[0m20:33:42.406901 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18'
[0m20:33:42.408150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_btc_transform.stg_kaggle__btcusdt, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb)
[0m20:33:42.409220 [debug] [Thread-3  ]: Began compiling node model.dbt_btc_transform.fct_hourly_trades
[0m20:33:42.410211 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m20:33:42.411160 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m20:33:42.412152 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m20:33:42.417473 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_btc_transform.fct_hourly_trades"
[0m20:33:42.423444 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872"
[0m20:33:42.429409 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18"
[0m20:33:42.442529 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb"
[0m20:33:42.447674 [debug] [Thread-3  ]: Began executing node model.dbt_btc_transform.fct_hourly_trades
[0m20:33:42.449255 [debug] [Thread-3  ]: Finished running node model.dbt_btc_transform.fct_hourly_trades
[0m20:33:42.450112 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m20:33:42.450766 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m20:33:42.451692 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m20:33:42.452694 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m20:33:42.454519 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872
[0m20:33:42.455907 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18
[0m20:33:42.457830 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.dbt_btc_transform.fct_hourly_trades, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a)
[0m20:33:42.460039 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb
[0m20:33:42.461192 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m20:33:42.462379 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m20:33:42.463440 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m20:33:42.464546 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m20:33:42.465686 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_end__True__False.c0c416f872, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58)
[0m20:33:42.466835 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_stg_kaggle__btcusdt_hour_start__True__False.618478ab18, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf)
[0m20:33:42.473508 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a"
[0m20:33:42.474520 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close.949b7ebacb, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95)
[0m20:33:42.475546 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m20:33:42.476542 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m20:33:42.478116 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m20:33:42.484579 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58"
[0m20:33:42.485739 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m20:33:42.492206 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf"
[0m20:33:42.498247 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95"
[0m20:33:42.501736 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a
[0m20:33:42.503167 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m20:33:42.505151 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m20:33:42.506052 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m20:33:42.507208 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m20:33:42.508331 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58
[0m20:33:42.509654 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf
[0m20:33:42.510866 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_close_time.d363974f3a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a)
[0m20:33:42.513587 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95
[0m20:33:42.515227 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m20:33:42.516364 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m20:33:42.517392 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m20:33:42.518525 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m20:33:42.519665 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_high.8d94d16f58, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7)
[0m20:33:42.520700 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_end.04eb17edaf, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e)
[0m20:33:42.526961 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a"
[0m20:33:42.528188 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_hour_start.14dca24f95, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6)
[0m20:33:42.529225 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m20:33:42.530220 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m20:33:42.532196 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m20:33:42.539825 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7"
[0m20:33:42.540743 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m20:33:42.547139 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e"
[0m20:33:42.552972 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6"
[0m20:33:42.556753 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a
[0m20:33:42.558441 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m20:33:42.561192 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m20:33:42.563225 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7
[0m20:33:42.564039 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m20:33:42.564677 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m20:33:42.565646 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_low.d494c4217a, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2)
[0m20:33:42.566825 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m20:33:42.568530 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e
[0m20:33:42.569955 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6
[0m20:33:42.571200 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m20:33:42.572258 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_number_of_trades.419b8cb8b7, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0)
[0m20:33:42.573439 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m20:33:42.574586 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m20:33:42.580917 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2"
[0m20:33:42.582883 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m20:33:42.584825 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open.f63b45ce8e, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639)
[0m20:33:42.586332 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_date.3694f92bb6, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42)
[0m20:33:42.594401 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0"
[0m20:33:42.595930 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m20:33:42.596777 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m20:33:42.598061 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m20:33:42.600756 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2
[0m20:33:42.609698 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639"
[0m20:33:42.610608 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m20:33:42.620963 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42"
[0m20:33:42.622388 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m20:33:42.624886 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0
[0m20:33:42.626672 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m20:33:42.628042 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_open_time.e146c8f3a2, now test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae)
[0m20:33:42.629423 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m20:33:42.630304 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m20:33:42.632049 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639
[0m20:33:42.633264 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m20:33:42.634672 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_quote_asset_volume.4c5fff85f0, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb)
[0m20:33:42.637754 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42
[0m20:33:42.639380 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m20:33:42.647304 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae"
[0m20:33:42.648528 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m20:33:42.649842 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m20:33:42.651284 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_base_asset_volume.8b142f8639, now test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa)
[0m20:33:42.662906 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb"
[0m20:33:42.664372 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_taker_buy_quote_asset_volume.a3be47bc42, now test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433)
[0m20:33:42.665483 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m20:33:42.666507 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m20:33:42.668403 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m20:33:42.670163 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae
[0m20:33:42.671143 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m20:33:42.678224 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa"
[0m20:33:42.687334 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433"
[0m20:33:42.688759 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m20:33:42.690743 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb
[0m20:33:42.693431 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_stg_kaggle__btcusdt_volume.6539ccbcae, now test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf)
[0m20:33:42.694627 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m20:33:42.695918 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m20:33:42.696772 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m20:33:42.698012 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m20:33:42.699658 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa
[0m20:33:42.700752 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.unique_stg_kaggle__btcusdt_close_time.9ed7ca77eb, now test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523)
[0m20:33:42.702500 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433
[0m20:33:42.711944 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf"
[0m20:33:42.713278 [debug] [Thread-2  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m20:33:42.714578 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m20:33:42.715794 [debug] [Thread-1  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m20:33:42.717683 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.unique_stg_kaggle__btcusdt_open_time.82f3d10cfa, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d)
[0m20:33:42.724483 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523"
[0m20:33:42.725188 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m20:33:42.726215 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.accepted_values_fct_hourly_trades_open_hour__0__1__2__3__4__5__6__7__8__9__10__11__12__13__14__15__16__17__18__19__20__21__22__23.990e4b1433, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4)
[0m20:33:42.727364 [debug] [Thread-2  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m20:33:42.730185 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf
[0m20:33:42.731801 [debug] [Thread-1  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m20:33:42.732980 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m20:33:42.741813 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d"
[0m20:33:42.743234 [debug] [Thread-3  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m20:33:42.750439 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4"
[0m20:33:42.751916 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523
[0m20:33:42.753851 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.dbt_utils_unique_combination_of_columns_fct_hourly_trades_open_date__open_hour.824f8db3cf, now test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd)
[0m20:33:42.755280 [debug] [Thread-2  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m20:33:42.756403 [debug] [Thread-4  ]: Began running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m20:33:42.757800 [debug] [Thread-3  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m20:33:42.758523 [debug] [Thread-1  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m20:33:42.760049 [debug] [Thread-2  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d
[0m20:33:42.761185 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.dbt_btc_transform.not_null_fct_hourly_trades_close_price.b45dff9523, now test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f)
[0m20:33:42.767866 [debug] [Thread-3  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd"
[0m20:33:42.769520 [debug] [Thread-1  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4
[0m20:33:42.771342 [debug] [Thread-4  ]: Began compiling node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m20:33:42.779952 [debug] [Thread-4  ]: Writing injected SQL for node "test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f"
[0m20:33:42.781154 [debug] [Thread-3  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m20:33:42.784066 [debug] [Thread-3  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd
[0m20:33:42.785650 [debug] [Thread-4  ]: Began executing node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m20:33:42.788028 [debug] [Thread-4  ]: Finished running node test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f
[0m20:33:42.791311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:42.792486 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_hour.9e031aa9e4' was properly closed.
[0m20:33:42.793520 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_price.f9edf3dacd' was properly closed.
[0m20:33:42.794580 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_percent_gain.abef50ba3f' was properly closed.
[0m20:33:42.796457 [debug] [MainThread]: Connection 'test.dbt_btc_transform.not_null_fct_hourly_trades_open_date.be4639cb5d' was properly closed.
[0m20:33:42.804582 [debug] [MainThread]: Command end result
[0m20:33:43.050944 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m20:33:43.051959 [info ] [MainThread]: Building catalog
[0m20:33:43.066611 [debug] [ThreadPool]: Acquiring new postgres connection 'company_dw.information_schema'
[0m20:33:43.078807 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m20:33:43.080041 [debug] [ThreadPool]: On company_dw.information_schema: BEGIN
[0m20:33:43.081062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:43.086342 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m20:33:43.087444 [debug] [ThreadPool]: Using postgres connection "company_dw.information_schema"
[0m20:33:43.088656 [debug] [ThreadPool]: On company_dw.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_btc", "target_name": "dev", "connection_name": "company_dw.information_schema"} */

    
    

    select
        'company_dw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('fct_hourly_trades')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_kaggle__btcusdt')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('btcusdt')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m20:33:43.106786 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.017 seconds
[0m20:33:43.114691 [debug] [ThreadPool]: On company_dw.information_schema: ROLLBACK
[0m20:33:43.115996 [debug] [ThreadPool]: On company_dw.information_schema: Close
[0m20:33:43.206810 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m20:33:43.208545 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.1587768, "process_user_time": 5.919968, "process_kernel_time": 0.215885, "process_mem_max_rss": "116396", "process_in_blocks": "3224", "process_out_blocks": "6713"}
[0m20:33:43.209656 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:33:43.209531 after 4.16 seconds
[0m20:33:43.210497 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:33:43.211195 [debug] [MainThread]: Connection 'company_dw.information_schema' was properly closed.
[0m20:33:43.211939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5b065040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee57bbc7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5778de20>]}
[0m20:33:43.212902 [debug] [MainThread]: Flushing usage events
